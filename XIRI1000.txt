000100***************************************************************** 00010000
000200* I D E N T I F I C A T I O N   D I V I S I O N                 * 00020000
000300***************************************************************** 00030000
000400*                                                                 00040000
000500 IDENTIFICATION DIVISION.                                         00050000
000600 PROGRAM-ID.    XIRI1000.                                         00060000
000700 AUTHOR.        REGIONAL INVOICE BILLING.                         00070000
000800 DATE-WRITTEN.  OCTOBER 1992.                                     00080000
000900 DATE-COMPILED.                                                   00090000
001000 SECURITY.                                                        00100000
001100 COPY PROP0AA0.                                                   00110000
001200     EJECT                                                        00120000
001300***************************************************************** 00130000
001400*           D E S C R I P T I O N  O F  P R O G R A M           * 00140000
001500*                                                               * 00150000
001600* PROGRAM ID:      XIRI1000                                     * 00160000
001700*                                                               * 00170000
001800* PROGRAM NAME:    REGIONAL ENTRY (INITIAL ENTRY)               * 00180000
001900*                                                               * 00190000
002000* FUNCTIONAL AREA: BILLING                                      * 00200000
002100*                                                               * 00210000
002200* PURPOSE:                                                      * 00220000
002300*   THE PURPOSE OF THIS PROGRAM IS TO MANAGE INVOICES AT        * 00230000
002400*   INITIAL REGIONAL ENTRY.  THESE INVOICES ARE TRANSMITTED BY  * 00240000
002500*   THE TRANSMISSION ACCEPTANCE PROCESS.  THIS PROGRAM THEN     * 00250000
002600*   CALLS VARIOUS SUBROUTINES TO PERFORM SUBTOTALLING, SORTING  * 00260000
002700*   AND OTHER FUNCTIONS BEFORE STORING THE INVOICE DATA.        * 00270000
002800*                                                               * 00280000
002900*   ALL INVOICES WHICH PASS VALIDATION ARE LOADED INTO THE      * 00290000
003000*   INVOICE TABLES, DS1.1(USA1) & DS1.2(USA2).                  * 00300000
003100*                                                               * 00310000
003200* DESCRIPTION:                                                  * 00320000
003300*   XIRI1000 IS TRIGGERED TO RUN BY THE ACCEPTANCE OF AN        * 00330000
003400*   INVOICE FILE WHICH HAS BEEN SENT IN BY THE CARRIER AND RUN  * 00340000
003500*   THROUGH UP-FRONT EDITS IN XIRS1000.  XIRI1000 IS NOT CYCLE  * 00350000
003600*   DEPENDENT.  THIS MEANS IT WILL NOT NECESSARILLY RUN ONCE    * 00360000
003700*   PER CYCLE.  IF TWO INVOICE FILES GET THROUGH XIRS1000       * 00370000
003800*   WITHIN THE TIMEFRAME OF ONE CYCLE, XIRI1000 WILL RUN TWICE  * 00380000
003900*   WITHIN THAT CYCLE.  IT IS ALSO POSSIBLE FOR NO FILE TO COME * 00390000
004000*   CAUSING XIRI1000 NOT TO RUN AT ALL FOR THAT CYCLE.  XIRI1000* 00400000
004100*   WILL TAKE THE OUTPUT FILE FROM XIRS1000 AND DECIDE IF ANY   * 00410000
004200*   LINES NEED TO BE GENERATED IN ORDER COMPLETE THE BILL FOR   * 00420000
004300*   THAT CARRIER.                                               * 00430000
004400*   FOR EXAMPLE:   MCI SENDS IN ALL RECORDS NEEDED TO CREATE    * 00440000
004500*   THE BILL.  AT&T ON THE OTHER HAND DOES NOT, WHICH REQUIRES  * 00450000
004600*   XIRI1000 TO GENERATE THE MISSING RECORDS.  ONCE ALL THE     * 00460000
004700*   RECORDS ARE GENERATED THEY MUST THEN BE SORTED WITH THE     * 00470000
004800*   ONES SENT IN BY THE CARRIER INTO THE ORDER THE CARRIER WANTS* 00480000
004900*   THEM PRINTED ON THE BILL.  ONCE ALL THE RECORDS HAVE BEEN   * 00490000
005000*   SORTED INTO THE CORRECT SECTIONS AND SUB-SECTIONS OF THE    * 00500000
005100*   BILL THEY CAN THEN BE INSERTED INTO THE XZ8USA1T, XZ8USA2T. * 00510000
005200*                                                               * 00520000
005300* FREQUENCY: (TRIGGERED BY FILE BEING GENERATED OUT OF XIRS1000)* 00530000
005400*                                                               * 00540000
005500* INPUT/OUTPUT:                                                 * 00550000
005600*                                                               * 00560000
005700*   PARAMETER                               POSSIBLE            * 00570000
005800*      CARD           DESCRIPTION            VALUES    REQUIRED * 00580000
005900*   ---------   -------------------------   ---------  -------- * 00590000
006000*   C100001I    SPLR ID                       MULTI      Y      * 00600000
006100*                                                               * 00610000
006200*     TABLE    TABLE                                    ACCESS  * 00620000
006300*     VIEW       #            TABLE NAME                 TYPE   * 00630000
006400*   --------  -------  -----------------------------   -------- * 00640000
006500*   XIRI001V  XY4DSB2T RAO'S                           S/F      * 00650000
006600*             XY4DSB5T NPA VALUES                               * 00660000
006700*   XIRI002V  XY4DSB4T REGION                          S        * 00670000
006800*   XIRI003V  XZ8USA2T SUPPLIER USAGE DETAIL DATA      I        * 00680000
006900*   XIRI004V  XZ8USA1T SUPPLIER USAGE DATA             I/U/S    * 00690000
007000*   XIRI040V  XZ8USA7T XZ8USA2T AND XY4CAA1T VIEW      S        * 00700000
007100*   XIRI041V  XZ8USA2T SUPPLIER USAGE DATA             I/U/S    * 00710000
007200*   XIRI042V  XZ8USA1T SUPPLIER USAGE DATA             U/S      * 00720000
007300*   XIRI043V  XZ4AUA7T TRANSMISSION DATA               U        * 00730000
007400*   XIRI044V  XZ8USA7T SUPPLIER USAGE DATA FOR ENA REC I        * 00740000
007500*   XIRI090V  XZ8USA5T TRANSMISSION USAGE DATA         S        * 00750000
007600*   XIRI005V  XZ8USA1T SUPPLIER USAGE DATA             S        * 00760000
007700*   XIRI006V  XY4DSC7T SUPPLIER THRESHOLD ERRORS       S        * 00770000
007800*   XIRI008V  XZ8USA1T SUPPLIER USAGE DATA             S        * 00780000
007900*   XIRI013V  XZ4AUA4T TRANSMISSION INIT ASSN STATUS   I        * 00790000
008000*   XIRI022V  XY4DSC1T SUPPLIER                        S        * 00800000
008100*   XIRI031V  XY4DSE3T SUPPLIER ELEMENT DICTIONARY     S/F      * 00810000
008200*             XY4DSE8T SUPPLIER RECORD DICTIONARY               * 00820000
008300*   XIRI033V  XY4DSA2T ERROR REPOSITORY                S/F      * 00830000
008400*   XIRI034V  XY4DSA3T INTRNL/EXTRNL ERROR TRANSLATION S/F      * 00840000
008500*                                                               * 00850000
008600*   TYPES: S=SELECT, F=FETCH, U=UPDATE, I=INSERT, D=DELETE      * 00860000
008700*                                                               * 00870000
008800*                                                   SORT        * 00880000
008900*   FILE ID            RECORD NAME              SPECIFICATION   * 00890000
009000*   --------   -----------------------------   ---------------- * 00900000
009100*   I100001I   INPUT-FILE INVOICE FILE         USG-ID           * 00910000
009200*   I100004O   TEST FILE ONLY SORT RECORDS                      * 00920000
009300*                                                               * 00930000
009400* ASSOCIATED PROGRAMS:                                          * 00940000
009500*                                                               * 00950000
009600*             PROGRAM ID  PROGRAM NAME                          * 00960000
009700*             ----------  ------------------------------------- * 00970000
009800*  CALLED BY: SYSTEM                                            * 00980000
009900*  CALLS:     CO900AA0    "COMMIT AND RESTART FUNCTIONALITY"    * 00990000
010000*             XIRC1000    "FETCH SUPPLIER SUBPROGRAM MODULE"    * 01000000
010100*             XIRC2000    "VALIDATE DEPENDENCIES SUBPROGRAM"    * 01010000
010200*             XIRC3000    "DUP FILE VALIDATION SUBPROGRAM"      * 01020000
010300*             XIRC4000    "END OF SUPPLIER PROCESS SUBPROGRAM"  * 01030000
010400*             XIRC5000    "END OF JOB CONTROLS PROCESS"         * 01040000
010500*             XIRE1000    "ERROR TRACKER SUBPROGRAM             * 01050000
010600*             XIRI1005    "BILL FORMAT BUILD AND SORT INVOICES" * 01060000
010700*             XIRI1010    "BILL FORMAT INSERT INVOICE PROCES"  *  01070000
010800*             XIRI1050    "ACCUMULATIONS MODULE"                * 01080000
010900*             XIRI1060    "MAJOR SORT MODULE"                   * 01090000
011000*             XIRI1080    "PROCESS SPECIAL CHARS MODULE"        * 01100000
011100*             XIRI1090    "GENERATE ICE HYBRID ENA DATA MODULE" * 01110000
011200*             XIRZ1000    "RECORD COUNT COMMON CALLABLE MODULE" * 01120000
011300*             XIRZ1100    "NPA CONVERSION ON BTN"               * 01130000
011400*             XIRZ7000    "COMMON TRAIT LOOKUP MODULE"          * 01140000
011500*             XIRZ7200     REMOTE CONNECTION LINKAGE            * 01150000
011600*             XIRZ9000    "COMMON ABEND MODULE"                 * 01160000
011700*             XIRZA000    "COMMON RIB JOURNALS MODULE"          * 01170000
011800*                                                               * 01180000
011900* TRAITS USED:                                                  * 01190000
012000*   TRAIT-ID            ACTN-VAL    PGM-SWITCH                  * 01200000
012100*  -------------------- ----------  ---------------             * 01210000
012200*  'JRNS-USED         ' 'YES     '  DO-JOURNAL                  * 01220000
012300*  'JRNS-USED         ' 'NO      '  DONT-JOURNAL                * 01230000
012400*                                                               * 01240000
012500*  'BLBL-MNS-FRMT     ' 'SRTDMNS '  SORTED-MINUTES-ONLY (MMMM)  * 01250000
012600*                                                               * 01260000
012700*  'BLBL-MNS-FRMT     ' 'NSRTD10 '  NON-SORTED-10TH     (MMMM.S)* 01270000
012800*                       ROUND USING MINUTES AND SECONDS         * 01280000
012900*                                                               * 01290000
013000*  'BLBL-MNS-FRMT     ' 'NSRTMST '  NON-SORTED-10TH-MST (MMMM.S)* 01300000
013100*                       ROUND USING MINUTES, SECS, AND 10TH SECS* 01310000
013200*                                                               * 01320000
013300*  'BLBL-MNS-FRMT     ' 'NSRTMNSC'  NON-SORTED-MIN-SEC (MMMM:SS)* 01330000
013400*                                                               * 01340000
013500*  'BLBL-MNS-FRMT     ' 'SRTD10  '  SORTED-10TH         (MMMM.S)* 01350000
013600*                                                               * 01360000
013700*  '015127-RCDS       ' 'USE     '  SPLR-HAS-015127-RCDS        * 01370000
013800*  '015127-RCDS       ' 'DONT-USE'  DONT-USE-015127-RCDS        * 01380000
013900*                                                               * 01390000
014000*  'ALWAYS-NORMAL-INV ' 'YES     '  SET-RVN-SCE-TYP-CD-TO-N     * 01400000
014100*  'ALWAYS-NORMAL-INV ' 'NO      '  ALLOW-CARD-AND-FEES         * 01410000
014200*                                                               * 01420000
014300*  'POP-TAX-USG-ID    ' 'YES     '  POPULATE-TAX-USG-ID         * 01430000
014400*  'POP-TAX-USG-ID    ' 'NO      '  DONT-POP-TAX-USG-ID         * 01440000
014500*                                                               * 01450000
014600*  'INS-FST-TM-INV-INDR' 'YES     '  POPULATE-FIST-TIME IND     * 01460000
014700*  'INS-FST-TM-INV-INDR'  'NO     '  DONT-POPULATE-FIST-TIME IND* 01470000
014800*  'INS-VZW-FST-TM-INV'   'VZW    '  POPULATE-FIST-TIME IND*      01480000
014900*  'NO-INS-VZW-FST-TM-INV' Y/N       USING VERIZON FIELD        * 01490000
015000*                                                               * 01500000
015100*                                                               * 01510000
015200***************************************************************** 01520000
015300     EJECT                                                        01530000
015400***************************************************************** 01540000
015500***                                                           *** 01550000
015600***        P R O G R A M    H I S T O R Y                     *** 01560000
015700***                                                           *** 01570000
015800***************************************************************** 01580000
015900* MCR/TR#     AUTHOR     DATE     REASON                        * 01590000
016000***************************************************************** 01600000
016100*    1        T ZIMLICH  09/30/92 INITIAL RELEASE               * 01610000
016200* 970918-70A                                                    * 01620000
016300* 137942      ALAN MASI  03/30/95 R950407                       * 01630000
016400*                                 ADDED CODE TO INITIALIZE THE  * 01640000
016500*                                 NEW FIELD INV-COMPLN-TMSTMP   * 01650000
016600*                                 ADDED TO THE AUA4 TABLE.      * 01660000
016700*                                                               * 01670000
016800* 138943      ALAN MASI  04/12/95 R950525                       * 01680000
016900*                                 ADDED NEW INTEGRITY CHECK.    * 01690000
017000*                                 BEFORE WRITTING A RECORD TO   * 01700000
017100*                                 THE USA1 TABLE THE FOLLOWING  * 01710000
017200*                                 COMPUTATION MUST BE TRUE:     * 01720000
017300*                                 TOT-REV-AMT =                 * 01730000
017400*                                 TOT-EXCL-TX-AMT + FED-TX-AMT +* 01740000
017500*                                 LOC-ST-TX-AMT + MSG-SURCHG-AMT* 01750000
017600*                                                               * 01760000
017700* 139012      ALAN MASI  04/20/95 R950525                       * 01770000
017800*                                 ADDED CODE TO ALLOW RESTART   * 01780000
017900*                                 TO SORT INVOICES CORRECTLY    * 01790000
018000*                                 USING THE NEW USG-ID'S FROM   * 01800000
018100*                                 S1000.  FIRST TWO DIGITS WILL * 01810000
018200*                                 CHANGE PER INVOICE INSTEAD OF * 01820000
018300*                                 PER TRANSMISSION.             * 01830000
018400*                                                               * 01840000
018500* 941222-70   ALAN MASI  05/31/95 R950914                       * 01850000
018600*                                 RESTRUCTURED PROGRAM AND RE-  * 01860000
018700*                                 DID RESTART LOGIC TO NOT PASS * 01870000
018800*                                 41 SAVE AREAS TO BE SAVED FOR * 01880000
018900*                                 RESTART. 8 AREAS SAVED NOW.   * 01890000
019000*                                                               * 01900000
019100* 950321-70   ALAN MASI  10/11/95 R960215 CIC EXPANSION         * 01910000
019200*                                 - INCREASED WS-SPLR-NUM TO 4  * 01920000
019300*                                                               * 01930000
019400* TR#154223     KGE      10/30/95 R960215                       * 01940000
019500*                                 REMOVE ABEND LOGIC FOR DUP    * 01950000
019600*                                 INVOICE COUNT.                * 01960000
019700*                                                               * 01970000
019800* 950203-70   ALAN MASI  10/11/95 R960509                       * 01980000
019900*                                 SPRINT TO RIB CHANGES:        * 01990000
020000*                                 - SET A FLAG TO INDICATE WHEN * 02000000
020100*                                   THE FIRST 015123 RECORD IS  * 02010000
020200*                                   FOUND.  TAXES ARE PROCESSED * 02020000
020300*                                   FROM THE FIRST RECORD ONLY. * 02030000
020400*                        02/26/96 - ADDED CODE TO USE USG-ID    * 02040000
020500*                                   FOR I1005LK3 WHEN CHECKING  * 02050000
020600*                                   FOR DUP 3975 ERRORS.        * 02060000
020700*                        04/17/96 - ADDED CODE TO MOVE CONVERTED* 02070000
020800*                                   MA-BLG-NO TO WRAPUP SORT RCD* 02080000
020900*                        05/02/96 - ADDED CODE TO POPULATE TAX  * 02090000
021000*                                   FIELDS ON USA1 FOR SPRINT.  * 02100000
021100*                                                               * 02110000
021200* TR#159808   ALAN MASI  02/13/96 R960314 (RETROFIT)            * 02120000
021300*                                 FIX OUT OF BALANCE CONDITION  * 02130000
021400*                                 CAUSED BY RESTARTING MCI.     * 02140000
021500*                                                               * 02150000
021600* EMER        ALAN MASI  03/18/96 CHANGED B210- TO FIX NPA SPLIT* 02160000
021700*                                 PROBLEM.                      * 02170000
021800*                                                               * 02180000
021900* 951221-71   ALAN MASI  06/04/96 R961114 - PCS WIRELESS        * 02190000
022000*                                 - REMOVE SUPPLIER LOGIC FROM  * 02200000
022100*                                   B830-CHECK-F1-CNTLS         * 02210000
022200*                                 - GET TRAITS IN 1000-BEGIN    * 02220000
022300*                                   AND SAVE THEM IN WS         * 02230000
022400*                                 - USE BLBL-MNS-TRAIT IN       * 02240000
022500*                                   I200-INSERT-XZ8USA2T INSTEAD* 02250000
022600*                                   OF SUPPLIER HARDCODING      * 02260000
022700*                                 - POPULATE BLBL-MNS OF USA2   * 02270000
022800*                                   IN I200-INSERT-XZ8USA2T     * 02280000
022900*                                 - CALL NEW JOURNALS PGM       * 02290000
023000*                                   FROM B500- AND FROM B600-   * 02300000
023100*                                 - USE 015127-TRAIT IN B600-   * 02310000
023200*                                   INSTEAD OF SUPPLIER HARDCODE* 02320000
023300*                                 - GOTO PARA EXITS UPON ERRORS * 02330000
023400*                        08/19/96 - ADDED CODE TO SET USE-RECORD* 02340000
023500*                                   -INDR TO 'N' IF THE PHRS-   * 02350000
023600*                                   TYP-CD = 0.                 * 02360000
023700*                                                               * 02370000
023800* TR#175774   ALAN MASI  09/03/96 R961114                       * 02380000
023900*                                 ADDED CODE TO ONLY SET CARD-  * 02390000
024000*                                 ONLY FLAG FOR INVOICES WITH   * 02400000
024100*                                 ALL 81 RECORDS WITH A MSG-TYP * 02410000
024200*                                 = 3. INVOICES WITHOUT ANY 81  * 02420000
024300*                                 RECORDS WILL NOT HAVE THE     * 02430000
024400*                                 CARD-ONLY FLAG SET.           * 02440000
024500*                                                               * 02450000
024600* TR#179839   ALAN MASI  10/16/96 R961114                       * 02460000
024700*                      ADDED A TRAIT TO ALLOW PCS TO ALWAYS SET * 02470000
024800*                      RVN-SCE-TYP-CD ON USA1 TO A 'N' (NORMAL  * 02480000
024900*                      INVOICE).  XIRV1000 ABENDS FOR PCS IF    * 02490000
025000*                      RVN-SCE-TYP-CD IS SET TO FEE OR CARD.    * 02500000
025100*                                                               * 02510000
025200* TR#181311   ALAN MASI  10/28/96 R961114                       * 02520000
025300*                                 ADDED CODE TO POPULATE        * 02530000
025400*                                 BLG-RAO OF ZA000LK1.          * 02540000
025500*                                                               * 02550000
025600* TR#181443   ALAN MASI  10/28/96 R961114                       * 02560000
025700*                        ADDED CODE TO POPULATE BILL-ORD-SEQ-NO * 02570000
025800*                        ON XYTRVA1T WITH THE BILL-ORD-SEQ-NO OF* 02580000
025900*                        XZ8USA2T.                              * 02590000
026000*                                                               * 02600000
026100* 930521-70B  SJWETEK    09/17/96 R961212 - B&C COUNTERS REWRITE* 02610000
026200*                                 - REMOVE A200 AND I300 PARAS  * 02620000
026300*                                   THIS WILL NOW BE IN B1020   * 02630000
026400*                                 - ADD FLDS TO Z8USA1 TABLE    * 02640000
026500*                                   TO INDICATE WHETHER OR NOT  * 02650000
026600*                                   AN INVOICE CONTAINS INTER   * 02660000
026700*                                   OR INTRALATA MESSAGES BASED * 02670000
026800*                                   ON VALUE OF SETTLEMENT CODE * 02680000
026900*                                   ON THE 81/82 DETAIL REC.    * 02690000
027000*                                                               * 02700000
027100* 961219-62   ALAN MASI  01/21/97 R970515 - EXPAND EXEC SPLR'S  * 02710000
027200*                        CHANGE PROGRAM TO REMOVE ALL MULTIPLE  * 02720000
027300*                        SPLR LOGIC.  THIS PROGRAM ONLY RUNS FOR* 02730000
027400*                        ONE SPLR.                              * 02740000
027500*                        - REMOVE OCCURS CLAUSE FROM TB-SPLR-TBL* 02750000
027600*                        - REMOVE ALL REFERENCES TO WS-SPLR-IDX * 02760000
027700*                                                               * 02770000
027800* 970317-70A    KGE      07/02/97 USWLD CHANGES TO ADD INSERT TO* 02780000
027900*                                 NEW TAX USAGE TABLE.          * 02790000
028000*                                                               * 02800000
028100* 970509-70   ALAN MASI  09/18/97 R971211 - ADDED COPY BOOKS FOR* 02810000
028200*                                 CONVERTING MINUTES TO TENTHS  * 02820000
028300*                                 OF MINUTES. THIS WAS DONE SO  * 02830000
028400*                                 ALL PROGRAMS THAT NEED TENTHS * 02840000
028500*                                 OF MINUTES WILL ALL CONVERT IT* 02850000
028600*                                 THE SAME WAY.                 * 02860000
028700*                                                               * 02870000
028800* 970509-70   ALAN MASI  12/02/97 R971211 - ADDED CODE TO ROUND * 02880000
028900*                                 USING MINUTES SECONDS AND     * 02890000
029000*                                 TENTHS OF SECONDS FOR MESSAGES* 02900000
029100*                                 WITH INDICATOR 6 = 3.         * 02910000
029200*                                                               * 02920000
029300*X950724-3027 ATP        1/30/98  YR2000 PHASE 1                * 02930000
029400*                                                               * 02940000
029500*X950724-3035 C REIMER  04/28/98  ADDED CALL TO XIRZB000 TO     * 02950000
029600*                                 DETERMINE PARTITIONING ID FOR * 02960000
029700*                                 XZ8USA1T AND XZ8USA2T INSERTS.* 02970000
029800*                                 ADDED CALL TO XIRZC000 TO     * 02980000
029900*                                 EXPAND EMI RECORD WITH FOUR   * 02990000
030000*                                 DIGIT YEARS IN THE DATE FIELDS* 03000000
030100*                                 FOR THE NEW COLUMN ON THE     * 03010000
030200*                                 XZ8USA2T TABLE.               * 03020000
030300*                                                               * 03030000
030400*TR XXXXX    BXGOMEZ    09/20/98  DUPLICATE INVOICE PROBLEM.    * 03040000
030500*                                 SAME USG-ID ASSIGNED TO       * 03050000
030600*                                 DIFFERENT SUPPLIERS.          * 03060000
030700*                                                               * 03070000
030800* 970926-70  LAW        09/30/98  ADDED WIRELESS COUNTS TO USA1.* 03080000
030900*                                 TOT-WRELS-MSG-AMT AND         * 03090000
031000*                                 TOT-WRELS-MSG-NO.             * 03100000
031100*                                                               * 03110000
031200*TR2173375   LAW        10/16/98  DUPLICATE INVOICE PROBLEM.    * 03120000
031300*                                 CHANGED CODE I100 AND U110.   * 03130000
031400*                                                               * 03140000
031500* RIB4P      JNIELSO    05/26/99  RIB 4P - ADDED APPLCN-BLG-GR- * 03150000
031600*                                 ID WHICH WILL DETERMINE IF    * 03160000
031700*                                 CUSTOMER WILL BE BILLED BY    * 03170000
031800*                                 LEGACY OR 4TH PLATFORM.       * 03180000
031900*                                                               * 03190000
032000*TR5036386   JWYMAN     09/07/00  REMOVED TWO UNIT TEST DISPLAY * 03200000
032100*                                 STATEMENTS FROM SECTION I100- * 03210000
032200*                                 INSERT-XZ8USA1T. THEY WERE    * 03220000
032300*                                 CAUSING THE SYSOUT THRESHOLD  * 03230000
032400*                                 TO BE EXCEEDED AND THEN THE   * 03240000
032500*                                 PROGRAM WOULD ABEND.          * 03250000
032600*TR5215996   WXDJUNA    11/15/00  ADD 'TX' AS A TAX BILL-SECT   * 03260000
032700*                                 SO IT CAN CALCULATE           * 03270000
032800*                                 TOT-REV-EXCL-TAX CORRECTLY.   * 03280000
032900*                                                               * 03290000
033000* 010627-62  YZHAO      09/12/01  RECOMPILE FOR OS390 & VM      * 03300000
033100*                                    COMPILER                   * 03310000
033200* 010627-60  WXDJUNA    11/10/01  LATIS RIB INTERFACE.          * 03320000
033300*                                 MODIFIED THE LOGIC TO INCLUDE * 03330000
033400*                                 COLUMN HEADING FOR QCC BILL   * 03340000
033500* R030717    WXDJUNA    04/30/03  ADD BILL SUPPRESSION INDICATOR* 03350000
033600* R041014    WXDJUNA    04/30/03  015121 NOW CAN ALSO ADD       * 03360000
033700*            PTID3295             HEADING TO INVOICE.           * 03370000
033800*                                 CAN UPDATE-HEADING INSTEAD OF * 03380000
033900*                                 ADD-HEADING FUNCTION.         * 03390000
034000*                                 THIS IS FOR DIRECTV PTID3295  * 03400000
034100* R050127    WXDJUNA    11/05/04  ADD WRLSS-TOT-NO-STATIONS     * 03410000
034200*            PTID3454             TO USA1                       * 03420000
034300*                                 EXCH-WRLSS-TOT-STA            * 03430000
034400*                                                               * 03440000
034500* R050430    PXREDD4    04/14/05  ADD FST_TM_INV_IND            * 03450000
034600*            PTID3976/            TO USA1.                      * 03460000
034700*            #1668625             NEW TRAIT ADD:                * 03470000
034800*                                 INS-FST-TM-INV-INDR           * 03480000
034900*                                 IF THIS TRAIT IS ON, THEN     * 03490000
035000*                                 THE SUM21-TAX-TOT-RED-AR(28:1)* 03500000
035100*                                 VALUE WOULD GO IN TO THIS NEW * 03510000
035200*                                 COLUMN OTHERWISE A SPACE.     * 03520000
035300*                                                               * 03530000
035400* R051006    PXREDD4    08/05/05  ADD SPLR_INTRNL_ACC_NO COLUMN * 03540000
035500*            B0504PR840           TO USA1.                      * 03550000
035600*                                 NEW TRAIT ADD:                * 03560000
035700*                                 SPLR-INTRNL-ACC-NO            * 03570000
035800*                                 THIS TRAIT SPECIFIES THE FORM * 03580000
035900*                                 THE SPLR-INTRNL-ACC-NO SHOULD * 03590000
036000*                                 APPEAR ON THE NEW COLUMN ON   * 03600000
036100*                                 USA1 TABLE.                   * 03610000
036200*                                 IT CAN BE EITHER OF THE FORMS * 03620000
036300*                                 BELOW.                        * 03630000
036400*                                  1. ACCOUNT NO                * 03640000
036500*                                  2. ACCOUNT NO + DIV ID       * 03650000
036600*                                  3. SUBSCRIBER PRFX + ACCT NO * 03660000
036700*                                                               * 03670000
036800* R060406    SPANDIA    04/06/06  MOVE TELCO-ACCT-TYP OF        * 03680000
036900*                                 E015121 TO BLG_PRTNR_ACCT_TYP * 03690000
037000*                                 OF XZ8USA1T                   * 03700000
037100*                                                               * 03710000
037200* R060406    SBANERJ    04/06/06  RENAMED TELCO-ACCT-TYP        * 03720000
037300*                                 AS BLG-PRTNR-CUST-TYP         * 03730000
037400*                                                               * 03740000
037500* R060713    PXREDD4/   05/15/06  CHANGED THE CODE SO THAT FOR  * 03750000
037600*            SXKUM25              CHOICE TV, SUBSCRIBER CON     * 03760000
037700*                                 VALUE FROM E015121M RECORD    * 03770000
037800*                                 GETS  POPULATED TO PARTNER    * 03780000
037900*                                 ACCOUNT TYPE ON XZ8USA1T TABLE* 03790000
038000*                                                               * 03800000
038100* R061207    PXREDD4/   10/10/06  CHANGED THE CODE TO POPULATE  * 03810000
038200*            SXKUM25              AFFILIATE TRANSACTION CODE    * 03820000
038300*                                 INDICATOR FIELD(NEW FIELD FROM* 03830000
038400*                                 R061207) ON XZ8USA1T TABLE FOR* 03840000
038500*                                 WIRELESS (0551 & 0568)        * 03850000
038600*                                 INVOICES. THE FIELD WILL BE   * 03860000
038700*                                 POPULATED WITH A 'Y' IF       * 03870000
038800*                                 AFLT-TRNSCTN-IND ON 015121    * 03880000
038900*                                 RECORD IS A '1' AND WITH A    * 03890000
039000*                                 SPACE IF AFLT-TRNSCTN-IND IS  * 03900000
039100*                                 A ZERO.                       * 03910000
039200*                                                               * 03920000
039300* R071108    SBANERJ     11/08/07 CHANGED THE CODE FOR 015121   * 03930000
039400* ITGT#:B0611BI088     (MM/DD/YY) AND 015127 COPY BOOK CHANGES  * 03940000
039500* BILL SIMPLIFICATION             FOR BILL SIMP PROJECT. MOVE   * 03950000
039600*                                 BILL-SIMP-FORMAT MOVE TO      * 03960000
039700*                                 QLFD_INVOICE_IND FIELD OF     * 03970000
039800*                                 XZ8USA1T TABLE.               * 03980000
039900*                                 IF REC-DETAILS-IND OF DETAIL  * 03990000
040000*                                 IS BILL-SIMP THEN MOVE +3     * 04000000
040100*                                 TO PRNTBL-LN-CD OF XZ8USA2T   * 04010000
040200*                                 AND ADD +1 TO RCD-NOT-PRTD-NO * 04020000
040300*                                 OF XZ8USA2T.                  * 04030000
040400*                                                               * 04040000
040500* R071108    SBANERJ     11/08/07 CHANGED THE CODE TO PASS      * 04050000
040600* ITGT#:B0707PR2027    (MM/DD/YY) DEFAULT LOW VALUE IN NEWLY    * 04060000
040700* DTV SERVICE UPGRADE             ADDED TIMESTAMP FIELD         * 04070000
040800*                                 LAST_ASGND_BTN_DAT IN XZ8USA1T* 04080000
040900*                                                               * 04090000
041000* R071108    SPANDIA     11/08/07 CHANGED THE CODE TO MOVE      * 04100000
041100* ITGT#:B0611BI088     (MM/DD/YY) BILL-SIMP-FORMAT MOVE TO      * 04110000
041200* BILL SIMPLIFICATION             QLFD_INVOICE_IND FIELD OF     * 04120000
041300*                                 XZ8USA1T TABLE,ONLY FOR THE   * 04130000
041400*                                 CARRIERS TRAIT HAS BEEN SET   * 04140000
041500*                                 BILL_SIMP_FORMAT INDICATOR SET* 04150000
041600*                                                               * 04160000
041700* R080221    SBANERJ     02/11/08 CHANGED THE CODE TO MOVE      * 04170000
041800* RCBS :B4645508       (MM/DD/YY) BILL-RQST-TYP OF 015121 RECORDS 04180000
041900* NEO #:0006392                   TO BLG_PRTNR_RQST_TYP FIELD OF* 04190000
042000* DIRECTV 2008 SERVICE UPGRADES   XZ8USA1T TABLE, ONLY FOR THE  * 04200000
042100*                                 CARRIERS FOR WHICH XY4DSCET   * 04210000
042200*                                 TRAIT,MOVE-BILL-RQST-TYP      * 04220000
042300*                                 HAS BEEN SET TO 'YES'.        * 04230000
042400*                                                               * 04240000
042500* R080417    SBANERJ     04/17/08 CHANGED THE CODE TO MOVE      * 04250000
042600* RCBS :B4493226       (MM/DD/YY) BMD81-WIFI-MINS TO XZ8USA2T NEW 04260000
042700* NEO #:00011221                  COLUMN WIFI_MNS. CALCULATE THE* 04270000
042800* FIXED MOBILE CONVERGENCE -      XZ8USA2T CALC_TOT_MNS = TOTAL * 04280000
042900* APRIL RELEASE                   MINUTES FROM BLBL_MNS PLUS    * 04290000
043000*                                 WIFI_MNS.                     * 04300000
043100*                                                               * 04310000
043200* R080717     DCOWAN     07/17/08 ADDED CODE TO PROCESS A BLANK * 04320000
043300* RCBS :B4636304       (MM/DD/YY) LINE FOR QQZ AFTER THE        * 04330000
043400* NEO #:0006873                   SUBTOTAL LINE IN THE EQUIPMENT* 04340000
043500*                                 CHARRGES SECTION.             * 04350000
043600*                                 PRIMARILY ONLY COLUMN HEADINGS* 04360000
043700*                                 ARE PROCESSED FOR QQZ, SO     * 04370000
043800*                                 INDICATORS AND LOGIC HAVE BEEN* 04380000
043900*                                 ADDED TO HELP IDENTIFY WHEN   * 04390000
044000*                                 THE BLANK LINE WILL BE ADDED. * 04400000
044100*                                                               * 04410000
044200* R080925    MXHUSSA     09/25/08      RECOMPILED THE CODE FOR  * 04420000
044300* NEO 0009407          (MM/DD/YY)      E015121M, E015127M,      * 04430000
044400* RCBS:B4736102                        E202205M, E202206M AND   * 04440000
044500* VERIZON WIRELESS                     E81XXXXM COPYBOOK CHANGES* 04450000
044600* R080925    SEARLY      09/25/08      RECOMPILED THE CODE FOR  * 04460000
044700* NEO 0009407          (MM/DD/YY)      E015121M, E015127M,      * 04470000
044800* RCBS:B4736102                        E202205M, E202206M AND   * 04480000
044900* VERIZON WIRELESS                     ADDED VERIZON WIRELESS   * 04490000
045000*                                      LOGIC CHANGES, 1) TO     * 04500000
045100*                                      FORMAT SUPPLIER ACCT NO  * 04510000
045200*                                      NEW TRAIT VALUE FOR THIS * 04520000
045300*                                      ADDED USA1 LOOKUP FOR    * 04530000
045400*                                      FST-TM-INV-INDR AND      * 04540000
045500*                                      ADDITIONAL SETTING OF    * 04550000
045600*                                      BILL PRINT SUPPRESSION   * 04560000
045700*                                                               * 04570000
045800* E090123    SXSUB13     01/19/09      MODIFIED CODE TO INCLUDE * 04580000
045900* NEO:0010868           (MM/DD/YY)   NEWLY CREATED VIEW       *   04590000
046000* RCBS:B4779202                        XIRI005V FOR VERIZON     * 04600000
046100*                                      ACCEPTED FIRST TIME      * 04610000
046200*                                      INVOICE                  * 04620000
046300* R090416    STHATIP     02/16/09      MODIFIED TO CHECK THE    * 04630000
046400* NEO 0011271           (MM/DD/YY)     FIRST TIME INVOICE       * 04640000
046500* RCBS:B4799021                        INDICATOR FOR VERIZON.   * 04650000
046600*                                                               * 04660000
046700* R100318    PKCHAND     01/20/10      RECOMPILED THE CODE FOR  * 04670000
046800* NEO 0015177          (MM/DD/YY)      E015121M, E015127M,      * 04680000
046900* RCBS:B5025006                        E81XXXXM COPYBOOK CHANGES* 04690000
047000*                                                               * 04700000
047100* EMER       DCOWAN      05/14/10      MODIFIED CODE BY REMOVING* 04710000
047200* PMR 4564550           (MM/DD/YY)     CHECKS IN PARAGRAPHS     * 04720000
047300* RCBS:CRIS10M0                        I100-INSERT-XZ8USA1T AND * 04730000
047400*                                      I200-INSERT-XZ8USA2T FOR * 04740000
047500*                                      SUM21-VZW-FST-TM-INV = 0 * 04750000
047600*                                      AND MAKING COMMON CODE   * 04760000
047700*                                      FOR WHEN                 * 04770000
047800*                                      SUM21-VZW-FST-TM-INV = Y * 04780000
047900*                                      AND FOR WHEN             * 04790000
048000*                                      SUM21-VZW-FST-TM-INV = N * 04800000
048100*                                                               * 04810000
048200* R100916    PKCHAND     09/13/10      CODE CHANGES TO PROCESS  * 04820000
048300* RCBS :B5139701        (MM/DD/YY)     SPECIAL CHARACTER.       * 04830000
048400* NEO #:0015405                                                 * 04840000
048500*                                                               * 04850000
048600* R110915    VXSHAR9     09/15/11 NEW INSERTED TO XIRI003Y      * 04860000
048700* NEO 24546                       AND XIRI004Y :                * 04870000
048800* RCBS:B4736102                   APPLCN_BLG_GR_ID              * 04880000
048900* DIRECV ENSEMBLE                                               * 04890000
049000*                                                               * 04900000
049100* R111208    UCHANDR     12/08/11     CHANGES TO MOVE           * 04910000
049200* NEO 0025220                         APPLCN-BLG-GR-ID FROM     * 04920000
049300* RCBS B5339801                       C1000LK1 TO C2000LK1      * 04930000
049400*                                                               * 04940000
049500* R111208    DCOWAN      11/15/11     CORRECTION TO 1ST AND 2ND * 04950000
049600* REMEDY HD5303411                    RESTART-500 AREAS TO RESET* 04960000
049700* RCBS CRIS10M0                       THE AREA SIZE TO 500 BYTES* 04970000
049800*                                                               * 04980000
049900* R121213    PKCHAND   11/14/13  FOR CTV AND QBSI CUST-INQ-NO IS* 04990000
050000* NEO                            POPULATED WITH ZEROS WITH PRISM* 05000000
050100* RCBS I.002160.V.11             PROJECT                        * 05010000
050200*                                                               * 05020000
050300* R140213    DCOWAN    12/15/13  MODIFICATION FOR ICE PHASE 0   * 05030000
050400* NEO 0029898                    PROJECT - MOVE SUB ENTITY AND  * 05040000
050500* WBS I.002619.C.27              PAYMENT REF ID TO USA2         * 05050000
050600*                                                               * 05060000
050700* R140320    DCOWAN    03/11/14  MODIFICATION FOR TAX REPORTING * 05070000
050800* REMEDY HD6745378               TO REVENUE JOURNALS/FINANCE.   * 05080000
050900* WBS I.003427.E.07                                             * 05090000
051000*                                                               * 05100000
051100* R140814    AKMOHA2     08/14/14      RECOMPILE THE CODE FOR   * 05110000
051200* NEO 7207707          (MM/DD/YY)      E81XXXXM AND EX81XXXX    * 05120000
051300* WBS:                                 COPYBOOK CHANGES         * 05130000
051400*                                                               * 05140000
051500* R150219    DCOWAN    11/07/14  MODIFICATION FOR ICE CHANGE    * 05150000
051600* CLARITY: PR0001059             CONTROL R2 PROJECT.            * 05160000
051700*                                INCLUDES A CALL TO A NEW SUB-  * 05170000
051800*                                MODULE - XIRI1090 - TO HANDLE  * 05180000
051900*                                THE MERGING OF THE ENA INVOICE * 05190000
052000*                                WITH THE ENF INVOICE.          * 05200000
052100*                                                               * 05210000
052200* R150219    DCOWAN    01/12/15  INITIALIZE WS-XIRI031Y-RCD-FET * 05220000
052300* CLARITY: PR0001059             COUNTER ON RESTART BEFORE THE  * 05230000
052400*                                DATA DICTIONARY IS LOADED.     * 05240000
052500*                                AND ADJUSTED THE               * 05250000
052600*                                WS-INV-IN-SPLR-CNT AND         * 05260000
052700*                                WS-HDR-TRL-CNT COUNTERS WHEN   * 05270000
052800*                                RESTARTING A CARRIER WHO'S     * 05280000
052900*                                INPUT DATA IS SORTED.          * 05290000
053000*                                WITH THE ENF INVOICE.          * 05300000
053100*                                                               * 05310000
053200* PR0002414  UCHANDR     15/05/14     RECOMPILED FOR E015121M   * 05320000
053300* CR# 5327                            AND E015127M COPYBOOK     * 05330000
053400*                                     CHANGES FOR REDEFINING    * 05340000
053500*                                     SUM21-IX-CARR-RTRN-CD-3 TO* 05350000
053600*                                     SUM21-ICE-ENA-NULL-INV    * 05360000
053700*                                                               * 05370000
053800* R150820    DCOWAN    04/22/15  MODIFICATION TO PROCESS DTV &  * 05380000
053900* PR0001197                      QBSI MIXED BILLING SYSTEM      * 05390000
054000*                                ACCCOUNTS.                     * 05400000
054100* R160818    UCHANDR   08/18/16  MODIFICATION TO SAVE THE ENA   * 05410000
054200* HD00008566333                  INVOICE RECORD TO NEW TABLE    * 05420000
054300*                                XZ8USA7T.                      * 05430000
054400* R170209    UCHANDR   02/09/17  MODIFICATION TO CHECK FOR VZW  * 05440000
054500* PR0007390                      INVOICES FOR VZW BOBO PROJECT  * 05450000
054600*                                                               * 05460000
054700* R170511    JXMILL9   05/21/17  RECOMPILE THE CODE FOR         * 05470000
054800* PR0008376                      E202205M AND E202206M          * 05480000
054900* HD00009506436                  COPYBOOK CHANGES.              * 05490000
055000*                                                               * 05500001
055100* R171109    DCOWAN    10/04/17  REARRANGE RESTART AREAS 1,2 &  * 05510001
055200* PR0008376                      4 SO THEY ARE NO MORE THAN 500 * 05520001
055300* HD00009776071                  BYTES IN LENGTH                * 05530001
055400***************************************************************** 05540000
055500     EJECT                                                        05550000
055600***************************************************************** 05560000
055700* E N V I R O N M E N T   D I V I S I O N                       * 05570000
055800***************************************************************** 05580000
055900*                                                                 05590000
056000 ENVIRONMENT DIVISION.                                            05600000
056100 CONFIGURATION SECTION.                                           05610000
056200 SOURCE-COMPUTER. IBM-3090.                                       05620000
056300*  SOURCE-COMPUTER.   IBM-3090 WITH DEBUGG                        05630000
056400 OBJECT-COMPUTER. IBM-3090.                                       05640000
056500                                                                  05650000
056600 INPUT-OUTPUT SECTION.                                            05660000
056700                                                                  05670000
056800 FILE-CONTROL.                                                    05680000
056900                                                                  05690000
057000     SELECT FD-I100001I                                           05700000
057100            ASSIGN TO I100001I                                    05710000
057200            ORGANIZATION IS SEQUENTIAL                            05720000
057300            ACCESS MODE IS SEQUENTIAL.                            05730000
057400                                                                  05740000
057500     SELECT SD-I100003O                                           05750000
057600            ASSIGN TO SORTFILE.                                   05760000
057700                                                                  05770000
057800     SELECT FD-I100004O                                           05780000
057900            ASSIGN TO I100004O                                    05790000
058000            ORGANIZATION IS SEQUENTIAL                            05800000
058100            ACCESS MODE IS SEQUENTIAL.                            05810000
058200                                                                  05820000
058300***************************************************************** 05830000
058400* D A T A    D I V I S I O N                                    * 05840000
058500***************************************************************** 05850000
058600*                                                                 05860000
058700 DATA DIVISION.                                                   05870000
058800 FILE SECTION.                                                    05880000
058900                                                                  05890000
059000 FD  FD-I100001I                                                  05900000
059100     BLOCK CONTAINS 0                                             05910000
059200     LABEL RECORDS ARE STANDARD                                   05920000
059300     RECORDING MODE IS V.                                         05930000
059400 01  INV-IN-1I                   PIC X(329).                      05940000
059500                                                                  05950000
059600 FD FD-I100004O                                                   05960000
059700     BLOCK CONTAINS 0                                             05970000
059800     LABEL RECORDS ARE STANDARD                                   05980000
059900     RECORDING MODE IS F.                                         05990000
060000 01  I100004O                    PIC X(500).                      06000000
060100                                                                  06010000
060200 SD SD-I100003O                                                   06020000
060300     RECORD CONTAINS 416.                                         06030000
060400 01  SORT-RECORD.                                                 06040000
060500     05  SORT-KEY                PIC X(150).                      06050000
060600     05  SORT-RCD                PIC X(266).                      06060000
060700                                                                  06070000
060800     EJECT                                                        06080000
060900***************************************************************** 06090000
061000* W O R K I N G - S T O R A G E    S E C T I O N                * 06100000
061100***************************************************************** 06110000
061200*                                                                 06120000
061300 WORKING-STORAGE SECTION.                                         06130000
061400 COPY NDVRWKST.                                                   06140000
061500                                                                  06150000
061600***************************************************************** 06160000
061700*                                                               * 06170000
061800*   XIRI1000 MODULE SPECIFIC WORKING STORAGE                    * 06180000
061900*                                                               * 06190000
062000***************************************************************** 06200000
062100 01  XIRI1000-WORKING-STORAGE.                                    06210000
062200                                                                  06220000
062300     05  LT-XIRI1000-LITERALS.                                    06230000
062400         10  WS-PROGRAM-NAME-LIT PIC X(08)      VALUE 'XIRI1000'. 06240000
062500         10  LT-RAO-TABLE-LENGTH PIC S9(4)      VALUE +100.       06250000
062600         10  LT-ERRR-TBL-LENGTH  PIC S9(4)      VALUE +50.        06260000
062700         10  LT-DATA-DICT-TBL-SZ PIC S9(4)      VALUE +50.        06270000
062800         10  WS-TEMP-CNT         PIC 9(07)      VALUE 0.          06280000
062900         10  LT-ALPHA-3          PIC X(01)      VALUE '3'.        06290000
063000         10  LT-DFLT-DAT         PIC X(10)      VALUE             06300000
063100             '1900-01-01'.                                        06310000
063200         10  LT-DFLT-TMSTMP      PIC X(26)      VALUE             06320000
063300             '1900-01-01-00.00.00.000000'.                        06330000
063400         10  LT-REGENTRY         PIC X(08)      VALUE 'REGENTRY'. 06340000
063500         10  LT-DUPCHK           PIC X(06)      VALUE 'DUPCHK'.   06350000
063600         10  LT-MAX-PREV-IDX     PIC  9(2) COMP VALUE 25.         06360000
063700         10  LT-RTM-CNT          PIC  9(2)      VALUE 00.         06370000
063800         10  LT-ASCI-RTM         PIC X(01)      VALUE ''.        06380000
063900         10  LT-DT               PIC X(02)      VALUE 'DT'.       06390000
064000         10  LT-IR               PIC X(02)      VALUE 'IR'.       06400000
064100         10  LT-SC               PIC X(02)      VALUE 'SC'.       06410000
064200         10  LT-TS               PIC X(02)      VALUE 'TS'.       06420000
064300         10  LT-TX               PIC X(02)      VALUE 'TX'.       06430000
064400         10  LT-FT               PIC X(02)      VALUE 'FT'.       06440000
064500         10  LT-SL               PIC X(02)      VALUE 'SL'.       06450000
064600         10  LT-BS               PIC X(02)      VALUE 'BS'.       06460000
064700         10  LT-C                PIC X(01)      VALUE 'C'.        06470000
064800         10  LT-D                PIC X(01)      VALUE 'D'.        06480000
064900         10  LT-F                PIC X(01)      VALUE 'F'.        06490000
065000         10  LT-N                PIC X(01)      VALUE 'N'.        06500000
065100         10  LT-Y                PIC X(01)      VALUE 'Y'.        06510000
065200         10  LT-ICE              PIC X(04)      VALUE '9998'.     06520000
065300         10  LT-I102             PIC X(04)      VALUE 'I102'.     06530000
065400         10  LT-I103             PIC X(04)      VALUE 'I103'.     06540000
065500         10  LT-I104             PIC X(04)      VALUE 'I104'.     06550000
065600         10  LT-I201             PIC X(04)      VALUE 'I201'.     06560000
065700         10  LT-PYDTL            PIC X(05)      VALUE 'PYDTL'.    06570000
065800         10  LT-QBS              PIC X(03)      VALUE 'QBS'.      06580000
065900         10  LT-S                PIC X(01)      VALUE 'S'.        06590000
066000         10  LT-QBS77            PIC X(05)      VALUE 'QBS77'.    06600000
066100         10  LT-015127           PIC X(06)      VALUE '015127'.   06610000
066200         10  LT-MX               PIC X(02)      VALUE 'MX'.       06620000
066300         10  LT-MIXED            PIC X(05)      VALUE 'MIXED'.    06630000
066400         10  LT-50-NUM           PIC  9(4) COMP VALUE 50.         06640000
066500         10  LT-99               PIC S9(4)      VALUE +99.        06650000
066600         10  LT-100-NUM          PIC  9(4) COMP VALUE 100.        06660000
066700         10  LT-1000-NUM         PIC  9(4) COMP VALUE 1000.       06670000
066800         10  LT-0                PIC 9(1)  VALUE 0.               06680000
066900         10  LT-1                PIC 9(1)  VALUE 1.               06690000
067000         10  LT-2                PIC 9(1)  VALUE 2.               06700000
067100         10  LT-3                PIC 9(1)  VALUE 3.               06710000
067200         10  LT-4                PIC 9(1)  VALUE 4.               06720000
067300         10  LT-5                PIC 9(1)  VALUE 5.               06730000
067400         10  LT-6                PIC 9(1)  VALUE 6.               06740000
067500         10  LT-7                PIC 9(1)  VALUE 7.               06750000
067600         10  LT-8                PIC 9(1)  VALUE 8.               06760000
067700         10  LT-9                PIC 9(1)  VALUE 9.               06770000
067800         10  LT-07               PIC 9(2)  VALUE 07.              06780000
067900         10  LT-10               PIC 9(2)  VALUE 10.              06790000
068000         10  LT-12               PIC 9(2)  VALUE 12.              06800000
068100         10  LT-18               PIC 9(2)  VALUE 18.              06810000
068200         10  LT-24               PIC 9(2)  VALUE 24.              06820000
068300         10  LT-30               PIC 9(2)  VALUE 30.              06830000
068400         10  LT-36               PIC 9(2)  VALUE 36.              06840000
068500         10  LT-40               PIC 9(2)  VALUE 40.              06850000
068600         10  LT-42               PIC 9(2)  VALUE 42.              06860000
068700         10  LT-48               PIC 9(2)  VALUE 48.              06870000
068800         10  LT-54               PIC 9(2)  VALUE 54.              06880000
068900                                                                  06890000
069000***************************************************************** 06900000
069100*   CALLED MODULE LITERALS                                      * 06910000
069200***************************************************************** 06920000
069300     05  LT-CALLED-MODULE-LITERALS.                               06930000
069400         10  LT-CO900AA0         PIC X(8) VALUE 'CO900AA0'.       06940000
069500         10  LT-XIRC1000         PIC X(8) VALUE 'XIRC1000'.       06950000
069600         10  LT-XIRC2000         PIC X(8) VALUE 'XIRC2000'.       06960000
069700         10  LT-XIRC3000         PIC X(8) VALUE 'XIRC3000'.       06970000
069800         10  LT-XIRC4000         PIC X(8) VALUE 'XIRC4000'.       06980000
069900         10  LT-XIRC5000         PIC X(8) VALUE 'XIRC5000'.       06990000
070000         10  LT-XIRDAI10         PIC X(8) VALUE 'XIRDAI10'.       07000000
070100         10  LT-XIRE1000         PIC X(8) VALUE 'XIRE1000'.       07010000
070200         10  LT-XIRI1000         PIC X(8) VALUE 'XIRI1000'.       07020000
070300         10  LT-XIRZ1000         PIC X(8) VALUE 'XIRZ1000'.       07030000
070400         10  LT-XIRZ1100         PIC X(8) VALUE 'XIRZ1100'.       07040000
070500         10  LT-XIRZ7000         PIC X(8) VALUE 'XIRZ7000'.       07050000
070600         10  LT-XIRZ7200         PIC X(8) VALUE 'XIRZ7200'.       07060000
070700         10  LT-XIRZ9000         PIC X(8) VALUE 'XIRZ9000'.       07070000
070800         10  LT-XIRZA000         PIC X(8) VALUE 'XIRZA000'.       07080000
070900         10  LT-XIRZB000         PIC X(8) VALUE 'XIRZB000'.       07090000
071000         10  LT-XIRZC000         PIC X(8) VALUE 'XIRZC000'.       07100000
071100                                                                  07110000
071200***************************************************************** 07120000
071300*          ERROR CODES                                          * 07130000
071400***************************************************************** 07140000
071500     05  LT-ERROR-CODE-LITERALS.                                  07150000
071600         10  DATETIME-ERR        PIC X(4) VALUE '3845'.           07160000
071700         10  ERR-3901            PIC X(4) VALUE '3901'.           07170000
071800         10  ERR-3902            PIC X(4) VALUE '3902'.           07180000
071900         10  ERR-3903            PIC X(4) VALUE '3903'.           07190000
072000         10  ERR-3904            PIC X(4) VALUE '3904'.           07200000
072100         10  ERR-3905            PIC X(4) VALUE '3905'.           07210000
072200         10  ERR-3906            PIC X(4) VALUE '3906'.           07220000
072300         10  ERR-3907            PIC X(4) VALUE '3907'.           07230000
072400         10  ERR-3908            PIC X(4) VALUE '3908'.           07240000
072500         10  ERR-3909            PIC X(4) VALUE '3909'.           07250000
072600         10  ERR-3910            PIC X(4) VALUE '3910'.           07260000
072700         10  ERR-3911            PIC X(4) VALUE '3911'.           07270000
072800         10  ERR-3912            PIC X(4) VALUE '3912'.           07280000
072900         10  ERR-3913            PIC X(4) VALUE '3913'.           07290000
073000         10  ERR-3915            PIC X(4) VALUE '3915'.           07300000
073100         10  ERR-3916            PIC X(4) VALUE '3916'.           07310000
073200         10  ERR-3922            PIC X(4) VALUE '3922'.           07320000
073300         10  ERR-3923            PIC X(4) VALUE '3923'.           07330000
073400         10  ERR-3924            PIC X(4) VALUE '3924'.           07340000
073500         10  ERR-3925            PIC X(4) VALUE '3925'.           07350000
073600         10  ERR-3926            PIC X(4) VALUE '3926'.           07360000
073700         10  ERR-3928            PIC X(4) VALUE '3928'.           07370000
073800         10  ERR-3929            PIC X(4) VALUE '3929'.           07380000
073900         10  ERR-3943            PIC X(4) VALUE '3943'.           07390000
074000         10  ERR-3974            PIC X(4) VALUE '3974'.           07400000
074100         10  ERR-3975            PIC X(4) VALUE '3975'.           07410000
074200         10  ERR-3976            PIC X(4) VALUE '3976'.           07420000
074300         10  ERR-3977            PIC X(4) VALUE '3977'.           07430000
074400         10  ERR-3978            PIC X(4) VALUE '3978'.           07440000
074500         10  ERR-3999            PIC X(4) VALUE '3999'.           07450000
074600         10  ERR-8001            PIC X(4) VALUE '8001'.           07460000
074700                                                                  07470000
074800***************************************************************** 07480000
074900*    I/O LITERALS                                               * 07490000
075000***************************************************************** 07500000
075100     05  LT-DDNAME-LITERALS.                                      07510000
075200         10  LT-I100001I         PIC X(8) VALUE 'I100001I'.       07520000
075300         10  LT-HDRTRLCT         PIC X(8) VALUE 'HDRTRLCT'.       07530000
075400         10  LT-SUM21CNT         PIC X(8) VALUE 'SUM21CNT'.       07540000
075500         10  LT-USA1CNT          PIC X(8) VALUE 'USA1CNT '.       07550000
075600         10  LT-INVINCNT         PIC X(8) VALUE 'INVINCNT'.       07560000
075700         10  LT-OUTABAL          PIC X(8) VALUE 'OUTABAL '.       07570000
075800     05  LT-VIEW-LITERALS.                                        07580000
075900         10  LT-XIRI001Y         PIC X(8) VALUE 'XIRI001Y'.       07590000
076000         10  LT-XIRI002Y         PIC X(8) VALUE 'XIRI002Y'.       07600000
076100         10  LT-XIRI003Y         PIC X(8) VALUE 'XIRI003Y'.       07610000
076200         10  LT-XIRI004Y         PIC X(8) VALUE 'XIRI004Y'.       07620000
076300         10  LT-XIRI006Y         PIC X(8) VALUE 'XIRI006Y'.       07630000
076400         10  LT-XIRI008Y         PIC X(8) VALUE 'XIRI008Y'.       07640000
076500         10  LT-XIRI013Y         PIC X(8) VALUE 'XIRI013Y'.       07650000
076600         10  LT-XIRI022Y         PIC X(8) VALUE 'XIRI022Y'.       07660000
076700         10  LT-XIRI031Y         PIC X(8) VALUE 'XIRI031Y'.       07670000
076800         10  LT-XIRI033Y         PIC X(8) VALUE 'XIRI033Y'.       07680000
076900         10  LT-XIRI034Y         PIC X(8) VALUE 'XIRI034Y'.       07690000
077000         10  LT-XIRI040Y         PIC X(8) VALUE 'XIRI040Y'.       07700000
077100         10  LT-XIRI041Y         PIC X(8) VALUE 'XIRI041Y'.       07710000
077200         10  LT-XIRI042Y         PIC X(8) VALUE 'XIRI042Y'.       07720000
077300         10  LT-XIRI043Y         PIC X(8) VALUE 'XIRI043Y'.       07730000
077400         10  LT-XIRI044Y         PIC X(8) VALUE 'XIRI044Y'.       07740000
077500         10  LT-XIRI090Y         PIC X(8) VALUE 'XIRI090Y'.       07750000
077600                                                                  07760000
077700***************************************************************** 07770000
077800*          RECORD ID LITERALS                                   * 07780000
077900***************************************************************** 07790000
078000     05  LT-REC-ID-LITERALS.                                      07800000
078100         10  LT-202206           PIC X(6) VALUE '202206'.         07810000
078200         10  LT-015121           PIC X(6) VALUE '015121'.         07820000
078300         10  LT-WRAPUP           PIC X(6) VALUE 'WRAPUP'.         07830000
078400                                                                  07840000
078500***************************************************************** 07850000
078600*          DB2 RETURN CODES                                     * 07860000
078700***************************************************************** 07870000
078800     05  LT-DB2-RETURN-CODES.                                     07880000
078900         10  LT-NORMAL-RETURN    PIC S9(9) COMP VALUE ZERO.       07890000
079000         10  LT-REC-FOUND        PIC S9(9) COMP VALUE ZERO.       07900000
079100         10  LT-REC-NOT-FOUND    PIC S9(9) COMP VALUE +100.       07910000
079200         10  LT-DUPL-INSERT      PIC S9(9) COMP VALUE -803.       07920000
079300         10  LT-DUPL-ROWS        PIC S9(9) COMP VALUE -811.       07930000
079400     05  LT-ALPHA-RETURN-CODES   PIC X(4).                        07940000
079500     05  LT-SUCCESSFUL           PIC X(4)  VALUE '0000'.          07950000
079600     05  LT-NOT-FOUND            PIC X(4)  VALUE '0100'.          07960000
079700     05  LT-100                  PIC X(4)  VALUE '0100'.          07970000
079800                                                                  07980000
079900                                                                  07990000
080000***************************************************************** 08000000
080100*           WS FIELDS FOR 015127 TO DETERMINE SPEC-CHAR MARKS   * 08010000
080200***************************************************************** 08020000
080300*                                                                 08030000
080400 01  WS-015127-PHRS-VARS.                                         08040000
080500     05  WS-PHRS-VAR-1                  PIC X(10).                08050000
080600         88  SPEC-CHAR-1                VALUE '(.)      ',        08060000
080700                                              '(SM)     ',        08070000
080800                                              '(TM)     ',        08080000
080900                                              '(R)      '.        08090000
081000     05  WS-PHRS-VAR-2                  PIC X(10).                08100000
081100         88  SPEC-CHAR-2                VALUE '(.)      ',        08110000
081200                                              '(SM)     ',        08120000
081300                                              '(TM)     ',        08130000
081400                                              '(R)      '.        08140000
081500     05  WS-PHRS-VAR-3                  PIC X(10).                08150000
081600         88  SPEC-CHAR-3                VALUE '(.)      ',        08160000
081700                                              '(SM)     ',        08170000
081800                                              '(TM)     ',        08180000
081900                                              '(R)      '.        08190000
082000     05  WS-PHRS-VAR-4                  PIC X(10).                08200000
082100         88  SPEC-CHAR-4                VALUE '(.)      ',        08210000
082200                                              '(SM)     ',        08220000
082300                                              '(TM)     ',        08230000
082400                                              '(R)      '.        08240000
082500     05  WS-PHRS-VAR-5                  PIC X(10).                08250000
082600         88  SPEC-CHAR-5                VALUE '(.)      ',        08260000
082700                                              '(SM)     ',        08270000
082800                                              '(TM)     ',        08280000
082900                                              '(R)      '.        08290000
083000     05  WS-PHRS-VAR-6                  PIC X(10).                08300000
083100         88  SPEC-CHAR-6                VALUE '(.)      ',        08310000
083200                                              '(SM)     ',        08320000
083300                                              '(TM)     ',        08330000
083400                                              '(R)      '.        08340000
083500     05  WS-PHRS-VAR-7                  PIC X(10).                08350000
083600         88  SPEC-CHAR-7                VALUE '(.)      ',        08360000
083700                                              '(SM)     ',        08370000
083800                                              '(TM)     ',        08380000
083900                                              '(R)      '.        08390000
084000     05  WS-PHRS-VAR-8                  PIC X(01).                08400000
084100         88  SPEC-CHAR-8                VALUE ''.                08410000
084200***************************************************************** 08420000
084300*  ADDITIONAL DISPLAY FIELDS USED IN Z9000LK1                     08430000
084400***************************************************************** 08440000
084500                                                                  08450000
084600     05  WS-ERRR-DISPL-AREA.                                      08460000
084700         10  WS-ERRR-DISPL.                                       08470000
084800             15  WS-ERRR-LTRL    PIC X(25)   VALUE SPACES.        08480000
084900             15  FILLER          PIC X(03)   VALUE ' = '.         08490000
085000             15  WS-ERRR-VAL     PIC X(22)   VALUE SPACES.        08500000
085100                                                                  08510000
085200         10  WS-ERRR-DISPL-MSGS.                                  08520000
085300             15  LT-TOT-MSG-NO        PIC X(25)   VALUE           08530000
085400                                      'TOT-MSG-NO               '.08540000
085500             15  LT-TOT-SUM-RECS      PIC X(25)   VALUE           08550000
085600                                      'TOT-SUM-RECS             '.08560000
085700             15  LT-RECS-CRTD         PIC X(25)   VALUE           08570000
085800                                      'RECS-CRTD                '.08580000
085900             15  LT-RECS-NOT-PRTD     PIC X(25)   VALUE           08590000
086000                                      'RECS-NOT-PRTD            '.08600000
086100             15  LT-USA2-PRNTBLE-RECS PIC X(25)   VALUE           08610000
086200                                      'USA2-PRNTBLE-RECS        '.08620000
086300             15  LT-FI-CNTLS-OUT-BAL  PIC X(25)   VALUE           08630000
086400                                      'INVOICES OUT OF BALANCE  '.08640000
086500             15  WS-INVD-BLG-NO       PIC X(25)   VALUE           08650000
086600                                      'THE INVALID BILLING # IS '.08660000
086700             15  WS-INVD-MA-BLG-NO    PIC X(25)   VALUE           08670000
086800                                      'THE INVALID MAST BLG # IS'.08680000
086900             15  WS-INVD-SPLR-LTRL    PIC X(25)   VALUE           08690000
087000                                      'THE INVALID SUPPLIER ID  '.08700000
087100             15  WS-INVD-FUNC-ID      PIC X(25)   VALUE           08710000
087200                                      'THE INVALID FUNCTION ID  '.08720000
087300             15  WS-INVD-MODULE       PIC X(25)   VALUE           08730000
087400                                      'THE INVALID MODULE ID IS '.08740000
087500             15  WS-INV-RCD-ID-LTRL   PIC X(25)   VALUE           08750000
087600                                      'UNIDENTIFIED INV RCD ID  '.08760000
087700             15  WS-APPLCN-LOC-LTRL   PIC X(25)   VALUE           08770000
087800                                      'XIRC2000 APPLCN LOC ID   '.08780000
087900         10  WS-APPLCN-RGN-LTRL       PIC X(25)   VALUE           08790000
088000                                      'XIRC2000 APPLCN RGN ID   '.08800000
088100         10  WS-SPLR-ID-LTRL          PIC X(25)   VALUE           08810000
088200                                      'SUPPLIER ID              '.08820000
088300         10  WS-BILL-RAO-LTRL         PIC X(25)   VALUE           08830000
088400                                      'BILL RAO OF TRAN ACCP RCD'.08840000
088500         10  WS-PACK-TRLR-CT-LTRL     PIC X(25)   VALUE           08850000
088600                                      'PACK TRAILER COUNT       '.08860000
088700         10  WS-PACK-RCD-CT-LTRL      PIC X(25)   VALUE           08870000
088800                                      'PACK RECORD COUNT        '.08880000
088900         10  WS-TRLR-PACK-CT-LTRL     PIC X(25)   VALUE           08890000
089000                                      'SPLR TRLR PACK COUNT     '.08900000
089100         10  WS-PACK-PRCSS-LTRL       PIC X(25)   VALUE           08910000
089200                                      'NUMBER OF PACKS PROCESSED'.08920000
089300         10  WS-NDM-TRLR-CT-LTRL      PIC X(25)   VALUE           08930000
089400                                      'NDM TRLR TOTAL RCD COUNT '.08940000
089500         10  WS-TOT-INV-CT-LTRL       PIC X(25)   VALUE           08950000
089600                                      'TOTAL INVOICES READ COUNT'.08960000
089700         10  LT-SPLR-UNIQ-INV-DA      PIC X(25)   VALUE           08970000
089800                                      'SPLR-UNIQ-INV-DA         '.08980000
089900         10  WS-EXCH-MSG-ACCT-NO      PIC X(25)   VALUE           08990000
090000                                      'EXCH-MSG-ACCT-NO         '.09000000
090100         10  WS-EXCH-MSG-BLLD-DAT     PIC X(25)   VALUE           09010000
090200                                      'EXCH-MSG-BLLD-DAT        '.09020000
090300         10  WS-EXCH-MSG-OBLGTN-ID     PIC X(25)   VALUE          09030000
090400                                      'EXCH-MSG-OBLGTN-ID       '.09040000
090500         10  WS-MSG-GID-AUTO-NO-ID     PIC X(25)   VALUE          09050000
090600                                      'MSG-GID-AUTO-NO-ID       '.09060000
090700         10  WS-INV-HDR-SEQ-NO        PIC X(25)   VALUE           09070000
090800                                      'SEQ NO SHOULD = PREV + 1 '.09080000
090900         10  WS-CURR-FIL-SEQ-NO       PIC X(25)   VALUE           09090000
091000                                      'INVALID  HEADER SEQ NO   '.09100000
091100         10  WS-PREV-FIL-SEQ-NO       PIC X(25)   VALUE           09110000
091200                                      'PREVIOUS HEADER SEQ NO   '.09120000
091300         10  WS-DISPLAY-AMT           PIC ZZZZZZZZZZZ.99.         09130000
091400         10  WS-FIRST-50-BYTES    PIC X(50)   VALUE               09140000
091500                    'THE FIRST 50 BYTES OF THE INVOICE RECORD:  '.09150000
091600                                                                  09160000
091700         10  WS-USG-ID-LTRL.                                      09170000
091800             15  FILLER           PIC X(30)   VALUE               09180000
091900                                  'UPDATING USAGE ID         =  '.09190000
092000             15  WS-UPD-USG-ID    PIC X(26).                      09200000
092100                                                                  09210000
092200         10  WS-INV-RCD-NO-LTRL.                                  09220000
092300             15  FILLER           PIC X(30)   VALUE               09230000
092400                                  'INVOICE RECORD NUMBER     =  '.09240000
092500             15  WS-INV-RCD-NO    PIC 9(9).                       09250000
092600         10  WS-FI-CNTLS-ERRR     PIC X(50) VALUE                 09260000
092700             'USA1 TOT REV SHOULD = USA2 SUMMARY OF CHARGES AMT '.09270000
092800         10  WS-II-CNTLS-ERRR-1   PIC X(50) VALUE                 09280000
092900             'USA2-PRNTBLE-RECS  SHOULD EQUAL                   '.09290000
093000         10  WS-II-CNTLS-ERRR-2   PIC X(50) VALUE                 09300000
093100             'TOT-MSG + RECS-CRTD + TOT-SUM-RECS - RECS-NOT-PRTD'.09310000
093200         10  WS-DSC1-ERROR-MSG    PIC X(50) VALUE                 09320000
093300             'CHECK THE XY4DSC1T TABLE FOR POSSIBLE PROBLEM     '.09330000
093400         10  WS-DSB2T-ERRR-MSG    PIC X(50) VALUE                 09340000
093500             'CHECK THE XY4DSB2T TABLE FOR POSSIBLE PROBLEM     '.09350000
093600         10  WS-DSB4T-ERRR-MSG    PIC X(50) VALUE                 09360000
093700             'CHECK THE XY4DSB4T TABLE FOR POSSIBLE PROBLEM     '.09370000
093800         10  WS-USA2T-ERRR-MSG    PIC X(50) VALUE                 09380000
093900             'CHECK THE XZ8USA2T TABLE FOR POSSIBLE PROBLEM     '.09390000
094000         10  WS-USA1T-ERRR-MSG    PIC X(50) VALUE                 09400000
094100             'CHECK THE XZ8USA1T TABLE FOR POSSIBLE PROBLEM     '.09410000
094200         10  WS-USA7T-ERRR-MSG    PIC X(50) VALUE                 09420000
094300             'CHECK THE XZ8USA7T TABLE FOR POSSIBLE PROBLEM     '.09430000
094400         10  WS-DSE8T-ERRR-MSG    PIC X(50) VALUE                 09440000
094500             'CHECK THE XY4DSE8T TABLE FOR POSSIBLE PROBLEM     '.09450000
094600         10  WS-DSC7T-ERRR-MSG    PIC X(50) VALUE                 09460000
094700             'CHECK THE XY4DSC7T TABLE FOR POSSIBLE PROBLEM     '.09470000
094800         10  WS-AUA4T-ERRR-MSG    PIC X(50) VALUE                 09480000
094900             'CHECK THE XZ4AUA4T TABLE FOR POSSIBLE PROBLEM     '.09490000
095000         10  WS-DSC1T-ERRR-MSG    PIC X(50) VALUE                 09500000
095100             'CHECK THE XY4DSC1T TABLE FOR POSSIBLE PROBLEM     '.09510000
095200         10  WS-ERROR-CALL-XIRZ7200 PIC X(50) VALUE               09520000
095300             'ERROR DURING CALL OF XIRZ7200                     '.09530000
095400         10  WS-USG-ID-ERRR.                                      09540000
095500             15  FILLER           PIC X(10) VALUE                 09550000
095600                'USG ID IS '.                                     09560000
095700             15  WS-ERRR-USG-ID   PIC X(26) VALUE ZEROES.         09570000
095800             15  FILLER           PIC X(14) VALUE SPACES.         09580000
095900         10  WS-3913-MSG-2.                                       09590000
096000             15  FILLER           PIC X(21) VALUE                 09600000
096100                'USG SEQ NO ON RCD IS '.                          09610000
096200             15  WS-3913-USG-SEQ  PIC 9(09) VALUE ZEROES.         09620000
096300             15  FILLER           PIC X(20) VALUE SPACES.         09630000
096400         10  WS-3913-MSG-3.                                       09640000
096500             15  FILLER           PIC X(19) VALUE                 09650000
096600                ' USG SEQ SHOULD BE '.                            09660000
096700             15  WS-3913-SEQ-NXT  PIC 9(09) VALUE ZEROES.         09670000
096800             15  FILLER           PIC X(22) VALUE SPACES.         09680000
096900         10  WS-3929-MSG.                                         09690000
097000             15  FILLER             PIC X(36) VALUE               09700000
097100            'BAD SORT RETURN. SORT RETURN CODE = '.               09710000
097200             15  FILLER             PIC X(01) VALUE QUOTE.        09720000
097300             15  WS-3929-SRT-RTN    PIC X(04) VALUE SPACES.       09730000
097400             15  FILLER             PIC X(01) VALUE QUOTE.        09740000
097500             15  FILLER             PIC X(08) VALUE SPACES.       09750000
097600         10  WS-3943-ERR-MSG-1.                                   09760000
097700             15  FILLER             PIC X(10) VALUE               09770000
097800                'USG ID IS '.                                     09780000
097900             15  WS-3943-USG-ID     PIC X(26) VALUE SPACES.       09790000
098000             15  FILLER             PIC X(14) VALUE SPACES.       09800000
098100         10  WS-3943-ERR-MSG-2.                                   09810000
098200             15  FILLER             PIC X(14) VALUE               09820000
098300                'USG SEQ NO IS '.                                 09830000
098400             15  WS-3943-USG-SEQ-NO PIC 9(09) VALUE ZEROES.       09840000
098500             15  FILLER             PIC X(27) VALUE SPACES.       09850000
098600         10  WS-OUTABAL-MSG-1.                                    09860000
098700             15  FILLER                 PIC X(40) VALUE           09870000
098800                '*** INTEGRITY ERROR ON USA1 TABLE ***   '.       09880000
098900             15  FILLER                 PIC X(10) VALUE SPACES.   09890000
099000         10  WS-OUTABAL-MSG-2.                                    09900000
099100             15  FILLER                 PIC X(40) VALUE           09910000
099200                '    TOT-REV-AMT NOT = TOT-EXCL-TX-AMT + '.       09920000
099300             15  FILLER                 PIC X(10) VALUE           09930000
099400                'FED-TX-AMT'.                                     09940000
099500         10  WS-OUTABAL-MSG-3.                                    09950000
099600             15  FILLER                 PIC X(40) VALUE           09960000
099700                '    LOC-ST-TX-AMT + MSG-SURCHG-AMT      '.       09970000
099800             15  FILLER                 PIC X(10) VALUE           09980000
099900                '          '.                                     09990000
100000         10  WS-OUTABAL-MSG-4.                                    10000000
100100             15  FILLER                 PIC X(17) VALUE           10010000
100200                '    FOR USG-ID = '.                              10020000
100300             15  WS-OUTABAL-USG-ID      PIC X(26) VALUE SPACES.   10030000
100400             15  FILLER                 PIC X(15) VALUE           10040000
100500                ', USG-SEQ-NO = '.                                10050000
100600             15  WS-OUTABAL-USG-SEQ-NO  PIC 9(09) VALUE ZEROES.   10060000
100700                                                                  10070000
100800         10  DSPLSQL                  PIC ---9 VALUE ZERO.        10080000
100900     EJECT                                                        10090000
101000***************************************************************** 10100000
101100*  LITERALS USED FOR TRAIT MODULE - XIRZ7000                      10110000
101200***************************************************************** 10120000
101300                                                                  10130000
101400     05 WS-TRAIT-CD-MSG.                                          10140000
101500        10 FILLER                  PIC X(23)                      10150000
101600           VALUE 'TRAIT NOT FOUND      = '.                       10160000
101700        10 WS-TRAIT-CD-VAL         PIC X(20).                     10170000
101800                                                                  10180000
101900     05  LT-TRAITS.                                               10190000
102000         10  LT-SUM-WIRELESS     PIC X(20)   VALUE                10200000
102100                                 'SUM-WIRELESS-MSGS'.             10210000
102200         10  LT-JRN-TRAIT        PIC X(20)   VALUE                10220000
102300                                 'JRNS-USED'.                     10230000
102400         10  LT-BILLSIMP-TRAIT   PIC X(20)   VALUE                10240000
102500                                 'IS_BILL_SIMP_FORMAT'.           10250000
102600         10  LT-BILL-RQST-TYP    PIC X(20)   VALUE                10260000
102700                                 'MOVE-BILL-RQST-TYP '.           10270000
102800         10  LT-BLBL-MNS         PIC X(20)   VALUE                10280000
102900                                 'BLBL-MNS-FRMT'.                 10290000
103000         10  LT-WIFI-MNS         PIC X(20)   VALUE                10300000
103100                                 'WIFI-MNS-FRMT'.                 10310000
103200         10  LT-FMC-IND          PIC X(20)   VALUE                10320000
103300                                 'FMC-IND-FRMT'.                  10330000
103400         10  LT-015127-RCDS      PIC X(20)   VALUE                10340000
103500                                 '015127-RCDS'.                   10350000
103600                                                                  10360000
103700         10  LT-NORMAL-INV       PIC X(20)   VALUE                10370000
103800                                 'ALWAYS-NORMAL-INV'.             10380000
103900         10  LT-INSERT-HDG       PIC X(20)   VALUE                10390000
104000                                 'INSERT-015127-HDG'.             10400000
104100         10  LT-VZW-INVOICE      PIC X(20)   VALUE                10410000
104200                                 'VZW-INVOICE      '.             10420000
104300                                                                  10430000
104400*BGN MCR970317-70A                                                10440000
104500         10  LT-TAX-USG-ID       PIC X(20)   VALUE                10450000
104600                                 'POP-TAX-USG-ID'.                10460000
104700         10  LT-BILL-SUPPRESS    PIC X(20)   VALUE                10470000
104800                                 'BILL-SUPPRESSION'.              10480000
104900         10  LT-WIRELESS-STATION PIC X(20)   VALUE                10490000
105000                                 'WIRELESS-STATION'.              10500000
105100         10  LT-TELCO-ACCT-TYP   PIC X(20)   VALUE                10510000
105200                                 'TELCO-ACCT-TYP-INDR'.           10520000
105300         10  LT-INS-FST-TM-INV-INDR PIC X(20)   VALUE             10530000
105400                                 'INS-FST-TM-INV-INDR'.           10540000
105500         10  LT-SPLR-INTRNL-ACCT-NO PIC X(20)   VALUE             10550000
105600                                 'SPLR-INTRNL-ACC-NO'.            10560000
105700         10  LT-AFLT-TRNSCTN-IND PIC X(20)   VALUE                10570000
105800                                 'POPLAT-AFLT-TRNSCTN'.           10580000
105900         10  LT-EXCL-BILL-SIMP   PIC X(20)   VALUE                10590000
106000                                 'EXCL-BILL-SIMP'.                10600000
106100*END MCR970317-70A                                                10610000
106200         10  LT-CUST-INQ-NO      PIC X(20)   VALUE                10620000
106300                                 'CUST-INQ-NO'.                   10630000
106400         10  LT-USA5-TAX-USG-ID  PIC X(20)   VALUE                10640000
106500                                 'SEL-USA5-TAX-USG-ID'.           10650000
106600         10  LT-PRCSS-ICE-ENA    PIC X(20)   VALUE                10660000
106700                                 'PRCSS-ICE-ENA-PT3'.             10670000
106800         10  LT-POP-XZ8USA7T-TABLE                                10680000
106900                                 PIC X(20)   VALUE                10690000
107000                                 'POP-XZ8USA7T-TABLE'.            10700000
107100                                                                  10710000
107200         10  WS-HOLD-RECORDS.                                     10720000
107300             15 WS-HD-EMI-RECORD-AR  PIC X(220).                  10730000
107400             15 WS-HD-PHRASE-TYP     PIC X(01).                   10740000
107500             15 WS-HD-SPLR-PROV-INDR PIC X(01).                   10750000
107600             15 WS-HD-SPLR-TEXT-INDR PIC X(01).                   10760000
107700             15 WS-HD-BILL-SECT-1-10 PIC X(20).                   10770000
107800***************************************************************** 10780000
107900*                   TRAITS                                      * 10790000
108000***************************************************************** 10800000
108100     05  WS-TRAITS.                                               10810000
108200         10  WS-JRN-TRAIT             PIC X(08) VALUE 'NO      '. 10820000
108300             88 DO-JOURNALS                     VALUE 'YES     '. 10830000
108400             88 DONT-JOURNAL                    VALUE 'NO      '. 10840000
108500                                                                  10850000
108600         10  WS-BLBL-MNS-TRAIT        PIC X(08) VALUE 'SRTDMNS '. 10860000
108700             88 SORTED-MINUTES-ONLY             VALUE 'SRTDMNS '. 10870000
108800             88 NON-SORTED-10TH                 VALUE 'NSRTD10 '. 10880000
108900             88 NON-SORTED-10TH-MST             VALUE 'NSRTMST '. 10890000
109000             88 NON-SORTED-MIN-SEC              VALUE 'NSRTMNSC'. 10900000
109100             88 SORTED-10TH                     VALUE 'SRTD10  '. 10910000
109200                                                                  10920000
109300         10  WS-015127-TRAIT          PIC X(08) VALUE 'USE     '. 10930000
109400             88 SPLR-HAS-015127-RCDS            VALUE 'USE     '. 10940000
109500             88 DONT-USE-015127-RCDS            VALUE 'DONT-USE'. 10950000
109600                                                                  10960000
109700         10  WS-NORMAL-INV-TRAIT      PIC X(08) VALUE 'NO      '. 10970000
109800             88 SET-RVN-SCE-TYP-CD-TO-N         VALUE 'YES     '. 10980000
109900             88 ALLOW-CARD-AND-FEES             VALUE 'NO      '. 10990000
110000*BGN MCR970317-70A                                                11000000
110100                                                                  11010000
110200         10  WS-TAX-USG-ID-TRAIT      PIC X(08) VALUE 'NO      '. 11020000
110300             88 POPULATE-TAX-USG-ID             VALUE 'YES     '. 11030000
110400             88 DONT-POP-TAX-USG-ID             VALUE 'NO      '. 11040000
110500                                                                  11050000
110600*END MCR970317-70A                                                11060000
110700                                                                  11070000
110800         10  WS-WIRELESS-TRAIT        PIC X     VALUE 'N'.        11080000
110900             88 SUMMING-WIRELESS-OFF            VALUE 'Y'.        11090000
111000             88 SUMMING-WIRELESS-ON             VALUE 'N'.        11100000
111100                                                                  11110000
111200         10  WS-INSERT-015127-HDG     PIC X     VALUE 'N'.        11120000
111300             88 NO-INSERT-015127-HDG            VALUE 'N'.        11130000
111400             88 INSERT-015127-HDG               VALUE 'Y'.        11140000
111500                                                                  11150000
111600         10  WS-BILL-SUPPRESS-INDR    PIC X     VALUE 'N'.        11160000
111700             88 USED-BILL-SUPPRESS              VALUE 'Y'.        11170000
111800             88 NOT-USED-BILL-SUPRESS           VALUE 'N'.        11180000
111900                                                                  11190000
112000         10  WS-BILL-SIMP-FORMAT      PIC X(02) VALUE 'N0'.       11200000
112100             88 BILL-SIMP-FORMAT-YES            VALUE 'Y1'.       11210000
112200             88 BILL-SIMP-FORMAT-NO             VALUE 'N0'.       11220000
112300                                                                  11230000
112400         10  WS-BILL-RQST-TYP         PIC X(08) VALUE 'NO      '. 11240000
112500             88 BILL-RQST-TYP-YES               VALUE 'YES     '. 11250000
112600             88 BILL-RQST-TYP-NO                VALUE 'NO      '. 11260000
112700                                                                  11270000
112800         10  WS-WIFI-MNS-TRAIT        PIC X(08) VALUE 'NO      '. 11280000
112900             88 WIFI-MNS-YES                    VALUE 'YES     '. 11290000
113000             88 WIFI-MNS-NO                     VALUE 'NO      '. 11300000
113100                                                                  11310000
113200         10  WS-EXCL-BILL-SIMP-TRAIT  PIC X(08) VALUE 'NO      '. 11320000
113300             88 BILL-SIMP-SUPPRESS              VALUE 'YES     '. 11330000
113400             88 BILL-SIMP-ALLOW                 VALUE 'NO      '. 11340000
113500                                                                  11350000
113600         10  WS-CUST-INQ-NO-TRAIT     PIC X(08) VALUE 'NO      '. 11360000
113700             88 CUST-INQ-NUM-YES                VALUE 'YES     '. 11370000
113800             88 CUST-INQ-NUM-NO                 VALUE 'NO      '. 11380000
113900                                                                  11390000
114000         10  WS-USA5-TAX-USG-ID-TRAIT PIC X(01) VALUE 'N'.        11400000
114100             88 SEL-USA5-TAX-USG-ID             VALUE 'Y'.        11410000
114200             88 NO-USA5-TAX-USG-ID              VALUE 'N'.        11420000
114300                                                                  11430000
114400         10  WS-POP-XZ8USA7T-TABLE-TRAIT                          11440000
114500                                      PIC X(08) VALUE 'NO      '. 11450000
114600             88 POP-XZ8USA7T-TABLE-YES          VALUE 'YES     '. 11460000
114700             88 POP-XZ8USA7T-TABLE-NO           VALUE 'NO      '. 11470000
114800                                                                  11480000
114900         10  WS-LT-PRCSS-ICE-ENA-TRAIT PIC X(01) VALUE 'N'.       11490000
115000             88 PRCSS-ICE-ENA                   VALUE 'Y'.        11500000
115100             88 NO-PRCSS-ICE-ENA                VALUE 'N'.        11510000
115200                                                                  11520000
115300         10  WS-LT-VZW-INVOICE-TRAIT   PIC X(01) VALUE 'N'.       11530000
115400             88 VZW-INVOICE                     VALUE 'Y'.        11540000
115500             88 NO-VZW-INVOICE                  VALUE 'N'.        11550000
115600***************************************************************** 11560000
115700*      INDICATOR FOR INTER OR INTRA LATA MESSAGES               * 11570000
115800***************************************************************** 11580000
115900     05  WS-INTER-INTRA-INDR.                                     11590000
116000         10  WS-INTERLTA-INV-INDR     PIC X(01) VALUE 'N'.        11600000
116100             88 INTERLTA-MSGS-FND               VALUE 'Y'.        11610000
116200             88 INTERLTA-MSGS-NOT-FND           VALUE 'N'.        11620000
116300                                                                  11630000
116400         10  WS-INTRALTA-INV-INDR     PIC X(01) VALUE 'N'.        11640000
116500             88 INTRALTA-MSGS-FND               VALUE 'Y'.        11650000
116600             88 INTRALTA-MSGS-NOT-FND           VALUE 'N'.        11660000
116700                                                                  11670000
116800         10  WS-FMC-IND-VALUE         PIC X(1) VALUE SPACE.       11680000
116900             88 FMC-IND-YES                    VALUE 'Y'.         11690000
117000             88 FMC-IND-NO                     VALUE 'N'.         11700000
117100                                                                  11710000
117200***************************************************************** 11720000
117300*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 11730001
117400* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 11740001
117500***************************************************************** 11750000
117600 01  WS-FIRST-RESTART-500.                                        11760000
117700*** 950321-70   ALAN MASI  10/11/95   CIC                         11770000
117800*                                                                 11780000
117900*  INCREASED WS-SPLR-NUM TO 4 BYTES.                              11790000
118000*                                                                 11800000
118100     05  WS-CURR-SPLR.                                            11810000
118200         10  WS-SPLR-NUM                   PIC X(04).             11820000
118300         10  FILLER                        PIC X(02) VALUE SPACES.11830000
118400     05  WS-SPLR-AREA.                                            11840000
118500         10  WS-NPA                        PIC X(03).             11850000
118600         10  WS-NXX                        PIC X(03).             11860000
118700         10  WS-LINE                       PIC X(04).             11870000
118800     05  WS-SIMP-TRAIT-ACTN.                                      11880000
118900         10  WS-SIMP-TRAIT-ACT1            PIC X(01).             11890000
119000         10  WS-SIMP-TRAIT-ACT2            PIC X(01).             11900000
119100***************************************************************** 11910000
119200*          F L A G S                                            * 11920000
119300***************************************************************** 11930000
119400     05  WS-FLAGS.                                                11940000
119500         10  WS-LOCKOUT-VALUES             PIC S9(03).            11950000
119600             88  LOCKED-OUT               VALUE -901.             11960000
119700             88  LOCKED                   VALUE -901, -913, -911. 11970000
119800                                                                  11980000
119900         10  END-OF-SORT-LK                PIC X.                 11990000
120000             88 NOT-END-OF-SORT            VALUE 'N'.             12000000
120100             88 END-OF-SORT                VALUE 'Y'.             12010000
120200                                                                  12020000
120300         10  WS-CARD-ONLY                  PIC X(01) VALUE 'N'.   12030000
120400             88  CARD-ONLY                           VALUE 'Y'.   12040000
120500             88  NOT-CARD-ONLY                       VALUE 'N'.   12050000
120600                                                                  12060000
120700*** TR#175774  ALAN MASI  09/03/96  R961114                       12070000
120800*                                                                 12080000
120900* NEW FLAG TO TELL WHEN THE FIRST 81 RECORD IS FOUND              12090000
121000*                                                                 12100000
121100         10  WS-81-RECORD                  PIC X(01) VALUE 'Y'.   12110000
121200             88  FIRST-81-RECORD                     VALUE 'Y'.   12120000
121300             88  NOT-FIRST-81-RECORD                 VALUE 'N'.   12130000
121400                                                                  12140000
121500         10  WS-DUPL-FLG                   PIC X(01) VALUE 'N'.   12150000
121600             88  NO-DUPL                             VALUE 'N'.   12160000
121700             88  DUPL                                VALUE 'Y'.   12170000
121800                                                                  12180000
121900         10  WS-INSERT-USA7                PIC X(01) VALUE 'N'.   12190000
122000             88  NO-INSERT-USA7                      VALUE 'N'.   12200000
122100             88  INSERT-USA7                         VALUE 'Y'.   12210000
122200                                                                  12220000
122300         10  WS-RESTART-FLG                PIC X(01) VALUE 'N'.   12230000
122400             88  MODULE-WAS-NOT-RESTARTED            VALUE 'N'.   12240000
122500             88  MODULE-WAS-RESTARTED                VALUE 'Y'.   12250000
122600                                                                  12260000
122700         10  WS-NDM-HDR-FLG                PIC X(01) VALUE 'N'.   12270000
122800             88  NDM-HDR-READ                        VALUE 'Y'.   12280000
122900             88  NDM-HDR-NOT-READ                    VALUE 'N'.   12290000
123000                                                                  12300000
123100         10  WS-NDM-TRLR-FLG               PIC X(01) VALUE 'Y'.   12310000
123200             88  NDM-TRLR-READ                       VALUE 'Y'.   12320000
123300             88  NDM-TRLR-NOT-READ                   VALUE 'N'.   12330000
123400                                                                  12340000
123500         10  WS-SPLR-HDR-FLG               PIC X(01) VALUE 'N'.   12350000
123600             88  SPLR-HDR-READ                       VALUE 'Y'.   12360000
123700             88  SPLR-HDR-NOT-READ                   VALUE 'N'.   12370000
123800                                                                  12380000
123900         10  WS-SPLR-TRLR-FLG              PIC X(01) VALUE 'N'.   12390000
124000             88  SPLR-TRLR-READ                      VALUE 'Y'.   12400000
124100             88  SPLR-TRLR-NOT-READ                  VALUE 'N'.   12410000
124200                                                                  12420000
124300         10  WS-PACK-HDR-FLG               PIC X(01) VALUE 'N'.   12430000
124400             88  PACK-HDR-READ                       VALUE 'Y'.   12440000
124500             88  PACK-HDR-NOT-READ                   VALUE 'N'.   12450000
124600                                                                  12460000
124700         10  WS-PACK-TRLR-FLG              PIC X(01) VALUE 'N'.   12470000
124800             88  PACK-TRLR-READ                      VALUE 'Y'.   12480000
124900             88  PACK-TRLR-NOT-READ                  VALUE 'N'.   12490000
125000                                                                  12500000
125100         10  WS-SUM21-FLG                  PIC X(01) VALUE 'N'.   12510000
125200             88  SUM21-READ                          VALUE 'Y'.   12520000
125300             88  SUM21-NOT-READ                      VALUE 'N'.   12530000
125400                                                                  12540000
125500         10  WS-PHR27-FLG                  PIC X(01) VALUE 'N'.   12550000
125600             88  PHR27-READ                          VALUE 'Y'.   12560000
125700             88  PHR27-NOT-READ                      VALUE 'N'.   12570000
125800                                                                  12580000
125900         10  WS-FILE-I100001I-STATUS       PIC X(03) VALUE SPACES.12590000
126000             88  FILE-I100001I-EOF                   VALUE 'EOF'. 12600000
126100             88  FILE-I100001I-NOT-EOF               VALUE SPACES.12610000
126200                                                                  12620000
126300         10  WS-FILE-I-O-REQUEST           PIC X(01) VALUE SPACE. 12630000
126400             88  OPEN-FILE                           VALUE 'O'.   12640000
126500             88  CLOSE-FILE                          VALUE 'C'.   12650000
126600             88  READ-FILE                           VALUE 'R'.   12660000
126700             88  WRITE-FILE                          VALUE 'W'.   12670000
126800                                                                  12680000
126900         10  WS-INPT-OP-DA-NM-SW           PIC X(01) VALUE SPACE. 12690000
127000             88  PREV-INPT-OP-DA-NM-FOUND            VALUE 'Y'.   12700000
127100             88  PREV-INPT-OP-DA-NM-NOT-FOUND        VALUE 'N'.   12710000
127200                                                                  12720000
127300         10  WS-FIRST-TIME-IN-K000         PIC X(01) VALUE 'Y'.   12730000
127400             88 FIRST-TIME-IN-K000                   VALUE 'Y'.   12740000
127500             88 NOT-FIRST-TIME-IN-K000               VALUE 'N'.   12750000
127600                                                                  12760000
127700         10  WS-FIRST-TIME-IN-PACK-HDR     PIC X(01) VALUE 'Y'.   12770000
127800             88 FIRST-TIME-IN-PACK-HDR               VALUE 'Y'.   12780000
127900             88 NOT-FIRST-TIME-IN-PACK-HDR           VALUE 'N'.   12790000
128000                                                                  12800000
128100         10  WS-FIRST-TIME-015121          PIC X(01) VALUE 'Y'.   12810000
128200             88 FIRST-TIME-015121                    VALUE 'Y'.   12820000
128300             88 NOT-FIRST-TIME-015121                VALUE 'N'.   12830000
128400                                                                  12840000
128500         10  WS-FIRST-015121-IN-PACK       PIC X(01) VALUE 'Y'.   12850000
128600             88 FIRST-015121-IN-PACK                 VALUE 'Y'.   12860000
128700             88 NOT-FIRST-015121-IN-PACK             VALUE 'N'.   12870000
128800                                                                  12880000
128900         10  WS-PERFORM-SORT               PIC X(01) VALUE 'Y'.   12890000
129000             88 PERFORM-SORT                         VALUE 'Y'.   12900000
129100             88 DO-NOT-PERFORM-SORT                  VALUE 'N'.   12910000
129200                                                                  12920000
129300         10  WS-READ-FROM-SORT-AREA        PIC X(01) VALUE 'Y'.   12930000
129400             88 READ-FROM-SORT-AREA                  VALUE 'Y'.   12940000
129500             88 NOT-READ-FROM-SORT-AREA              VALUE 'N'.   12950000
129600                                                                  12960000
129700         10  WS-DISPLAY-STD-MSGS           PIC X(01) VALUE 'Y'.   12970000
129800             88 DISPLAY-STD-MSGS                     VALUE 'Y'.   12980000
129900             88 DO-NOT-DISPLAY-STD-MSGS              VALUE 'N'.   12990000
130000                                                                  13000000
130100         10  WS-DATA-DICT-CSR-FLG          PIC X(01) VALUE 'Y'.   13010000
130200             88 NOT-EOF-DATA-DICT-CSR                VALUE 'Y'.   13020000
130300             88 EOF-DATA-DICT-CSR                    VALUE 'N'.   13030000
130400                                                                  13040000
130500         10  WS-FIRST-RSTRT-PACK           PIC X(01) VALUE 'N'.   13050000
130600             88 FIRST-RSTRT-PACK                     VALUE 'Y'.   13060000
130700             88 NOT-FIRST-RSTRT-PACK                 VALUE 'N'.   13070000
130800                                                                  13080000
130900         10  WS-HDG-SAVE                   PIC X(01) VALUE '1'.   13090000
131000             88 WS-HDG-NO                            VALUE '1'.   13100000
131100             88 WS-HDG-3                             VALUE '3'.   13110000
131200             88 WS-HDG-4                             VALUE '4'.   13120000
131300             88 WS-HDG-5                             VALUE '5'.   13130000
131400             88 WS-TRL-3                             VALUE 'C'.   13140000
131500             88 WS-TRL-4                             VALUE 'D'.   13150000
131600             88 WS-TRL-5                             VALUE 'E'.   13160000
131700             88 WS-BLK-3                             VALUE 'F'.   13170000
131800             88 WS-BLK-4                             VALUE 'G'.   13180000
131900             88 WS-BLK-5                             VALUE 'H'.   13190000
132000                                                                  13200000
132100         10  WS-ADD-HEADING                PIC X(01) VALUE 'N'.   13210000
132200             88 ADD-HEADING                          VALUE 'Y'.   13220000
132300             88 NO-ADD-HEADING                       VALUE 'N'.   13230000
132400                                                                  13240000
132500         10  WS-ADD-TRAILING               PIC X(01) VALUE 'N'.   13250000
132600             88 ADD-TRAILING                         VALUE 'Y'.   13260000
132700             88 NO-ADD-TRAILING                      VALUE 'N'.   13270000
132800                                                                  13280000
132900         10  WS-UPDATE-HEADING             PIC X(01) VALUE 'N'.   13290000
133000             88 UPDATE-HEADING                       VALUE 'Y'.   13300000
133100             88 NO-UPDATE-HEADING                    VALUE 'N'.   13310000
133200                                                                  13320000
133300         10  WS-BEFORE-HEADING             PIC X(01) VALUE 'N'.   13330000
133400             88 BEFORE-HEADING                       VALUE 'Y'.   13340000
133500             88 NO-BEFORE-HEADING                    VALUE 'N'.   13350000
133600                                                                  13360000
133700* WIJAYA TEMP ADD                                                 13370000
133800         10  WS-ADD-BLANK-HEADING          PIC X(01) VALUE 'N'.   13380000
133900             88 ADD-BLANK-HEADING                    VALUE 'Y'.   13390000
134000             88 NO-ADD-BLANK-HEADING                 VALUE 'N'.   13400000
134100                                                                  13410000
134200         10  WS-PRINT-LINE                 PIC X(01) VALUE 'N'.   13420000
134300             88 YES-PRINT-LINE-SUP                   VALUE 'Y'.   13430000
134400             88 NO-PRINT-LINE-SUP                    VALUE 'N'.   13440000
134500                                                                  13450000
134600         10  WS-WIRELESS-STATION           PIC X(01) VALUE 'N'.   13460000
134700             88 YES-WIRELESS-STATION                 VALUE 'Y'.   13470000
134800             88 NO-WIRELESS-STATION                  VALUE 'N'.   13480000
134900                                                                  13490000
135000         10  WS-TELCO-ACCT-TYP-INDR        PIC X(01) VALUE 'N'.   13500000
135100             88 PRTNR-CUST-TYP                       VALUE 'C'.   13510000
135200             88 PRTNR-SBSCRBR-CON                    VALUE 'S'.   13520000
135300                                                                  13530000
135400         10  WS-INS-FST-TM-INV-INDR        PIC X(03) VALUE 'N'.   13540000
135500             88 INS-FST-TM-INV-INDR                  VALUE 'Y'.   13550000
135600             88 NO-INS-FST-TM-INV-INDR               VALUE 'N'.   13560000
135700             88 INS-VZW-FST-TM-INV                   VALUE 'VZW'. 13570000
135800             88 NO-INS-VZW-FST-TM-INV                VALUES 'N',  13580000
135900                                                            'Y'.  13590000
136000                                                                  13600000
136100         10  WS-SPLR-INTRNL-ACC-NO-TR PIC X(08) VALUE 'ONLYACCT'. 13610000
136200             88 SUBSCR-PRFX-AND-ACCT-NO         VALUE 'PRFXACCT'. 13620000
136300             88 ACCT-NO-AND-DIV-ID              VALUE 'ACCTDIVD'. 13630000
136400             88 ACCT-NO-AND-VZW-9-15            VALUE 'VZWACCT2'. 13640000
136500             88 ONLY-ACCT-NO                    VALUE 'ONLYACCT'. 13650000
136600                                                                  13660000
136700         10  WS-AFLT-TRNSCTN-IND           PIC X(01) VALUE 'N'.   13670000
136800             88 AFLT-TRNSCTN-IND-YES                 VALUE 'Y'.   13680000
136900             88 AFLT-TRNSCTN-IND-NO                  VALUE 'N'.   13690000
137000                                                                  13700000
137100***************************************************************** 13710000
137200*                   DATE AREAS                                  * 13720000
137300***************************************************************** 13730000
137400     05  XIRI1000-DATE-AREAS.                                     13740000
137500         10  WS-TIMESTAMP.                                        13750000
137600             15  WS-TIMESTAMP-DAT.                                13760000
137700                 20  WS-TMSTMP-YY          PIC X(04) VALUE SPACES.13770000
137800                 20  FILLER                PIC X(01) VALUE '-'.   13780000
137900                 20  WS-TMSTMP-MO          PIC X(02) VALUE SPACES.13790000
138000                 20  FILLER                PIC X(01) VALUE '-'.   13800000
138100                 20  WS-TMSTMP-DD          PIC X(02) VALUE SPACES.13810000
138200             15  FILLER                    PIC X(01) VALUE '-'.   13820000
138300             15  WS-TIMESTAMP-TIME.                               13830000
138400                 20  WS-TMSTMP-HH          PIC X(02) VALUE SPACES.13840000
138500                 20  FILLER                PIC X(01) VALUE '.'.   13850000
138600                 20  WS-TMSTMP-MM          PIC X(02) VALUE SPACES.13860000
138700                 20  FILLER                PIC X(01) VALUE '.'.   13870000
138800                 20  WS-TMSTMP-SS          PIC X(02) VALUE SPACES.13880000
138900             15  FILLER                    PIC X(01) VALUE '.'.   13890000
139000             15  WS-TMSTMP-NN              PIC X(06) VALUE SPACES.13900000
139100         10  WS-TIME-4.                                           13910000
139200             15  WS-TIME-4-HH              PIC X(02).             13920000
139300             15  WS-TIME-4-MM              PIC X(02).             13930000
139400         10  WS-TIME-FRMT.                                        13940000
139500             15  WS-TIME-HH                PIC X(02).             13950000
139600             15  FILLER                    PIC X(01) VALUE '.'.   13960000
139700             15  WS-TIME-MM                PIC X(02).             13970000
139800             15  FILLER                    PIC X(01) VALUE '.'.   13980000
139900             15  WS-TIME-SS                PIC X(02).             13990000
140000         10  WS-DB2-DATE.                                         14000000
140100             15  WS-DB2-CC                 PIC 9(02) VALUE ZEROES.14010000
140200             15  WS-DB2-YY                 PIC 9(02) VALUE ZEROES.14020000
140300             15  WS-DB2-SL1                PIC X(01) VALUE '/'.   14030000
140400             15  WS-DB2-MM                 PIC 9(02) VALUE ZEROES.14040000
140500             15  WS-DB2-SL1                PIC X(01) VALUE '/'.   14050000
140600             15  WS-DB2-DD                 PIC 9(02) VALUE ZEROES.14060000
140700     05  WS-HOLD-AREA.                                            14070000
140800         10  WS-SAVE-FIL-TYP-INDR          PIC X(01) VALUE SPACE. 14080000
140900         10  WS-SPLR-UNIQ-INV-DA           PIC X(66) VALUE SPACES.14090000
141000         10  WS-SPLR-UNIQ-INV-LEN          PIC 9(04) VALUE ZEROS. 14100000
141100         10  WS-POSITION                   PIC 9(02) VALUE ZEROS. 14110000
141200     05  WS-HOST-VARS.                                            14120000
141300         10  WS-DUPL-ERRR-COUNT            PIC S9(07) COMP.       14130000
141400     05  RS-SPLR-INFO-AR                   PIC X(286).            14140000
141500                                                                  14150000
141600     05  WS-VZW-FST-TM-INV                 PIC X(1).              14160000
141700                                                                  14170000
141800*** TR#159808  02/13/96  ALAN MASI  R960314                       14180000
141900*                                                                 14190000
142000* ADDED WS-USA1-TOT-REV TO HOLD THE TOT-REV-AMT STORED ON THE     14200000
142100* USA1 TABLE SO THAT IT CAN BE USED VALIDATE THE USA1 RECORD.     14210000
142200* IT WAS ADDED HERE SO THAT IT IS KEPT UPON RESTART.              14220000
142300*                                                                 14230000
142400     05  WS-USA1-TOT-REV        PIC S9(11)V99 COMP-3 VALUE ZEROES.14240000
142500     05  HLD-CNVTD-MA-BLG-NO.                                     14250000
142600         10  HLD-NPA                       PIC X(03).             14260000
142700         10  HLD-NXX                       PIC X(03).             14270000
142800         10  HLD-LINE                      PIC X(04).             14280000
142900     05  WS-XIRI004Y-RVN-SCE-TYP-CD        PIC X(01).             14290000
143000     EJECT                                                        14300000
143100                                                                  14310000
143200******************************************************************14320000
143300* USE THIS IN THE CALL STATEMENT FOR THE DATE ROUTINE.           *14330000
143400******************************************************************14340000
143500 01 DATETIME                         PIC X(08) VALUE 'DATETIME'.  14350000
143600                                                                  14360000
143700******************************************************************14370000
143800* USED FOR REFORMATTING DATE/TIMES.                              *14380000
143900******************************************************************14390000
144000 COPY DTFMT.                                                      14400000
144100 EJECT                                                            14410000
144200                                                                  14420000
144300***************************************************************** 14430001
144400*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 14440001
144500* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 14450001
144600***************************************************************** 14460001
144700 01  WS-SECOND-RESTART-500.                                       14470000
144800***************************************************************** 14480000
144900*    SAVE AREA                                                  * 14490000
145000***************************************************************** 14500000
145100     05  WS-SAVE-AREA.                                            14510000
145200         10  WS-CURR-USG-ID                PIC X(26) VALUE SPACES.14520000
145300         10  WS-PTN-ID                     PIC S9(04) COMP-3.     14530000
145400         10  WS-USA1CNT-CNT                PIC 9(07) VALUE 0.     14540000
145500         10  WS-USA7CNT-CNT                PIC 9(07) VALUE 0.     14550000
145600         10  WS-RCDS-RTRND                 PIC 9(07) VALUE 0.     14560000
145700         10  WS-OUTABAL-CNT                PIC 9(07) VALUE 0.     14570000
145800         10  WS-NOPR-ERRR-CNT              PIC 9(07) VALUE 0.     14580000
145900         10  WS-RESTART-IN-CNT             PIC 9(07) VALUE 0.     14590000
146000         10  WS-INVINCNT-CNT               PIC 9(07) VALUE 0.     14600000
146100         10  WS-TOT-IN-FILE-CNT            PIC 9(07) COMP.        14610000
146200         10  WS-BILL-SEQ-NO                PIC 9(08) VALUE 0.     14620000
146300         10  WS-FI-CNTLS-OUT-BAL           PIC 9(07) VALUE 0.     14630000
146400         10  WS-RESTART-RETRY              PIC S9(4) USAGE COMP.  14640000
146500         10  WS-APPLCN-RGN-ID              PIC X(08) VALUE SPACES.14650000
146600         10  WS-APPLCN-LOCN-ID             PIC X(20) VALUE SPACES.14660000
146700         10  WS-APPLCN-BLG-GR-ID           PIC X(12) VALUE SPACES.14670000
146800         10  WS-PREV-USG-ID                PIC X(26) VALUE SPACES.14680000
146900         10  WS-PREV-USG-ID-4-ZB           PIC X(26) VALUE SPACES.14690000
147000         10  WS-LAST-USG-SEQ-NO            PIC S9(09) COMP        14700000
147100                                                     VALUE ZEROES.14710000
147200         10  WS-PREV-USG-SEQ-NO            PIC S9(09) COMP        14720000
147300                                                     VALUE ZEROES.14730000
147400         10  WS-TMSTMP                     PIC X(26).             14740000
147500         10  HOLD-RCPT-DAT                 PIC X(10) VALUE SPACES.14750000
147600         10  WS-PROG-CMMT-FREQ             PIC S9(04) COMP        14760000
147700                                                     VALUE ZEROES.14770000
147800         10  WS-TH-ERRR-NO                 PIC S9(04) COMP        14780000
147900                                                     VALUE ZEROES.14790000
148000         10  WS-EXCH-MSG-BLG              PIC X(10)  VALUE SPACES.14800000
148100         10  WS-TRMSN-ID                  PIC X(26)               14810000
148200                                          VALUE SPACES.           14820000
148300         10  WS-TRMSN-SEQ-NO              PIC S9(4) COMP          14830000
148400                                          VALUE ZEROES.           14840000
148500         10  WS-PACK-ID                   PIC X(26)               14850000
148600                                          VALUE SPACES.           14860000
148700         10  WS-PACK-SEQ-NO               PIC S9(4) COMP          14870000
148800                                          VALUE ZEROES.           14880000
148900         10  WS-SUM-RCD-CRTE-NO PIC S9(07) COMP-3 VALUE ZEROES.   14890000
149000         10  WS-RCD-NOT-PRTD-NO PIC S9(07) COMP-3 VALUE ZEROES.   14900000
149100         10  WS-FED-TX-AMT      PIC S9(11)V99 COMP-3 VALUE ZEROES.14910000
149200         10  WS-LOC-ST-TX-AMT   PIC S9(11)V99 COMP-3 VALUE ZEROES.14920000
149300         10  WS-MSG-SURCHG-AMT  PIC S9(11)V99 COMP-3 VALUE ZEROES.14930000
149400         10  WS-TOT-TX          PIC S9(11)V99 COMP-3 VALUE ZEROES.14940000
149500         10  WS-TOT-REV         PIC S9(11)V99 COMP-3 VALUE ZEROES.14950000
149600         10  WS-TOTAL-REV       PIC S9(13)V99 COMP-3 VALUE ZEROES.14960000
149700         10  WS-PRIOR-USG-ID               PIC X(26).             14970000
149800         10  WS-SUM21-OBLIG-ID.                                   14980000
149900             15 WS-SUM21-OB-ID2            PIC X(2).              14990000
150000             15 WS-SUM21-OB-ID-PRT2        PIC X(2).              15000000
150100             15 WS-SUM21-OB-ID4            PIC X(4).              15010000
150200         10  WS-SUM21-MAJOR-MRKT           PIC X(3).              15020000
150300         10  WS-MAJOR-MRKT-OBID-NO.                               15030000
150400             15 WS-MAJOR-MRKT-OBID2        PIC X(2).              15040000
150500             15 WS-MAJOR-MRKT-OBID3        PIC X(3).              15050000
150600             15 WS-MAJOR-MRKT-OBID4        PIC X(4).              15060000
150700         10  WS-COUNT-XIRI005V             PIC S9(02) COMP-3      15070000
150800                                           VALUE ZEROES.          15080000
150900         10  WS-HOLD-TRAIT.                                       15090000
151000             15 WS-WRELS-ACTION      PIC X(3).                    15100000
151100             15 WS-WRELS-PNTR        PIC X(3).                    15110000
151200             15 FILLER               PIC X(2).                    15120000
151300***************************************************************** 15130000
151400*                   ACCUMULATORS                                * 15140000
151500***************************************************************** 15150000
151600     05  WS-ACCUMULATORS.                                         15160000
151700         10  WS-RESTART-RCD-CNT            PIC 9(07)  COMP.       15170000
151800         10  WS-INV-IN-RCD-CNT             PIC  9(07) COMP.       15180000
151900         10  WS-INV-IN-SPLR-CNT            PIC S9(07) COMP.       15190000
152000         10  WS-PACK-IN-RCD-CNT            PIC  9(07).            15200000
152100         10  WS-PACK-CNT                   PIC S9(07) COMP-3.     15210000
152200         10  WS-HDR-TRL-CNT                PIC S9(07) COMP.       15220000
152300         10  WS-SUM21-CNT                  PIC S9(07) COMP.       15230000
152400         10  WS-PREV-SEQ-PLUS-1            PIC S9(04).            15240000
152500         10  WS-XIRI001Y-RCD-FET           PIC S9(07) COMP-3.     15250000
152600         10  WS-XIRI002Y-RCD-SEL           PIC S9(07) COMP-3.     15260000
152700         10  WS-XIRI003Y-RCD-INS           PIC S9(07) COMP-3.     15270000
152800         10  WS-XIRI004Y-RCD-INS           PIC S9(07) COMP-3.     15280000
152900         10  WS-XIRI044Y-RCD-INS           PIC S9(07) COMP-3.     15290000
153000         10  WS-XIRI006Y-RCD-SEL           PIC S9(07) COMP-3.     15300000
153100         10  WS-XIRI008Y-RCD-SEL           PIC S9(07) COMP-3.     15310000
153200         10  WS-XIRI013Y-RCD-INS           PIC S9(07) COMP-3.     15320000
153300         10  WS-XIRI022Y-RCD-FET           PIC S9(07) COMP-3.     15330000
153400         10  WS-XIRI031Y-RCD-FET           PIC S9(07) COMP-3.     15340000
153500**BGN TR #154223  KGE 10/30/95                                    15350000
153600*D       10  WS-DUPL-ERROR-CNT             PIC S9(07) COMP-3.     15360000
153700**END TR #154223  KGE 10/30/95                                    15370000
153800         10  WS-NUM-OF-REC-INSRTD          PIC S9(07) COMP-3.     15380000
153900         10  WS-NUM-OF-REC-ADDED           PIC S9(07) COMP-3.     15390000
154000         10  WS-NUM-OF-SPLR-INV-RECS       PIC S9(07) COMP-3.     15400000
154100     05  FILLER                            PIC X(01) VALUE SPACE. 15410000
154200     EJECT                                                        15420000
154300                                                                  15430000
154400***************************************************************** 15440001
154500*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 15450001
154600* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 15460001
154700***************************************************************** 15470001
154800 01  WS-THIRD-RESTART-500.                                        15480000
154900     05  WS-SAVE-AREA-2.                                          15490000
155000         10  WS-HOLD-E015121              PIC X(220) VALUE SPACES.15500000
155100         10  WS-SAVE-E015121              PIC X(220) VALUE SPACES.15510000
155200     05  RS-XIRI002Y                      PIC X(12).              15520000
155300     05  WS-CURR-INFO.                                            15530000
155400         10  WS-CURR-PRCSS-CY-NO          PIC X(06) VALUE SPACES. 15540000
155500         10  WS-CURR-PRCSS-CY-DAT         PIC X(10) VALUE SPACES. 15550000
155600         10  WS-CURR-SYS-DAT              PIC X(10) VALUE SPACES. 15560000
155700         10  WS-CURR-SYS-TM               PIC X(08) VALUE SPACES. 15570000
155800     05  WS-ACCUMULATORS-3RD.                                     15580002
155900         10  WS-RETRY-CNT                 PIC S9(4) VALUE ZEROES. 15590000
156000     05  WS-SAVE-FIELDS-3RD.                                      15600002
156100         10  WS-PACK-TYPE                 PIC 9(1).               15610000
156200     05  FILLER                           PIC X(09) VALUE SPACES. 15620000
156300     EJECT                                                        15630000
156400                                                                  15640000
156500***************************************************************** 15650001
156600*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 15660001
156700* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 15670001
156800***************************************************************** 15680001
156900 01  WS-FOURTH-RESTART-500.                                       15690000
157000***************************************************************** 15700000
157100*    SUPPLIER ID INTERNAL TABLE                                 * 15710000
157200***************************************************************** 15720000
157300*** 961219-62   ALAN MASI   01/21/97                              15730000
157400*                                                                 15740000
157500* REMOVED TABLE OCCURRANCES SINCE THIS PROGRAM ONLY RUNS FOR      15750000
157600* ONE SPLR AT A TIME.                                             15760000
157700*                                                                 15770000
157800     05  TB-SPLR-TBL.                                             15780000
157900         10 TB-SPLR                    PIC  X(06).                15790000
158000         10 TB-SPLR-CUS-INDR           PIC  X(01).                15800000
158100         10 TB-SRT-ORD-INDR            PIC  X(01).                15810000
158200            88 TB-SORT-INPUT                     VALUE 'Y'.       15820000
158300            88 TB-NOT-SORT-INPUT                 VALUE 'N'.       15830000
158400         10 TB-SPLR-PROCESSED-SW       PIC  X(01).                15840000
158500            88 TB-SPLR-PROCESSED                 VALUE 'Y'.       15850000
158600         10 TB-INV-IN-SPLR-CNT         PIC S9(07) COMP-3.         15860000
158700         10 TB-XIRI001Y-RCD-FET        PIC S9(07) COMP-3.         15870000
158800         10 TB-XIRI002Y-RCD-SEL        PIC S9(07) COMP-3.         15880000
158900         10 TB-XIRI003Y-RCD-INS        PIC S9(07) COMP-3.         15890000
159000         10 TB-XIRI004Y-RCD-INS        PIC S9(07) COMP-3.         15900000
159100         10 TB-XIRI006Y-RCD-SEL        PIC S9(07) COMP-3.         15910000
159200         10 TB-XIRI008Y-RCD-SEL        PIC S9(07) COMP-3.         15920000
159300         10 TB-XIRI013Y-RCD-INS        PIC S9(07) COMP-3.         15930000
159400         10 TB-XIRI022Y-RCD-FET        PIC S9(07) COMP-3.         15940000
159500         10 TB-XIRI031Y-RCD-FET        PIC S9(07) COMP-3.         15950000
159600         10 TB-XIRI040Y-RCD-SEL        PIC S9(07) COMP-3.         15960000
159700         10 TB-XIRI041Y-RCD-SEL        PIC S9(07) COMP-3.         15970000
159800         10 TB-XIRI041Y-RCD-INS        PIC S9(07) COMP-3.         15980000
159900         10 TB-XIRI041Y-RCD-UPD        PIC S9(07) COMP-3.         15990000
160000         10 TB-XIRI042Y-RCD-SEL        PIC S9(07) COMP-3.         16000000
160100         10 TB-XIRI042Y-RCD-UPD        PIC S9(07) COMP-3.         16010000
160200         10 TB-XIRI044Y-RCD-SEL        PIC S9(07) COMP-3.         16020000
160300         10 TB-XIRI044Y-RCD-INS        PIC S9(07) COMP-3.         16030000
160400         10 TB-XIRI043Y-RCD-UPD        PIC S9(07) COMP-3.         16040000
160500         10 TB-HDR-TRL-CNT             PIC S9(07) COMP-3.         16050000
160600         10 TB-SUM21-CNT               PIC S9(07) COMP-3.         16060000
160700         10 TB-FIL-HDR-DAT             PIC  X(10).                16070000
160800         10 TB-FIL-HDR-TM              PIC  X(08).                16080000
160900         10 TB-FIL-HDR-SEQ-NO          PIC S9(03) COMP-3.         16090000
161000         10 TB-FIL-HDR-SWITCH          PIC  X(01).                16100000
161100         10 TB-RUN-CONTROL    OCCURS 8 TIMES                      16110000
161200                              INDEXED BY WS-CNTL-IDX.             16120000
161300            15 TB-INPT-OP-DA-NM        PIC  X(08).                16130000
161400            15 TB-RCDS-INSRTD-NO       PIC S9(13) COMP-3.         16140000
161500            15 TB-RCDS-UPDTD-NO        PIC S9(13) COMP-3.         16150000
161600            15 TB-RCDS-SELD-NO         PIC S9(13) COMP-3.         16160000
161700     05  WS-INV-REC-COUNTERS.                                     16170000
161800         10  WS-USA2-PRNTBLE-RECS          PIC 9(06) VALUE ZEROES.16180000
161900         10  WS-TOT-SUM-RECS               PIC 9(06) VALUE ZEROES.16190000
162000         10  WS-RECS-CRTD                  PIC 9(06) VALUE ZEROES.16200000
162100         10  WS-RECS-NOT-PRTD              PIC 9(06) VALUE ZEROES.16210000
162200         10  WS-TOT-MSG-NO                 PIC 9(06) VALUE ZEROES.16220000
162300     05  WS-SUM27-TAX-INDR.                                       16230000
162400         10  WS-SUM27-TAX-ADD              PIC X(01) VALUE 'N'.   16240000
162500             88  SUM27-TAX-ADDED                     VALUE 'Y'.   16250000
162600             88  SUM27-TAX-NOT-ADDED                 VALUE 'N'.   16260000
162700                                                                  16270000
162800     05  FILLER                        PIC X(123).                16280000
162900                                                                  16290001
163000***************************************************************** 16300001
163100*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 16310001
163200* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 16320001
163300***************************************************************** 16330001
163400 01  WS-5TH-RESTART-500.                                          16340000
163500     05  RS-XRQNDMH                    PIC X(220) VALUE SPACES.   16350000
163600     05  RS-E202298M                   PIC X(220) VALUE SPACES.   16360000
163700     05  FILLER                        PIC X(60) VALUE SPACES.    16370000
163800                                                                  16380001
163900***************************************************************** 16390001
164000*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 16400001
164100* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 16410001
164200***************************************************************** 16420001
164300 01  WS-6TH-RESTART-500.                                          16430000
164400     05  RS-RESTART-HOLD-EMI-RCD       PIC X(220) VALUE SPACES.   16440000
164500     05  RS-E202205M                   PIC X(220) VALUE SPACES.   16450000
164600     05  FILLER                        PIC X(60) VALUE SPACES.    16460000
164700                                                                  16470001
164800***************************************************************** 16480001
164900*    THIS IS FOR RESTART, TO MOVE WS IN 500 INCREMENTS.         * 16490001
165000* EACH RESTART AREA SHOULD BE NO MORE THAN 500 BYTES IN LENGTH  * 16500001
165100***************************************************************** 16510001
165200 01  WS-7TH-RESTART-500.                                          16520000
165300     05  SAVE-EMI-RECORD-AR.                                      16530000
165400         10  EMI-RCD-ID                PIC X(06).                 16540000
165500         10  FILLER                    PIC X(214).                16550000
165600     05  SAVE-SPLR-PROV-INDR           PIC X(01).                 16560000
165700     05  SAVE-SPLR-TEXT-PROV-INDR      PIC X(01).                 16570000
165800     05  WS-ADDTNL-ACCUMULATORS.                                  16580000
165900         10  WS-XIRI040Y-RCD-SEL       PIC S9(07) COMP-3          16590000
166000                                                  VALUE ZEROES.   16600000
166100         10  WS-XIRI041Y-RCD-SEL       PIC S9(07) COMP-3          16610000
166200                                                  VALUE ZEROES.   16620000
166300         10  WS-XIRI041Y-RCD-INS       PIC S9(07) COMP-3          16630000
166400                                                  VALUE ZEROES.   16640000
166500         10  WS-XIRI041Y-RCD-UPD       PIC S9(07) COMP-3          16650000
166600                                                  VALUE ZEROES.   16660000
166700         10  WS-XIRI042Y-RCD-SEL       PIC S9(07) COMP-3          16670000
166800                                                  VALUE ZEROES.   16680000
166900         10  WS-XIRI042Y-RCD-UPD       PIC S9(07) COMP-3          16690000
167000                                                  VALUE ZEROES.   16700000
167100         10  WS-XIRI043Y-RCD-UPD       PIC S9(07) COMP-3          16710000
167200                                                  VALUE ZEROES.   16720000
167300     05  FILLER                        PIC X(250) VALUE SPACES.   16730000
167400     EJECT                                                        16740000
167500                                                                  16750000
167600***************************************************************** 16760000
167700*    WORKING STORAGE NOT NEEDED FOR RESTART                     * 16770000
167800***************************************************************** 16780000
167900 01  WS-NOT-FOR-RESTART.                                          16790000
168000**** TR# XXXXXX   BEN GOMEZ 09/20/98                              16800000
168100* DUPLICATE INVOICE PROBLEM                                       16810000
168200     05  WS-DUPLICATE-CNT               PIC 9(6).                 16820000
168300     05  WS-DUPLICATE-USG-ID            PIC X(26).                16830000
168400**** TR# 139012   ALAN MASI   04/20/95                            16840000
168500*                                                                 16850000
168600* ADDED TO ALLOW THE SORTING OF USAGE IDS WHEN THE FIRST          16860000
168700* TWO DIGITS CHANGE FOR EVERY INVOICE                             16870000
168800*                                                                 16880000
168900     05  WS-CONVERT-USG-ID              PIC X(26).                16890000
169000     05  WS-CONVERT-1 REDEFINES WS-CONVERT-USG-ID.                16900000
169100         10 WS-CONV-1                   PIC X(02).                16910000
169200         10 WS-CONV-2                   PIC X(24).                16920000
169300     05  WS-CONVERT-2 REDEFINES WS-CONVERT-USG-ID.                16930000
169400         10 WS-CONV-3                   PIC X(24).                16940000
169500         10 WS-CONV-4                   PIC X(02).                16950000
169600     05  WS-CONVRTD-USG-ID              PIC X(26).                16960000
169700     05  WS-CONVRTD-1 REDEFINES WS-CONVRTD-USG-ID.                16970000
169800         10 WS-CNVTD-1                  PIC X(02).                16980000
169900         10 WS-CNVTD-2                  PIC X(24).                16990000
170000     05  WS-CONVRTD-2 REDEFINES WS-CONVRTD-USG-ID.                17000000
170100         10 WS-CNVTD-3                  PIC X(24).                17010000
170200         10 WS-CNVTD-4                  PIC X(02).                17020000
170300                                                                  17030000
170400     05  WS-SQLCODE.                                              17040000
170500 COPY SQLCODES.                                                   17050000
170600                                                                  17060000
170700     05  WS-TOTAL-WRELS-MSG-AMT    PIC S9(11)V99 USAGE COMP-3.    17070000
170800     05  WS-TOTAL-WRELS-MSG-NO     PIC S9(4) USAGE COMP.          17080000
170900     05  WS-MKT-MSG-SEQ-NO           PIC 9.                       17090000
171000     05  WS-DISPLAY-BILL-AMT         PIC ZZZ,ZZZ,ZZZ.99-.         17100000
171100     05  WS-DISPLAY-SQLCODE          PIC -9999.                   17110000
171200     05  WS-SPLR-INTRNL-ACC-NO-VAL   PIC X(16).                   17120000
171300     05  WS-SPLR-ID                  PIC X(04).                   17130000
171400     05  WS-DFLT-PAYMENT-REF-ID      PIC X(15)                    17140000
171500                                     VALUE '000000000000000'.     17150000
171600     05  WS-ASGND-BTN-CUST-CD.                                    17160000
171700         10  WS-ASGND-BTN-NO         PIC X(10) VALUE SPACES.      17170000
171800         10  WS-ASGND-CUST-CD        PIC X(03) VALUE SPACES.      17180000
171900                                                                  17190000
172000     05  WS-SRT-WRAPUP-RCD.                                       17200000
172100         10  WS-SRT-KEY.                                          17210000
172200             15  WS-SRT-USG-ID       PIC X(26).                   17220000
172300             15  FILLER              PIC X(124).                  17230000
172400         10  FILLER                  PIC X(4).                    17240000
172500         10  WS-SRT-RCD-ID           PIC X(6).                    17250000
172600         10  WS-SRT-TOT-REV-AMT      PIC S9(11)V99 COMP-3 VALUE 0.17260000
172700         10  WS-SRT-TOT-TX           PIC S9(11)V99 COMP-3 VALUE 0.17270000
172800         10  WS-SRT-LOC-ST-TX-AMT    PIC S9(11)V99 COMP-3 VALUE 0.17280000
172900         10  WS-SRT-MSG-SURCHG-AMT   PIC S9(11)V99 COMP-3 VALUE 0.17290000
173000         10  WS-SRT-FED-TX-AMT       PIC S9(11)V99 COMP-3 VALUE 0.17300000
173100         10  WS-SRT-SUM-RCD-CRTE-NO  PIC S9(7)     COMP-3 VALUE 0.17310000
173200         10  WS-SRT-RCD-NOT-PRTD-NO  PIC S9(7)     COMP-3 VALUE 0.17320000
173300         10  WS-SRT-RVN-SCE-TYP-CD   PIC X.                       17330000
173400         10  FILLER                  PIC X.                       17340000
173500         10  WS-SRT-NXT-BILL-DAT     PIC X(10).                   17350000
173600         10  WS-SRT-INIT-ASSN-TMSTMP PIC X(26).                   17360000
173700         10  WS-SRT-SPLR-AREA        PIC X(10).                   17370000
173800         10  WS-SRT-CNVTD-MA-BLG-NO  PIC X(10).                   17380000
173900         10  WS-SRT-INTERLTA-INDR    PIC X.                       17390000
174000         10  WS-SRT-INTRALTA-INDR    PIC X.                       17400000
174100         10  WS-TOT-WRELS-MSG-AMT    PIC S9(11)V99 USAGE COMP-3.  17410000
174200         10  WS-TOT-WRELS-MSG-NO     PIC S9(4) USAGE COMP.        17420000
174300         10  FILLER                  PIC X(137).                  17430000
174400     EJECT                                                        17440000
174500***************************************************************** 17450000
174600*    BORDER POINT INTERNAL TABLE                                * 17460000
174700***************************************************************** 17470000
174800 01  WS-RAO-TBL.                                                  17480000
174900     05  WS-RAO-REC            OCCURS 100 TIMES                   17490000
175000                               INDEXED BY WS-RAO-IDX.             17500000
175100         10  WS-NO-PL-AR-ID            PIC X(03).                 17510000
175200         10  WS-RVN-ACCTG-OFC-CD       PIC X(03).                 17520000
175300                                                                  17530000
175400     EJECT                                                        17540000
175500***************************************************************** 17550000
175600*    INTERNAL/EXTERNAL ERROR TABLE                              * 17560000
175700***************************************************************** 17570000
175800 01  WS-ERRR-TBL.                                                 17580000
175900     05  WS-ERRR-REC           OCCURS 50 TIMES                    17590000
176000                               INDEXED BY WS-ERRR-IDX.            17600000
176100         10  WS-INTRNL-ERRR-CD         PIC X(04).                 17610000
176200         10  WS-ERRR-CD                PIC X(04).                 17620000
176300         10  FILLER                    PIC X(02).                 17630000
176400                                                                  17640000
176500     EJECT                                                        17650000
176600***************************************************************** 17660000
176700*    DATA DICTIONARY TABLE (POPULATED FROM XIRI031Y VIEW)       * 17670000
176800***************************************************************** 17680000
176900 01  WS-DATA-DICT-TBL.                                            17690000
177000     05  WS-DATA-DICT-REC      OCCURS 50 TIMES                    17700000
177100                               INDEXED BY WS-DD-IDX.              17710000
177200         10  WS-REF-ELEM-NM            PIC X(06).                 17720000
177300         10  WS-POS-NO                 PIC S9(04) COMP.           17730000
177400         10  WS-LNGTH-NO               PIC S9(04) COMP.           17740000
177500                                                                  17750000
177600     EJECT                                                        17760000
177700***************************************************************** 17770000
177800*        F I L E  I N P U T  L A Y O U T S                      * 17780000
177900***************************************************************** 17790000
178000*                                                                 17800000
178100***************************************************************** 17810000
178200*    NDM TRANSMISSION HEADER                                    * 17820000
178300***************************************************************** 17830000
178400*                                                                 17840000
178500 01  XRQNDMH.                                                     17850000
178600 COPY XRQNDMH.                                                    17860000
178700                                                                  17870000
178800     EJECT                                                        17880000
178900***************************************************************** 17890000
179000*    NDM TRANSMISSION TRAILER                                   * 17900000
179100***************************************************************** 17910000
179200*                                                                 17920000
179300 01  XRQNDMT.                                                     17930000
179400 COPY XRQNDMT.                                                    17940000
179500                                                                  17950000
179600     EJECT                                                        17960000
179700***************************************************************** 17970000
179800*    FILE HEADER                                                * 17980000
179900***************************************************************** 17990000
180000*                                                                 18000000
180100 01  E202298M.                                                    18010000
180200 COPY E202298M.                                                   18020000
180300                                                                  18030000
180400     EJECT                                                        18040000
180500***************************************************************** 18050000
180600*    FILE TRAILER                                               * 18060000
180700***************************************************************** 18070000
180800*                                                                 18080000
180900 01  E202299M.                                                    18090000
181000 COPY E202299M.                                                   18100000
181100                                                                  18110000
181200     EJECT                                                        18120000
181300***************************************************************** 18130000
181400*    PACK HEADER                                                * 18140000
181500***************************************************************** 18150000
181600*                                                                 18160000
181700 01  E202205M.                                                    18170000
181800 COPY E202205M.                                                   18180000
181900                                                                  18190000
182000     EJECT                                                        18200000
182100***************************************************************** 18210000
182200*    PACK TRAILER                                               * 18220000
182300***************************************************************** 18230000
182400*                                                                 18240000
182500 01  E202206M.                                                    18250000
182600 COPY E202206M.                                                   18260000
182700                                                                  18270000
182800     EJECT                                                        18280000
182900***************************************************************** 18290000
183000*     TENTH OF MINUTES TIME CONVERSION                          * 18300000
183100***************************************************************** 18310000
183200*                                                                 18320000
183300 COPY CNVTWKST.                                                   18330000
183400                                                                  18340000
183500     EJECT                                                        18350000
183600***************************************************************** 18360000
183700*     TEMP SORT RECORD                                          * 18370000
183800***************************************************************** 18380000
183900*                                                                 18390000
184000 01  WS-TEMP-SORT-RECORD.                                         18400000
184100     05  WS-SORT-RECORD                     PIC X(409).           18410000
184200     05  WS-SORT-RCD-IN-CNT                 PIC 9(7).             18420000
184300     EJECT                                                        18430000
184400***************************************************************** 18440000
184500*     EMI RECORD                                                * 18450000
184600***************************************************************** 18460000
184700*                                                                 18470000
184800 COPY EMIREC.                                                     18480000
184900                                                                  18490000
185000***************************************************************** 18500000
185100*    I/O RECORD HOLD                                            * 18510000
185200***************************************************************** 18520000
185300 01  THIS REDEFINES TRMSN-ACPTNC-RCD.                             18530000
185400     05  WS-REC-AREA.                                             18540000
185500         10  WS-REC-ID                     PIC X(06).             18550000
185600         10  WS-REC-1 REDEFINES WS-REC-ID.                        18560000
185700             15  EMI-RECS-DEF              PIC X(06).             18570000
185800                 88  PACK-HDR              VALUE '202205'.        18580000
185900                 88  PACK-TRLR             VALUE '202206'.        18590000
186000                 88  SPLR-HDR              VALUE '202298'.        18600000
186100                 88  SPLR-TRLR             VALUE '202299'.        18610000
186200                 88  SUM21-RCD             VALUE '015121'.        18620000
186300                 88  SUM22-RCD             VALUE '015122'.        18630000
186400                 88  SUM23-RCD             VALUE '015123'.        18640000
186500                 88  PHR27-RCD             VALUE '015127'.        18650000
186600         10  WS-REC-2 REDEFINES WS-REC-ID.                        18660000
186700             15  NDM-RECS-DEF              PIC X(03).             18670000
186800                 88  NDM-HDR               VALUE LOW-VALUES.      18680000
186900                 88  NDM-TRLR              VALUE HIGH-VALUES.     18690000
187000             15  FILLER                    PIC X(03).             18700000
187100         10  WS-REC-3 REDEFINES WS-REC-ID.                        18710000
187200             15  81-RECS-DEF               PIC X(02).             18720000
187300                 88  MSG81-RCD             VALUE '81'.            18730000
187400             15  FILLER                    PIC X(04).             18740000
187500         10  WS-REC-4 REDEFINES WS-REC-ID.                        18750000
187600             15  82-RECS-DEF               PIC X(02).             18760000
187700                 88  MSG82-RCD             VALUE '82'.            18770000
187800             15  FILLER                    PIC X(04).             18780000
187900         10  WS-CURR-REC REDEFINES WS-REC-ID.                     18790000
188000             15  WS-CURR-REC-ID            PIC X(06).             18800000
188100         10  FILLER                        PIC X(257).            18810000
188200     EJECT                                                        18820000
188300***************************************************************** 18830000
188400*    PHRASE SUMMARY                                             * 18840000
188500***************************************************************** 18850000
188600*                                                                 18860000
188700 01  E015127 REDEFINES TRMSN-ACPTNC-RCD.                          18870000
188800*** 950321-70  ALAN MASI 10/11/95  R960215                        18880000
188900*                                                                 18890000
189000*     CHANGED TO USE E015127M                                     18900000
189100*                                                                 18910000
189200 COPY E015127M.                                                   18920000
189300     EJECT                                                        18930000
189400***************************************************************** 18940000
189500*    PHRASE SUMMARY                                             * 18950000
189600***************************************************************** 18960000
189700*                                                                 18970000
189800 01  WS-E015127-HOLD.                                             18980000
189900*** 950321-70  ALAN MASI 10/11/95  R960215                        18990000
190000*                                                                 19000000
190100*     CHANGED TO USE E015127M                                     19010000
190200*                                                                 19020000
190300 COPY E015127M.                                                   19030000
190400     EJECT                                                        19040000
190500***************************************************************** 19050000
190600*    WS-E015127-REPLACEMENT RECORD                              * 19060000
190700***************************************************************** 19070000
190800*                                                                 19080000
190900 01  WS-015127-REPLACEMENT-REC.                                   19090000
191000***            SJWETEK   08/20/96  R961114                        19100000
191100*                                                                 19110000
191200 COPY E015127M.                                                   19120000
191300     EJECT                                                        19130000
191400***************************************************************** 19140000
191500*    BILLABLE MESSAGES DETAIL                                   * 19150000
191600***************************************************************** 19160000
191700*                                                                 19170000
191800 01  E81XXXX.                                                     19180000
191900*** 950321-70  ALAN MASI 10/11/95  R960215                        19190000
192000*                                                                 19200000
192100*     CHANGED TO USE E81XXXXM                                     19210000
192200*                                                                 19220000
192300 COPY E81XXXXM.                                                   19230000
192400     EJECT                                                        19240000
192500***************************************************************** 19250000
192600*    BLANK HEADING                                              * 19260000
192700***************************************************************** 19270000
192800*                                                                 19280000
192900 01  WS-015127-BLANK.                                             19290000
193000 COPY E015127M.                                                   19300000
193100     EJECT                                                        19310000
193200***************************************************************** 19320000
193300*    BILL SUPPRESSION  DETAIL                                   * 19330000
193400***************************************************************** 19340000
193500*                                                                 19350000
193600 01  WS-015127-TEMP.                                              19360000
193700 COPY E015127M.                                                   19370000
193800     EJECT                                                        19380000
193900 01  E82XXXX.                                                     19390000
194000 COPY E82XXXXM.                                                   19400000
194100     EJECT                                                        19410000
194200***************************************************************** 19420000
194300*                 R E S T A R T    A C C E S S                  * 19430000
194400*                                                               * 19440000
194500* WORKING STORAGE AREA TO ACCESS CO90.                          * 19450000
194600*                                                               * 19460000
194700***************************************************************** 19470000
194800*                                                                 19480000
194900 01  CO90KY0C.                                                    19490000
195000     COPY CO90KY0C.                                               19500000
195100     EJECT                                                        19510000
195200***************************************************************** 19520000
195300*   C O N T R O L S   I N T E R F A C E   R E C  L A Y O U T    * 19530000
195400*                  SELECT SUPPLIER                              * 19540000
195500***************************************************************** 19550000
195600*                                                                 19560000
195700 01  C1000LK1.                                                    19570000
195800 COPY C1000LK1.                                                   19580000
195900     EJECT                                                        19590000
196000***************************************************************** 19600000
196100*   C O N T R O L S   I N T E R F A C E   R E C  L A Y O U T    * 19610000
196200*                  DUPLICATE FILE VALIDATION                    * 19620000
196300***************************************************************** 19630000
196400*                                                                 19640000
196500 01  C3000LK1.                                                    19650000
196600 COPY C3000LK1.                                                   19660000
196700     EJECT                                                        19670000
196800***************************************************************** 19680000
196900*   C O N T R O L S   I N T E R F A C E   R E C  L A Y O U T    * 19690000
197000*                  END SUPPLIER PROCESS                         * 19700000
197100***************************************************************** 19710000
197200*                                                                 19720000
197300 01  C4000LK1.                                                    19730000
197400 COPY C4000LK1.                                                   19740000
197500**** REMOVE NOT NEEDED RESTART SAVE AREAS **** MCR# 941222-70     19750000
197600*01  REDEF-C4000LK1 REDEFINES C4000LK1.                           19760000
197700*    05  REDEF-C4000LK1-500-1               PIC X(500).           19770000
197800*    05  REDEF-C4000LK1-500-2               PIC X(500).           19780000
197900*    05  REDEF-C4000LK1-500-3               PIC X(500).           19790000
198000*    05  REDEF-C4000LK1-500-4               PIC X(500).           19800000
198100*    05  REDEF-C4000LK1-500-5               PIC X(500).           19810000
198200*    05  REDEF-C4000LK1-500-6               PIC X(500).           19820000
198300*    05  REDEF-C4000LK1-500-7               PIC X(500).           19830000
198400*    05  REDEF-C4000LK1-500-8               PIC X(330).           19840000
198500     EJECT                                                        19850000
198600***************************************************************** 19860000
198700*   C O N T R O L S   I N T E R F A C E   R E C  L A Y O U T    * 19870000
198800*                  END OF JOB                                   * 19880000
198900***************************************************************** 19890000
199000*                                                                 19900000
199100 01  C5000LK1.                                                    19910000
199200 COPY C5000LK1.                                                   19920000
199300     EJECT                                                        19930000
199400***************************************************************** 19940000
199500*   LINKAGE WITH XIRDAI10 - DATA ACCESS LAYER                   * 19950000
199600***************************************************************** 19960000
199700 01   DAI10LK1.                                                   19970000
199800 COPY DAI10LK1.                                                   19980000
199900     EJECT                                                        19990000
200000***************************************************************** 20000000
200100*   E R R O R   I N T E R F A C E   R E C  L A Y O U T          * 20010000
200200***************************************************************** 20020000
200300*                                                                 20030000
200400 01  E1000LK1.                                                    20040000
200500 COPY E1000LK1.                                                   20050000
200600     EJECT                                                        20060000
200700***************************************************************** 20070000
200800*   X I R I 1 0 0 5  L I N K A G E  R E C  L A Y O U T          * 20080000
200900***************************************************************** 20090000
201000*                                                                 20100000
201100 01  I1005LK1.                                                    20110000
201200 COPY I1005LK1.                                                   20120000
201300     EJECT                                                        20130000
201400***************************************************************** 20140000
201500*   S U B T O T A L T A B L E                                   * 20150000
201600***************************************************************** 20160000
201700*                                                                 20170000
201800 01  I1005LK2.                                                    20180000
201900 COPY I1005LK2.                                                   20190000
202000     EJECT                                                        20200000
202100***************************************************************** 20210000
202200*   AREA RETURNED FROM XIRI1005 TO BE RLSE TO SORT              * 20220000
202300***************************************************************** 20230000
202400*                                                                 20240000
202500 01  I1005LK3.                                                    20250000
202600 COPY I1005LK3.                                                   20260000
202700     EJECT                                                        20270000
202800***************************************************************** 20280000
202900*   X I R I 1 0 1 0  L I N K A G E  R E C  L A Y O U T          * 20290000
203000***************************************************************** 20300000
203100*                                                                 20310000
203200 01  I1010LK1.                                                    20320000
203300 COPY I1010LK1.                                                   20330000
203400     EJECT                                                        20340000
203500***************************************************************** 20350000
203600*   X I R I 1 0 5 0  L I N K A G E  R E C  L A Y O U T          * 20360000
203700***************************************************************** 20370000
203800*                                                                 20380000
203900 01  I1050LK1.                                                    20390000
204000 COPY I1050LK1.                                                   20400000
204100     EJECT                                                        20410000
204200***************************************************************** 20420000
204300*   X I R I 1 0 6 0  L I N K A G E  R E C  L A Y O U T          * 20430000
204400*   ONLY THE FIRST 015121 RECORD SHOULD BE PASSED TO XIRI1060   * 20440000
204500***************************************************************** 20450000
204600*                                                                 20460000
204700 01  I1060LK1.                                                    20470000
204800 COPY I1060LK1.                                                   20480000
204900     EJECT                                                        20490000
205000***************************************************************** 20500000
205100*   X I R I 1 0 8 0  L I N K A G E  R E C  L A Y O U T          * 20510000
205200*    SPECIAL CHARS PROCESSING                                   * 20520000
205300***************************************************************** 20530000
205400*                                                                 20540000
205500 01  I1080LK1.                                                    20550000
205600 COPY I1080LK1.                                                   20560000
205700     EJECT                                                        20570000
205800***************************************************************** 20580000
205900*   X I R I 1 0 9 0  L I N K A G E  R E C  L A Y O U T          * 20590000
206000*    ICE ENA PROCESSING                                         * 20600000
206100***************************************************************** 20610000
206200*                                                                 20620000
206300 01  I1090LK1.                                                    20630000
206400 COPY I1090LK1.                                                   20640000
206500     EJECT                                                        20650000
206600***************************************************************** 20660000
206700*   X I R Z 7 0 0 0  L I N K A G E  R E C  L A Y O U T          * 20670000
206800*        COMMON TRAIT RECORD                                    * 20680000
206900***************************************************************** 20690000
207000*                                                                 20700000
207100 01  Z7000LK1.                                                    20710000
207200 COPY Z7000LK1.                                                   20720000
207300     EJECT                                                        20730000
207400***************************************************************** 20740000
207500*   X I R Z 7 2 0 0  L I N K A G E  R E C  L A Y O U T          * 20750000
207600*        REMOTE CONNECT MODULE                                  * 20760000
207700***************************************************************** 20770000
207800 01  Z7200LK1.                                                    20780000
207900 COPY Z7200LK1.                                                   20790000
208000 EJECT                                                            20800000
208100***************************************************************** 20810000
208200*   X I R Z A 0 0 0  L I N K A G E  R E C  L A Y O U T          * 20820000
208300*        COMMON RIB JOURNAL MODULE                              * 20830000
208400***************************************************************** 20840000
208500*                                                                 20850000
208600 01  ZA000LK1.                                                    20860000
208700 COPY ZA000LK1.                                                   20870000
208800     EJECT                                                        20880000
208900***************************************************************** 20890000
209000*   X I R Z B 0 0 0  L I N K A G E  R E C  L A Y O U T          * 20900000
209100*        PARTITION ID SELECT MODULE                             * 20910000
209200***************************************************************** 20920000
209300*                                                                 20930000
209400 01  ZB000LK1.                                                    20940000
209500 COPY ZB000LK1.                                                   20950000
209600     EJECT                                                        20960000
209700***************************************************************** 20970000
209800*   X I R Z C 0 0 0  L I N K A G E  R E C  L A Y O U T          * 20980000
209900*        EMI RECORD EXPANSION MODULE                            * 20990000
210000***************************************************************** 21000000
210100*                                                                 21010000
210200 01  ZC000LK1.                                                    21020000
210300 COPY ZC000LK1.                                                   21030000
210400     EJECT                                                        21040000
210500***************************************************************** 21050000
210600*   THIS AREA IS WHERE ALL OF THE 015127 ARE SAVE TO BE PASSED  * 21060000
210700*   TO XIRI1060                                                 * 21070000
210800***************************************************************** 21080000
210900*                                                                 21090000
211000 01  I1060LK2.                                                    21100000
211100 COPY I1060LK2.                                                   21110000
211200     EJECT                                                        21120000
211300***************************************************************** 21130000
211400*   THIS AREA CONTAINS BILL ORGANIZER INDICATORS                * 21140000
211500***************************************************************** 21150000
211600*                                                                 21160000
211700 01  I1000IND.                                                    21170000
211800 COPY I1000IND.                                                   21180000
211900     EJECT                                                        21190000
212000***************************************************************** 21200000
212100*   D A T E  T I M E S T A M P  M O D U L E                     * 21210000
212200***************************************************************** 21220000
212300*                                                                 21230000
212400 01  Z1000LK1.                                                    21240000
212500 COPY Z1000LK1.                                                   21250000
212600     EJECT                                                        21260000
212700***************************************************************** 21270000
212800*   N P A  S P L I T            M O D U L E                     * 21280000
212900***************************************************************** 21290000
213000*                                                                 21300000
213100 01  Z1100LK1.                                                    21310000
213200 COPY Z1100LK1.                                                   21320000
213300     EJECT                                                        21330000
213400***************************************************************** 21340000
213500*   A B E N D   I N T E R F A C E   R E C  L A Y O U T          * 21350000
213600***************************************************************** 21360000
213700*                                                                 21370000
213800 01  Z9000LK1.                                                    21380000
213900 COPY Z9000LK1.                                                   21390000
214000     EJECT                                                        21400000
214100***************************************************************** 21410000
214200* S Q L  A R E A                                                * 21420000
214300***************************************************************** 21430000
214400*                                                                 21440000
214500***************************************************************** 21450000
214600*   SELECT SUPPLIERS RULES FROM XY4DSB2T          (DS20.13)     * 21460000
214700***************************************************************** 21470000
214800     EXEC SQL                                                     21480000
214900       INCLUDE XIRI001Y                                           21490000
215000     END-EXEC.                                                    21500000
215100     EJECT                                                        21510000
215200*                                                                 21520000
215300***************************************************************** 21530000
215400*   SELECT SUPPLIERS RULES FROM XY4DSB4T                        * 21540000
215500***************************************************************** 21550000
215600     EXEC SQL                                                     21560000
215700       INCLUDE XIRI002Y                                           21570000
215800     END-EXEC.                                                    21580000
215900     EJECT                                                        21590000
216000*                                                                 21600000
216100***************************************************************** 21610000
216200*   INSERT IN TO XZ8USA2T                         (DS1.2)       * 21620000
216300***************************************************************** 21630000
216400*                                                                 21640000
216500     EXEC SQL                                                     21650000
216600       INCLUDE XIRI003Y                                           21660000
216700     END-EXEC.                                                    21670000
216800     EJECT                                                        21680000
216900*                                                                 21690000
217000***************************************************************** 21700000
217100*   INSERT IN TO XZ8USA1T                         (DS1.1)       * 21710000
217200***************************************************************** 21720000
217300*                                                                 21730000
217400     EXEC SQL                                                     21740000
217500       INCLUDE XIRI004Y                                           21750000
217600     END-EXEC.                                                    21760000
217700     EJECT                                                        21770000
217800*                                                                 21780000
217900***************************************************************** 21790000
218000*   INSERT IN TO XZ8USA1T                         (DS1.1)       * 21800000
218100***************************************************************** 21810000
218200*                                                                 21820000
218300     EXEC SQL                                                     21830000
218400       INCLUDE XIRI005Y                                           21840000
218500     END-EXEC.                                                    21850000
218600     EJECT                                                        21860000
218700*                                                                 21870000
218800***************************************************************** 21880000
218900*   SELECT THRESHOLD NUMBER XY4DSC7T              (DS20.17)     * 21890000
219000***************************************************************** 21900000
219100*                                                                 21910000
219200     EXEC SQL                                                     21920000
219300       INCLUDE XIRI006Y                                           21930000
219400     END-EXEC.                                                    21940000
219500     EJECT                                                        21950000
219600*                                                                 21960000
219700***************************************************************** 21970000
219800*   SELECT ROWS FOR INDEX XZ8USA1T                (DS1.1)       * 21980000
219900***************************************************************** 21990000
220000*                                                                 22000000
220100     EXEC SQL                                                     22010000
220200       INCLUDE XIRI008Y                                           22020000
220300     END-EXEC.                                                    22030000
220400     EJECT                                                        22040000
220500***************************************************************** 22050000
220600*   SELECT ROWS FOR INDEX XZ8USA7T                (DS1.1)       * 22060000
220700***************************************************************** 22070000
220800*                                                                 22080000
220900     EXEC SQL                                                     22090000
221000       INCLUDE XIRI044Y                                           22100000
221100     END-EXEC.                                                    22110000
221200     EJECT                                                        22120000
221300***************************************************************** 22130000
221400*   INSERT ROWS FOR INDEX XZ8USB3T                (DS19.04)     * 22140000
221500***************************************************************** 22150000
221600*                                                                 22160000
221700     EXEC SQL                                                     22170000
221800       INCLUDE XIRI013Y                                           22180000
221900     END-EXEC.                                                    22190000
222000     EJECT                                                        22200000
222100***************************************************************** 22210000
222200*   SELECT SUPPLIERS RULES FROM XY4DSC1T          (DS20.16)     * 22220000
222300***************************************************************** 22230000
222400*                                                                 22240000
222500     EXEC SQL                                                     22250000
222600       INCLUDE XIRI022Y                                           22260000
222700     END-EXEC.                                                    22270000
222800     EJECT                                                        22280000
222900***************************************************************** 22290000
223000*   FETCH FROM THE SPLR ELEMENT DICTIONARY DSE3   (DS20.03)     * 22300000
223100*                  SPLR RECORD  DICTIONARY DSE8   (DS20.08)     * 22310000
223200***************************************************************** 22320000
223300*                                                                 22330000
223400     EXEC SQL                                                     22340000
223500       INCLUDE XIRI031Y                                           22350000
223600     END-EXEC.                                                    22360000
223700     EJECT                                                        22370000
223800***************************************************************** 22380000
223900*   ERROR REPOSITORY Y4DSA20V                      DS7.1        * 22390000
224000***************************************************************** 22400000
224100*                                                                 22410000
224200     EXEC SQL                                                     22420000
224300       INCLUDE XIRI033Y                                           22430000
224400     END-EXEC.                                                    22440000
224500     EJECT                                                        22450000
224600***************************************************************** 22460000
224700*   INTERNAL/EXTERNAL ERROR TABLE Y4DSA30V         DS7.3        * 22470000
224800***************************************************************** 22480000
224900*                                                                 22490000
225000     EXEC SQL                                                     22500000
225100       INCLUDE XIRI034Y                                           22510000
225200     END-EXEC.                                                    22520000
225300     EJECT                                                        22530000
225400***************************************************************** 22540000
225500*   COMMON SQL AREA                                             * 22550000
225600***************************************************************** 22560000
225700*                                                                 22570000
225800     EXEC SQL                                                     22580000
225900       INCLUDE SQLCA                                              22590000
226000     END-EXEC.                                                    22600000
226100*                                                                 22610000
226200 PROCEDURE DIVISION.                                              22620000
226300***************************************************************** 22630000
226400* P R O C E D U R E    D I V I S I O N                          * 22640000
226500***************************************************************** 22650000
226600*                                                                 22660000
226700***************************************************************** 22670000
226800*                 0000 MAINLINE                                 * 22680000
226900*                                                               * 22690000
227000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 22700000
227100*       1. DRIVES THE REST OF THE PROGRAM.                      * 22710000
227200*                                                               * 22720000
227300*    PARAGRAPHS CALLED:       1000-BEGIN-MODULE                 * 22730000
227400*                             2000-MAIN-PROCESS                 * 22740000
227500*                             3000-END-MODULE                   * 22750000
227600*                                                               * 22760000
227700***************************************************************** 22770000
227800                                                                  22780000
227900     EXIT.                                                        22790000
228000 0000-MAINLINE SECTION.                                           22800000
228100     MOVE '0000' TO PROG-PAR-NO                                   22810000
228200                                                                  22820000
228300     PERFORM 1000-BEGIN-MODULE THRU 1000-EXIT                     22830000
228400                                                                  22840000
228500     PERFORM 2000-MAIN-PROCESS THRU 2000-EXIT                     22850000
228600       UNTIL FILE-I100001I-EOF                                    22860000
228700                                                                  22870000
228800     PERFORM 3000-END-MODULE THRU 3000-EXIT                       22880000
228900                                                                  22890000
229000     GOBACK                                                       22900000
229100     .                                                            22910000
229200 0000-EXIT.                                                       22920000
229300     EXIT.                                                        22930000
229400                                                                  22940000
229500     EJECT                                                        22950000
229600***************************************************************** 22960000
229700*                1000-BEGIN-MODULE                              * 22970000
229800*                                                               * 22980000
229900*   THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:            * 22990000
230000*      1. CALLS THE START-UP ROUTINE TO INITIALIZE WORKING.     * 23000000
230100*      2. CHECK FOR RESTART                                     * 23010000
230200*      3. LOAD THE INTERNAL SUPPLIER TABLE.                     * 23020000
230300*      4. GET THE CURRENT DATE.                                 * 23030000
230400*      5. INITAL READ OF THE INPUT FILE.                        * 23040000
230500*                                                               * 23050000
230600***************************************************************** 23060000
230700 1000-BEGIN-MODULE SECTION.                                       23070000
230800     MOVE '1000' TO PROG-PAR-NO                                   23080000
230900     PERFORM 1100-INITIALIZATION THRU 1100-EXIT                   23090000
231000     PERFORM C100-CALL-XIRZ1000 THRU C100-EXIT                    23100000
231100     MOVE DB2-FMAT-DAT-TMSTMP TO WS-TIMESTAMP                     23110000
231200     PERFORM 1200-LOAD-SPLR-TBL THRU 1200-EXIT                    23120000
231300     PERFORM 1300-CHECK-FOR-RESTART THRU 1300-EXIT                23130000
231400     IF MODULE-WAS-NOT-RESTARTED                                  23140000
231500         PERFORM 1400-INITIAL-READ THRU 1400-EXIT                 23150000
231600     END-IF                                                       23160000
231700     .                                                            23170000
231800 1000-EXIT.                                                       23180000
231900     EXIT.                                                        23190000
232000                                                                  23200000
232100     EJECT                                                        23210000
232200***************************************************************** 23220000
232300*                1100-INITIALIZATION                            * 23230000
232400*                                                               * 23240000
232500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 23250000
232600*       1. INITIALIZES THE WORKING STORAGE FIELDS.              * 23260000
232700*       2. OPEN THE INPUT AND OUTPUT FILES.                     * 23270000
232800*                                                               * 23280000
232900***************************************************************** 23290000
233000 1100-INITIALIZATION SECTION.                                     23300000
233100     MOVE '1100' TO PROG-PAR-NO                                   23310000
233200     COPY NDVRAUDT.                                               23320000
233300**                                                                23330000
233400*** INITIALIZE WORKING-STORAGE                                    23340000
233500**                                                                23350000
233600     INITIALIZE SPLR-INFO-AR                                      23360000
233700                TB-SPLR-TBL                                       23370000
233800                TRMSN-ACPTNC-RCD                                  23380000
233900                WS-ACCUMULATORS                                   23390000
234000                WS-ACCUMULATORS-3RD                               23400002
234100                WS-HOST-VARS                                      23410000
234200                WS-RAO-TBL                                        23420000
234300                WS-INV-REC-COUNTERS                               23430000
234400                WS-SAVE-AREA                                      23440000
234500                WS-SAVE-AREA-2                                    23450000
234600                WS-SAVE-FIELDS-3RD                                23460002
234700                XIRI004Y                                          23470000
234800                XIRI044Y                                          23480000
234900                XIRI003Y                                          23490000
235000                C1000LK1                                          23500000
235100                C3000LK1                                          23510000
235200                C4000LK1                                          23520000
235300                C5000LK1                                          23530000
235400                E1000LK1                                          23540000
235500                I1005LK1                                          23550000
235600                I1005LK3                                          23560000
235700                I1010LK1                                          23570000
235800                I1050LK1                                          23580000
235900                I1060LK1                                          23590000
236000                Z1000LK1                                          23600000
236100                Z7000LK1                                          23610000
236200                Z9000LK1                                          23620000
236300                ZA000LK1                                          23630000
236400                                                                  23640000
236500     MOVE SPACES TO TRNSCTN-ID OF E1000LK1                        23650000
236600     MOVE ZEROES TO TRNSCTN-SEQ-NO OF E1000LK1                    23660000
236700                    CNTR-SUBTOT-TBL-ENTRIES OF I1005LK2           23670000
236800                    SUBTOT-AMT OF I1005LK2(1)                     23680000
236900                    SUBTOT-AMT OF I1005LK2(2)                     23690000
237000                    SUBTOT-AMT OF I1005LK2(3)                     23700000
237100                    SUBTOT-AMT OF I1005LK2(4)                     23710000
237200                    WS-TOTAL-WRELS-MSG-AMT                        23720000
237300                    WS-TOTAL-WRELS-MSG-NO                         23730000
237400                    WS-TOT-WRELS-MSG-AMT                          23740000
237500                    WS-TOT-WRELS-MSG-NO                           23750000
237600                                                                  23760000
237700     MOVE HIGH-VALUES TO I1060LK2                                 23770000
237800                         SUBTOTAL-TABLE OF I1005LK2               23780000
237900     SET NOT-MULTILINE TO TRUE                                    23790000
238000     MOVE LT-NORMAL-RETURN TO ERRR-CD OF Z9000LK1                 23800000
238100     SET SAV-015127-IDX TO +1                                     23810000
238200     MOVE 'N' TO WS-MAINLINE-RESTART-FLG OF I1090LK1              23820000
238300*                                                                 23830000
238400* OPEN FILES                                                      23840000
238500*                                                                 23850000
238600     OPEN INPUT  FD-I100001I                                      23860000
238700     OPEN OUTPUT FD-I100004O                                      23870000
238800     .                                                            23880000
238900 1100-EXIT.                                                       23890000
239000     EXIT.                                                        23900000
239100                                                                  23910000
239200     EJECT                                                        23920000
239300***************************************************************** 23930000
239400*                1200-LOAD-SPLR-TBL                             * 23940000
239500*                                                               * 23950000
239600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 23960000
239700*       1. LOADS THE INTERNAL SUPPLIER TABLE WITH ALL VALID     * 23970000
239800*          SUPPLIERS TO BE PROCESSED.                           * 23980000
239900*                                                               * 23990000
240000*       2. GETS ALL THE TRAITS NEEDED FOR THE SUPPLIER          * 24000000
240100*          PROCESSED BY THIS PROGRAM.                           * 24010000
240200*                                                               * 24020000
240300***************************************************************** 24030000
240400 1200-LOAD-SPLR-TBL SECTION.                                      24040000
240500*** 961219-62   ALAN MASI   01/21/97                              24050000
240600*                                                                 24060000
240700* REMOVED LOOP TO GET MULTIPLE SPLR'S                             24070000
240800*                                                                 24080000
240900     MOVE '1200' TO PROG-PAR-NO                                   24090000
241000     CALL LT-XIRC1000 USING C1000LK1                              24100000
241100     MOVE RTRN-CD OF C1000LK1 TO LT-ALPHA-RETURN-CODES            24110000
241200                                                                  24120000
241300     EVALUATE LT-ALPHA-RETURN-CODES                               24130000
241400        WHEN LT-SUCCESSFUL                                        24140000
241500           MOVE SPLR-ID OF C1000LK1 TO TB-SPLR                    24150000
241600                                                                  24160000
241700        WHEN LT-NOT-FOUND                                         24170000
241800           CONTINUE                                               24180000
241900                                                                  24190000
242000        WHEN OTHER                                                24200000
242100           SET ERRR-IDX TO +1                                     24210000
242200           MOVE WS-DSC1-ERROR-MSG TO ERRR-DISPL-FLDS(ERRR-IDX)    24220000
242300           MOVE RTRN-CD OF C1000LK1 TO ERRR-CD OF E1000LK1        24230000
242400           MOVE CMMN-SQLCA OF C1000LK1 TO CMMN-SQLCA OF Z9000LK1  24240000
242500           PERFORM E100-PROCESS-ERRORS THRU E100-EXIT             24250000
242600     END-EVALUATE                                                 24260000
242700                                                                  24270000
242800     PERFORM 1250-GET-TRAITS THRU 1250-EXIT                       24280000
242900     .                                                            24290000
243000 1200-EXIT.                                                       24300000
243100     EXIT.                                                        24310000
243200                                                                  24320000
243300     EJECT                                                        24330000
243400***************************************************************** 24340000
243500*                1250-GET-TRAITS                                * 24350000
243600*                                                               * 24360000
243700*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 24370000
243800*                                                               * 24380000
243900*    1. GETS ALL THE TRAITS NEEDED FOR THE SUPPLIER             * 24390000
244000*       PROCESSED BY THIS PROGRAM.                              * 24400000
244100*                                                               * 24410000
244200*    JNL-TRAIT  'JRNS-USED'     'YES'   DO-JOURNALS             * 24420000
244300*                               'NO'    DONT-JOURNAL            * 24430000
244400*                                                               * 24440000
244500*    BLBL-MNS-TRAIT             'SRTDMNS'  (MMMM)               * 24450000
244600*    'BLBL-MNS-FRMT'            'NSRTD10'  (MMMM.S)             * 24460000
244700*                               'NSRMNSC'  (MMMM:SS)            * 24470000
244800*                               'SRTD10'   (MMMM.S)             * 24480000
244900*                                                               * 24490000
245000*    015127-TRAIT  '015127-RCDS'   'USE'                        * 24500000
245100*                                  'DONT-USE'                   * 24510000
245200*                                                               * 24520000
245300*                                                               * 24530000
245400* R961114  -SJW  CALL ROUTINE TO GET ALL TRAITS USED BY         * 24540000
245500*                THIS PROGRAM                                   * 24550000
245600***************************************************************** 24560000
245700 1250-GET-TRAITS    SECTION.                                      24570000
245800     MOVE '1250' TO PROG-PAR-NO                                   24580000
245900                                                                  24590000
246000     MOVE TB-SPLR             TO SPLR-ID OF Z7000LK1              24600000
246100     MOVE WS-PROGRAM-NAME-LIT TO PROG-ID OF Z7000LK1              24610000
246200                                                                  24620000
246300     MOVE LT-JRN-TRAIT        TO TRAIT-ID OF Z7000LK1             24630000
246400     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24640000
246500     MOVE TRAIT-ACTN-VAL TO WS-JRN-TRAIT                          24650000
246600                                                                  24660000
246700     MOVE LT-BLBL-MNS         TO TRAIT-ID OF Z7000LK1             24670000
246800     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24680000
246900     MOVE TRAIT-ACTN-VAL TO WS-BLBL-MNS-TRAIT                     24690000
247000                                                                  24700000
247100     MOVE LT-015127-RCDS      TO TRAIT-ID OF Z7000LK1             24710000
247200     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24720000
247300     MOVE TRAIT-ACTN-VAL TO WS-015127-TRAIT                       24730000
247400                                                                  24740000
247500     MOVE LT-NORMAL-INV       TO TRAIT-ID OF Z7000LK1             24750000
247600     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24760000
247700     MOVE TRAIT-ACTN-VAL TO WS-NORMAL-INV-TRAIT                   24770000
247800                                                                  24780000
247900*BGN MCR970317-70A                                                24790000
248000     MOVE LT-TAX-USG-ID       TO TRAIT-ID OF Z7000LK1             24800000
248100     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24810000
248200     MOVE TRAIT-ACTN-VAL TO WS-TAX-USG-ID-TRAIT                   24820000
248300                                                                  24830000
248400*END MCR970317-70A                                                24840000
248500                                                                  24850000
248600     MOVE LT-SUM-WIRELESS     TO TRAIT-ID OF Z7000LK1             24860000
248700     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24870000
248800     MOVE TRAIT-ACTN-VAL TO WS-HOLD-TRAIT.                        24880000
248900                                                                  24890000
249000     IF WS-WRELS-ACTION = 'YES'                                   24900000
249100        SET SUMMING-WIRELESS-ON TO TRUE                           24910000
249200     ELSE                                                         24920000
249300        SET SUMMING-WIRELESS-OFF TO TRUE                          24930000
249400     END-IF                                                       24940000
249500                                                                  24950000
249600     MOVE LT-INSERT-HDG       TO TRAIT-ID OF Z7000LK1             24960000
249700     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    24970000
249800     MOVE TRAIT-ACTN-VAL TO WS-INSERT-015127-HDG                  24980000
249900                                                                  24990000
250000     MOVE LT-BILL-SUPPRESS    TO TRAIT-ID OF Z7000LK1             25000000
250100     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25010000
250200     MOVE TRAIT-ACTN-VAL TO WS-BILL-SUPPRESS-INDR                 25020000
250300                                                                  25030000
250400     MOVE LT-WIRELESS-STATION TO TRAIT-ID OF Z7000LK1             25040000
250500     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25050000
250600     MOVE TRAIT-ACTN-VAL TO WS-WIRELESS-STATION                   25060000
250700                                                                  25070000
250800     MOVE LT-INS-FST-TM-INV-INDR TO TRAIT-ID OF Z7000LK1          25080000
250900     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25090000
251000     MOVE TRAIT-ACTN-VAL TO WS-INS-FST-TM-INV-INDR                25100000
251100                                                                  25110000
251200     MOVE LT-SPLR-INTRNL-ACCT-NO TO TRAIT-ID OF Z7000LK1          25120000
251300     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25130000
251400     MOVE TRAIT-ACTN-VAL TO WS-SPLR-INTRNL-ACC-NO-TR              25140000
251500                                                                  25150000
251600     MOVE LT-TELCO-ACCT-TYP      TO TRAIT-ID OF Z7000LK1          25160000
251700     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25170000
251800     MOVE TRAIT-ACTN-VAL TO WS-TELCO-ACCT-TYP-INDR                25180000
251900                                                                  25190000
252000     MOVE LT-AFLT-TRNSCTN-IND    TO TRAIT-ID OF Z7000LK1          25200000
252100     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25210000
252200     MOVE TRAIT-ACTN-VAL TO WS-AFLT-TRNSCTN-IND                   25220000
252300                                                                  25230000
252400     MOVE LT-WIFI-MNS  TO TRAIT-ID OF Z7000LK1                    25240000
252500     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25250000
252600     MOVE TRAIT-ACTN-VAL TO WS-WIFI-MNS-TRAIT                     25260000
252700                                                                  25270000
252800     MOVE LT-EXCL-BILL-SIMP   TO TRAIT-ID OF Z7000LK1             25280000
252900     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25290000
253000     MOVE TRAIT-ACTN-VAL TO WS-EXCL-BILL-SIMP-TRAIT               25300000
253100*   ADDED FOR VERIZON                                             25310000
253200                                                                  25320000
253300     MOVE LT-CUST-INQ-NO      TO TRAIT-ID OF Z7000LK1             25330000
253400     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25340000
253500     MOVE TRAIT-ACTN-VAL TO WS-CUST-INQ-NO-TRAIT                  25350000
253600                                                                  25360000
253700     MOVE LT-USA5-TAX-USG-ID TO TRAIT-ID OF Z7000LK1              25370000
253800     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25380000
253900     MOVE TRAIT-ACTN-VAL TO WS-USA5-TAX-USG-ID-TRAIT              25390000
254000                                                                  25400000
254100     MOVE LT-PRCSS-ICE-ENA TO TRAIT-ID OF Z7000LK1                25410000
254200     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25420000
254300     MOVE TRAIT-ACTN-VAL TO WS-LT-PRCSS-ICE-ENA-TRAIT             25430000
254400                                                                  25440000
254500     MOVE LT-POP-XZ8USA7T-TABLE TO TRAIT-ID OF Z7000LK1           25450000
254600     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25460000
254700     MOVE TRAIT-ACTN-VAL TO WS-POP-XZ8USA7T-TABLE-TRAIT           25470000
254800                                                                  25480000
254900                                                                  25490000
255000     MOVE LT-VZW-INVOICE        TO TRAIT-ID OF Z7000LK1           25500000
255100     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    25510000
255200     MOVE TRAIT-ACTN-VAL TO WS-LT-VZW-INVOICE-TRAIT               25520000
255300                                                                  25530000
255400     .                                                            25540000
255500 1250-EXIT.                                                       25550000
255600     EXIT.                                                        25560000
255700                                                                  25570000
255800     EJECT                                                        25580000
255900***************************************************************** 25590000
256000*                1300-CHECK-FOR-RESTART                         * 25600000
256100*                                                               * 25610000
256200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 25620000
256300*       1. CHECK TO SEE IF THE MODULE IS IN RESTART MODE.       * 25630000
256400*                                                               * 25640000
256500***************************************************************** 25650000
256600 1300-CHECK-FOR-RESTART SECTION.                                  25660000
256700     MOVE '1300' TO PROG-PAR-NO                                   25670000
256800     SET SELECT-RQST TO TRUE                                      25680000
256900     CALL LT-CO900AA0 USING CO90KY0C                              25690000
257000     EVALUATE TRUE                                                25700000
257100         WHEN NO-RESTART-DATA                                     25710000
257200             CONTINUE                                             25720000
257300         WHEN RESTART-DATA                                        25730000
257400             PERFORM 1310-RESTART-OCCURED THRU 1310-EXIT          25740000
257500         WHEN OTHER                                               25750000
257600             MOVE ERR-3901 TO ERRR-CD OF E1000LK1                 25760000
257700             MOVE TB-SPLR    TO WS-CURR-SPLR                      25770000
257800             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           25780000
257900     END-EVALUATE                                                 25790000
258000     .                                                            25800000
258100 1300-EXIT.                                                       25810000
258200     EXIT.                                                        25820000
258300                                                                  25830000
258400     EJECT                                                        25840000
258500***************************************************************** 25850000
258600*                1310-RESTART-OCCURED                           * 25860000
258700*                                                               * 25870000
258800*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 25880000
258900*       1. RESTORE THE WORKING-STORAGE SECTION                  * 25890000
259000*                                                               * 25900000
259100***************************************************************** 25910000
259200 1310-RESTART-OCCURED SECTION.                                    25920000
259300     MOVE '1310' TO PROG-PAR-NO                                   25930000
259400     DISPLAY '*************************************************'  25940000
259500     DISPLAY '******                                     ******'  25950000
259600     DISPLAY '******    THIS IS A RESTART OF XIRI1000    ******'  25960000
259700     DISPLAY '******                                     ******'  25970000
259800     DISPLAY '*************************************************'  25980000
259900**                                                                25990000
260000***  RESET WORKING-STORAGE                                        26000000
260100**                                                                26010000
260200     MOVE RESTART-WS-DATA-RCD (01) TO WS-FIRST-RESTART-500        26020000
260300     MOVE RESTART-WS-DATA-RCD (02) TO WS-SECOND-RESTART-500       26030000
260400     MOVE RESTART-WS-DATA-RCD (03) TO WS-THIRD-RESTART-500        26040000
260500     MOVE RESTART-WS-DATA-RCD (04) TO WS-FOURTH-RESTART-500       26050000
260600     MOVE RESTART-WS-DATA-RCD (05) TO WS-5TH-RESTART-500          26060000
260700     MOVE RESTART-WS-DATA-RCD (06) TO WS-6TH-RESTART-500          26070000
260800     MOVE RESTART-WS-DATA-RCD (07) TO WS-7TH-RESTART-500          26080000
260900     MOVE RS-SPLR-INFO-AR  TO SPLR-INFO-AR                        26090000
261000     MOVE RS-XIRI002Y      TO XIRI002Y                            26100000
261100     MOVE RS-XRQNDMH       TO XRQNDMH                             26110000
261200     MOVE RS-E202298M      TO E202298M                            26120000
261300     MOVE RS-E202205M      TO E202205M                            26130000
261400*** TR#159808  02/13/96  ALAN MASI  R960314                       26140000
261500     MOVE WS-CURR-SPLR TO SPLR-ID OF I1050LK1                     26150000
261600                          SPLR-ID OF I1060LK1                     26160000
261700                                                                  26170000
261800     MOVE WS-PROG-CMMT-FREQ TO RESTART-PROG-CMMT-FREQ             26180000
261900     MOVE WS-RESTART-RETRY  TO RESTART-PROG-RETRY-NO              26190000
262000     SET MODULE-WAS-RESTARTED TO TRUE                             26200000
262100     SET FIRST-RSTRT-PACK     TO TRUE                             26210000
262200                                                                  26220000
262300**                                                                26230000
262400***  RESET XIRI1090 COUNTERS                                      26240000
262500**                                                                26250000
262600     MOVE WS-XIRI040Y-RCD-SEL                                     26260000
262700       TO LK-XIRI040Y-RCD-SEL                                     26270000
262800     MOVE WS-XIRI041Y-RCD-SEL                                     26280000
262900       TO LK-XIRI041Y-RCD-SEL                                     26290000
263000     MOVE WS-XIRI041Y-RCD-INS                                     26300000
263100       TO LK-XIRI041Y-RCD-INS                                     26310000
263200     MOVE WS-XIRI041Y-RCD-UPD                                     26320000
263300       TO LK-XIRI041Y-RCD-UPD                                     26330000
263400     MOVE WS-XIRI042Y-RCD-SEL                                     26340000
263500       TO LK-XIRI042Y-RCD-SEL                                     26350000
263600     MOVE WS-XIRI042Y-RCD-UPD                                     26360000
263700       TO LK-XIRI042Y-RCD-UPD                                     26370000
263800     MOVE WS-XIRI043Y-RCD-UPD                                     26380000
263900       TO LK-XIRI043Y-RCD-UPD                                     26390000
264000     MOVE 'Y' TO WS-MAINLINE-RESTART-FLG OF I1090LK1              26400000
264100                                                                  26410000
264200     PERFORM S400-LOAD-RAO-TBL THRU S400-EXIT                     26420000
264300     PERFORM S500-GET-RAO-IND THRU S500-EXIT                      26430000
264400     PERFORM S600-GET-ERRR-THRSHLD-NO THRU S600-EXIT              26440000
264500     PERFORM S700-LOAD-INTRNL-ERRR-TBL THRU S700-EXIT             26450000
264600**                                                                26460000
264700***  BEFORE LOADING THE DATA DICTIONARY TABLE, SET THE            26470000
264800***  WS-XIRI031Y-RCD-FET COUNTER TO +0.                           26480000
264900**                                                                26490000
265000     INITIALIZE WS-XIRI031Y-RCD-FET                               26500000
265100     PERFORM S800-LOAD-DATA-DICT-TBL THRU S800-EXIT               26510000
265200                                                                  26520000
265300**                                                                26530000
265400***  REPOSITION THE INPUT FILE                                    26540000
265500**                                                                26550000
265600     IF TB-SORT-INPUT                                             26560000
265700         INITIALIZE WS-INV-IN-RCD-CNT                             26570000
265800                    WS-INV-IN-SPLR-CNT                            26580000
265900     END-IF                                                       26590000
266000     INITIALIZE WS-RESTART-RCD-CNT                                26600000
266100     PERFORM                                                      26610000
266200       UNTIL (WS-RESTART-RCD-CNT = WS-TOT-IN-FILE-CNT AND         26620000
266300              RS-RESTART-HOLD-EMI-RCD =                           26630000
266400              EMI-RCD OF TRMSN-ACPTNC-RCD) OR                     26640000
266500              FILE-I100001I-EOF                                   26650000
266600         MOVE USG-ID     OF TRMSN-ACPTNC-RCD                      26660000
266700           TO WS-PREV-USG-ID                                      26670000
266800         MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                      26680000
266900           TO WS-PREV-USG-SEQ-NO                                  26690000
267000         READ FD-I100001I                                         26700000
267100             AT END SET FILE-I100001I-EOF TO TRUE                 26710000
267200         END-READ                                                 26720000
267300         MOVE INV-IN-1I TO TRMSN-ACPTNC-RCD                       26730000
267400         IF TB-SORT-INPUT                                         26740000
267500             ADD +1 TO WS-INV-IN-RCD-CNT                          26750000
267600                         WS-INV-IN-SPLR-CNT                       26760000
267700         END-IF                                                   26770000
267800         ADD +1 TO WS-RESTART-RCD-CNT                             26780000
267900     END-PERFORM                                                  26790000
268000                                                                  26800000
268100**                                                                26810000
268200***  AFTER REPOSITIONING THE INPUT FILE FOR SORTED PROCESSING,    26820000
268300***  IF THE NDM HEADER WAS ALREADY PROCESSED, THE                 26830000
268400***  WS-INV-IN-SPLR-CNT AND WS-HDR-TRL-CNT COUNTERS HAVE TO BE    26840000
268500***  REDUCED BY 1.                                                26850000
268600**                                                                26860000
268700     IF TB-SORT-INPUT                                             26870000
268800       IF NDM-HDR-READ                                            26880000
268900         SUBTRACT +1 FROM WS-INV-IN-SPLR-CNT                      26890000
269000                          WS-HDR-TRL-CNT                          26900000
269100       END-IF                                                     26910000
269200     END-IF                                                       26920000
269300                                                                  26930000
269400     IF FILE-I100001I-EOF                                         26940000
269500         MOVE ERR-3916 TO ERRR-CD OF E1000LK1                     26950000
269600         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               26960000
269700         SET NOT-FIRST-RSTRT-PACK     TO TRUE                     26970000
269800     END-IF                                                       26980000
269900                                                                  26990000
270000     IF PACK-TRLR                                                 27000000
270100        PERFORM R200-READ-I100001I THRU R200-EXIT                 27010000
270200        SET NOT-FIRST-RSTRT-PACK TO TRUE                          27020000
270300     END-IF                                                       27030000
270400     .                                                            27040000
270500 1310-EXIT.                                                       27050000
270600     EXIT.                                                        27060000
270700                                                                  27070000
270800     EJECT                                                        27080000
270900***************************************************************** 27090000
271000*                1400-INITIAL-READ                              * 27100000
271100*                                                               * 27110000
271200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 27120000
271300*       1. READ THE INPUT FILE FOR THE FIRST TIME.              * 27130000
271400*       2. CHECK FOR END OF FILE ERROR.                         * 27140000
271500*                                                               * 27150000
271600***************************************************************** 27160000
271700 1400-INITIAL-READ SECTION.                                       27170000
271800     MOVE '1400' TO PROG-PAR-NO                                   27180000
271900     PERFORM R200-READ-I100001I THRU R200-EXIT                    27190000
272000     IF FILE-I100001I-EOF                                         27200000
272100         MOVE ERR-3915 TO ERRR-CD OF E1000LK1                     27210000
272200         MOVE TB-SPLR    TO WS-CURR-SPLR                          27220000
272300         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               27230000
272400     END-IF                                                       27240000
272500     .                                                            27250000
272600 1400-EXIT.                                                       27260000
272700     EXIT.                                                        27270000
272800                                                                  27280000
272900     EJECT                                                        27290000
273000***************************************************************** 27300000
273100*                2000-MAIN-PROCESSING                           * 27310000
273200*                                                               * 27320000
273300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 27330000
273400*       1. READ EACH RECORD.                                    * 27340000
273500*       2. BASED ON THE RECORD ID CALL THE APPROPRIATE ROUTINE. * 27350000
273600*                                                               * 27360000
273700***************************************************************** 27370000
273800 2000-MAIN-PROCESS SECTION.                                       27380000
273900     MOVE '2000' TO PROG-PAR-NO                                   27390000
274000     SET NOT-READ-FROM-SORT-AREA TO TRUE                          27400000
274100     EVALUATE TRUE                                                27410000
274200         WHEN NDM-HDR                                             27420000
274300             PERFORM 2100-NDM-HDR THRU 2100-EXIT                  27430000
274400         WHEN SPLR-HDR                                            27440000
274500             PERFORM 2200-SPLR-HDR THRU 2200-EXIT                 27450000
274600         WHEN (PACK-HDR                                           27460000
274700           OR SUM21-RCD                                           27470000
274800           OR SUM22-RCD                                           27480000
274900           OR SUM23-RCD                                           27490000
275000           OR PHR27-RCD                                           27500000
275100           OR MSG81-RCD                                           27510000
275200           OR MSG82-RCD                                           27520000
275300           OR PACK-TRLR)                                          27530000
275400          AND TB-SORT-INPUT                                       27540000
275500             PERFORM 2300-SORT-PROCESSING THRU 2300-EXIT          27550000
275600         WHEN (PACK-HDR                                           27560000
275700           OR SUM21-RCD                                           27570000
275800           OR SUM22-RCD                                           27580000
275900           OR SUM23-RCD                                           27590000
276000           OR PHR27-RCD                                           27600000
276100           OR MSG81-RCD                                           27610000
276200           OR MSG82-RCD                                           27620000
276300           OR PACK-TRLR)                                          27630000
276400          AND TB-NOT-SORT-INPUT                                   27640000
276500             PERFORM 2400-NON-SORT-PROCESSING THRU 2400-EXIT      27650000
276600         WHEN SPLR-TRLR                                           27660000
276700             PERFORM 2500-SPLR-TRLR THRU 2500-EXIT                27670000
276800         WHEN NDM-TRLR                                            27680000
276900             PERFORM 2600-NDM-TRLR THRU 2600-EXIT                 27690000
277000         WHEN OTHER                                               27700000
277100             MOVE ERR-3922 TO ERRR-CD OF E1000LK1                 27710000
277200             MOVE WS-INV-RCD-ID-LTRL TO WS-ERRR-LTRL              27720000
277300             MOVE WS-REC-ID TO WS-ERRR-VAL                        27730000
277400             MOVE WS-ERRR-DISPL TO                                27740000
277500                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  27750000
277600             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           27760000
277700     END-EVALUATE                                                 27770000
277800                                                                  27780000
277900     IF NOT-READ-FROM-SORT-AREA                                   27790000
278000        PERFORM R200-READ-I100001I THRU R200-EXIT                 27800000
278100     END-IF                                                       27810000
278200     .                                                            27820000
278300 2000-EXIT.                                                       27830000
278400     EXIT.                                                        27840000
278500                                                                  27850000
278600     EJECT                                                        27860000
278700***************************************************************** 27870000
278800*                2100-NDM-HDR                                   * 27880000
278900*                                                               * 27890000
279000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 27900000
279100*                                                               * 27910000
279200*       1. CHECK FOR MISSING NDM TRAILER RECORD. (CHECKED FOR   * 27920000
279300*          WHEN THERE ARE CONCATENATED FILES)                   * 27930000
279400*       2. CHANGE THE NDM TRAILER FLAG BACK TO NOT-READ SO THAT * 27940000
279500*          A MISSING NDM TRAILER CAN BE DETECTED.  (THIS IS     * 27950000
279600*          ORIGINALLY SET TO TRUE TO ALLOW FOR THE FIRST NDM    * 27960000
279700*          HEADER WITHOUT A NDM TRAILER BEFORE IT)              * 27970000
279800*                                                               * 27980000
279900***************************************************************** 27990000
280000 2100-NDM-HDR SECTION.                                            28000000
280100     MOVE '2100' TO PROG-PAR-NO                                   28010000
280200     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO XRQNDMH                  28020000
280300     IF NDM-TRLR-NOT-READ                                         28030000
280400         MOVE ERR-3908 TO ERRR-CD OF E1000LK1                     28040000
280500         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               28050000
280600     END-IF                                                       28060000
280700**                                                                28070000
280800***  BECAUSE THE INV-IN-SPLR-CNT INCLUDES THE NDM-HDR IN THE      28080000
280900***  COUNT AND THE BALANCING RULES DO NOT, THE HDR IS SUBTRACTED  28090000
281000***  OUT                                                          28100000
281100**                                                                28110000
281200     SUBTRACT +1 FROM WS-INV-IN-SPLR-CNT                          28120000
281300     SET NDM-HDR-READ TO TRUE                                     28130000
281400     SET NDM-TRLR-NOT-READ TO TRUE                                28140000
281500     .                                                            28150000
281600 2100-EXIT.                                                       28160000
281700     EXIT.                                                        28170000
281800                                                                  28180000
281900     EJECT                                                        28190000
282000***************************************************************** 28200000
282100*                2200-SPLR-HDR                                  * 28210000
282200*                                                               * 28220000
282300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 28230000
282400*       1. CHECK FOR A MISSING NDM HEADER RECORD.               * 28240000
282500*       2. CALLS VARIOUS ROUTINES TO DO THE FOLLOWING:          * 28250000
282600*           - VALIDATE THE SUPPLIER ID ON THE SUPPLIER HEADER   * 28260000
282700*           - CHECK ON THE PROGRAM DEPENDENCIES                 * 28270000
282800*           - MAKE SURE FILE HASN'T BEEN PROCESSED BEFORE       * 28280000
282900*           - LOAD THE INTERNAL RAO TABLE                       * 28290000
283000*           - GET THE RAO INDICATOR                             * 28300000
283100*           - GET THE ERROR THRESHOLD NUMBER                    * 28310000
283200*                                                               * 28320000
283300***************************************************************** 28330000
283400 2200-SPLR-HDR SECTION.                                           28340000
283500     MOVE '2200' TO PROG-PAR-NO                                   28350000
283600     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO E202298M                 28360000
283700     IF NDM-HDR-NOT-READ                                          28370000
283800         MOVE ERR-3907   TO ERRR-CD OF E1000LK1                   28380000
283900         MOVE TB-SPLR    TO WS-CURR-SPLR                          28390000
284000         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               28400000
284100     END-IF                                                       28410000
284200     SET SPLR-HDR-READ TO TRUE                                    28420000
284300     ADD +1            TO WS-HDR-TRL-CNT                          28430000
284400     PERFORM 2210-SEARCH-SPLR-TBL THRU 2210-EXIT                  28440000
284500     IF FIRST-TIME-IN-K000                                        28450000
284600        PERFORM 2220-CNTL-VALID-DEPEND THRU 2220-EXIT             28460000
284700     END-IF                                                       28470000
284800     PERFORM 2230-CNTL-DUP-FILE THRU 2230-EXIT                    28480000
284900     PERFORM S400-LOAD-RAO-TBL THRU S400-EXIT                     28490000
285000     PERFORM S500-GET-RAO-IND THRU S500-EXIT                      28500000
285100     PERFORM S600-GET-ERRR-THRSHLD-NO THRU S600-EXIT              28510000
285200     PERFORM S700-LOAD-INTRNL-ERRR-TBL THRU S700-EXIT             28520000
285300     .                                                            28530000
285400 2200-EXIT.                                                       28540000
285500     EXIT.                                                        28550000
285600                                                                  28560000
285700     EJECT                                                        28570000
285800***************************************************************** 28580000
285900*                2210-SEARCH-SPLR-TBL                           * 28590000
286000*                                                               * 28600000
286100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 28610000
286200*       1. ATTEMPT TO MATCH THE SUPPLIER ID ON THE HEADER       * 28620000
286300*          RECORD TO A SUPPLIER ID ON THE INTERNAL SUPPLIER     * 28630000
286400*          ID TABLE. IF A MATCH IS NOT FOUND, ERRORS IS CALLED. * 28640000
286500*                                                               * 28650000
286600***************************************************************** 28660000
286700 2210-SEARCH-SPLR-TBL SECTION.                                    28670000
286800     MOVE '2210' TO PROG-PAR-NO                                   28680000
286900     MOVE HDR98-CARR-ID TO WS-SPLR-NUM                            28690000
287000     IF TB-SPLR = SPACES                                          28700000
287100         MOVE WS-CURR-SPLR       TO WS-ERRR-VAL                   28710000
287200         MOVE WS-INVD-SPLR-LTRL  TO WS-ERRR-LTRL                  28720000
287300         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1 (1)    28730000
287400         MOVE ERR-3906           TO ERRR-CD OF E1000LK1           28740000
287500         MOVE TB-SPLR            TO WS-CURR-SPLR                  28750000
287600         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               28760000
287700     ELSE                                                         28770000
287800         SET TB-SPLR-PROCESSED TO TRUE                            28780000
287900     END-IF                                                       28790000
288000                                                                  28800000
288100     MOVE WS-CURR-SPLR TO SPLR-ID OF I1050LK1                     28810000
288200                          SPLR-ID OF I1060LK1                     28820000
288300     .                                                            28830000
288400 2210-EXIT.                                                       28840000
288500     EXIT.                                                        28850000
288600                                                                  28860000
288700     EJECT                                                        28870000
288800***************************************************************** 28880000
288900*                2220-CNTL-VALID-DEPEND                         * 28890000
289000*                                                               * 28900000
289100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 28910000
289200*       1. CALL THE VALIDATE DEPENDENCIES CONTROLS MODULE.      * 28920000
289300*       2. ON THE FIRST TIME INTO THIS PARAGRAPH DO A COMMIT    * 28930000
289400*          TO RELEASE THE CONTROL TABLES.                       * 28940000
289500*       3. LOAD THE INFORMATION RETURNED FORM XIRC2000 INTO     * 28950000
289600*          WORKING-STORAGE FOR RESTART.                         * 28960000
289700*                                                               * 28970000
289800***************************************************************** 28980000
289900 2220-CNTL-VALID-DEPEND SECTION.                                  28990000
290000     MOVE 'S200' TO PROG-PAR-NO                                   29000000
290100     MOVE WS-CURR-SPLR TO SPLR-ID          OF SPLR-INFO-AR        29010000
290200     MOVE LT-REGENTRY  TO FUNC-ID          OF SPLR-INFO-AR        29020000
290300     MOVE WS-TIMESTAMP TO PROG-STRT-TMSTMP OF SPLR-INFO-AR        29030000
290400     MOVE APPLCN-BLG-GR-ID OF C1000LK1                            29040000
290500       TO APPLCN-BLG-GR-ID OF SPLR-INFO-AR                        29050000
290600                                                                  29060000
290700     CALL LT-XIRC2000 USING SPLR-INFO-AR                          29070000
290800                                                                  29080000
290900     MOVE RTRN-CD OF SPLR-INFO-AR TO LT-ALPHA-RETURN-CODES        29090000
291000     EVALUATE LT-ALPHA-RETURN-CODES                               29100000
291100         WHEN LT-SUCCESSFUL                                       29110000
291200             PERFORM 2221-LOAD-RESTART-INFO THRU 2221-EXIT        29120000
291300                                                                  29130000
291400             IF FIRST-TIME-IN-K000                                29140000
291500                 PERFORM K000-COMMIT THRU K000-EXIT               29150000
291600             ELSE                                                 29160000
291700                 PERFORM A400-RESTART-CHECK-POINT THRU A400-EXIT  29170000
291800             END-IF                                               29180000
291900                                                                  29190000
292000             PERFORM 2222-GET-SUPPLIER-DATA THRU 2222-EXIT        29200000
292100         WHEN OTHER                                               29210000
292200             MOVE CMMN-SQLCA OF SPLR-INFO-AR TO                   29220000
292300                 CMMN-SQLCA OF Z9000LK1                           29230000
292400             MOVE RTRN-CD OF SPLR-INFO-AR TO ERRR-CD OF E1000LK1  29240000
292500             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           29250000
292600     END-EVALUATE                                                 29260000
292700     .                                                            29270000
292800 2220-EXIT.                                                       29280000
292900     EXIT.                                                        29290000
293000                                                                  29300000
293100     EJECT                                                        29310000
293200***************************************************************** 29320000
293300*                2221-LOAD-RESTART-INFO                         * 29330000
293400*                                                               * 29340000
293500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 29350000
293600*       1. MOVE THE RESTART INFORMATION IN TO THE LINKAGE FOR   * 29360000
293700*          CO90 AND WORKING-STORAGE.                            * 29370000
293800*                                                               * 29380000
293900***************************************************************** 29390000
294000 2221-LOAD-RESTART-INFO SECTION.                                  29400000
294100     MOVE '2221' TO PROG-PAR-NO                                   29410000
294200     MOVE APPLCN-RGN-ID  OF SPLR-INFO-AR TO WS-APPLCN-RGN-ID      29420000
294300     MOVE APPLCN-LOCN-ID OF SPLR-INFO-AR TO WS-APPLCN-LOCN-ID     29430000
294400     MOVE APPLCN-BLG-GR-ID OF SPLR-INFO-AR TO WS-APPLCN-BLG-GR-ID 29440000
294500     MOVE PROG-CMMT-FREQ-NO OF SPLR-INFO-AR                       29450000
294600       TO RESTART-PROG-CMMT-FREQ                                  29460000
294700          WS-PROG-CMMT-FREQ                                       29470000
294800     MOVE PROG-ID       OF SPLR-INFO-AR TO RESTART-PROG-ID        29480000
294900     MOVE PROG-RETRY-NO OF SPLR-INFO-AR TO RESTART-PROG-RETRY-NO  29490000
295000                                           WS-RESTART-RETRY       29500000
295100     MOVE WS-CURR-SPLR TO RESTART-SPLR-ID                         29510000
295200     MOVE LT-REGENTRY TO RESTART-FUNC-ID                          29520000
295300     MOVE CURR-PRCSS-CY-NO OF SPLR-INFO-AR                        29530000
295400       TO WS-CURR-PRCSS-CY-NO                                     29540000
295500     MOVE CURR-PRCSS-CY-DAT OF SPLR-INFO-AR                       29550000
295600       TO WS-CURR-PRCSS-CY-DAT                                    29560000
295700     MOVE CURR-SYS-DAT OF SPLR-INFO-AR TO WS-CURR-SYS-DAT         29570000
295800     MOVE CURR-SYS-TM OF SPLR-INFO-AR TO WS-CURR-SYS-TM           29580000
295900     .                                                            29590000
296000 2221-EXIT.                                                       29600000
296100     EXIT.                                                        29610000
296200                                                                  29620000
296300     EJECT                                                        29630000
296400***************************************************************** 29640000
296500*                2222-GET-SUPPLIER-DATA                         * 29650000
296600*                                                               * 29660000
296700*    THIS PARAGRAPH PERFORMS A SELECT ON THE SUPPLIER TABLE TO  * 29670000
296800*    GET ADDITIONAL SUPPLIER DATA.                              * 29680000
296900*                                                               * 29690000
297000***************************************************************** 29700000
297100 2222-GET-SUPPLIER-DATA SECTION.                                  29710000
297200     MOVE '2222' TO PROG-PAR-NO                                   29720000
297300     MOVE TB-SPLR TO SPLR-ID OF XIRI022Y                          29730000
297400     INITIALIZE WS-RETRY-CNT                                      29740000
297500     SET LOCKED-OUT TO TRUE                                       29750000
297600     PERFORM                                                      29760000
297700        UNTIL RESTART-PROG-RETRY-NO IS EQUAL TO  WS-RETRY-CNT     29770000
297800           OR NOT LOCKED                                          29780000
297900         EXEC SQL                                                 29790000
298000             INCLUDE XIRI22S1                                     29800000
298100         END-EXEC                                                 29810000
298200         ADD +1 TO WS-RETRY-CNT                                   29820000
298300         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        29830000
298400     END-PERFORM                                                  29840000
298500                                                                  29850000
298600     EVALUATE SQLCODE                                             29860000
298700         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             29870000
298800              MOVE SPLR-CUST-INDR OF XIRI022Y TO                  29880000
298900                  TB-SPLR-CUS-INDR                                29890000
299000              MOVE SRT-ORD-INDR OF XIRI022Y TO                    29900000
299100                  TB-SRT-ORD-INDR                                 29910000
299200              ADD +1 TO WS-XIRI022Y-RCD-FET                       29920000
299300         WHEN OTHER                                               29930000
299400              MOVE ERR-3999 TO ERRR-CD OF E1000LK1                29940000
299500              MOVE LT-XIRI022Y TO VW-NM OF Z9000LK1               29950000
299600              MOVE SQLCA TO SQLCA-AR OF Z9000LK1                  29960000
299700              MOVE WS-DSC1T-ERRR-MSG TO                           29970000
299800                  ERRR-DISPL-FLDS OF Z9000LK1 (1)                 29980000
299900              MOVE WS-SPLR-ID-LTRL    TO WS-ERRR-LTRL             29990000
300000              MOVE SPLR-ID OF XIRI022Y TO WS-ERRR-VAL             30000000
300100              MOVE WS-ERRR-DISPL TO                               30010000
300200                   ERRR-DISPL-FLDS OF Z9000LK1 (2)                30020000
300300              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          30030000
300400     END-EVALUATE                                                 30040000
300500     .                                                            30050000
300600 2222-EXIT.                                                       30060000
300700     EXIT.                                                        30070000
300800                                                                  30080000
300900     EJECT                                                        30090000
301000***************************************************************** 30100000
301100*                2230-CNTL-DUP-FILE.                            * 30110000
301200*                                                               * 30120000
301300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 30130000
301400*       1. CALL THE DUPLICATE FILE CONTROLS MODULE.             * 30140000
301500*                                                               * 30150000
301600***************************************************************** 30160000
301700 2230-CNTL-DUP-FILE SECTION.                                      30170000
301800     MOVE '2230' TO PROG-PAR-NO                                   30180000
301900     MOVE WS-APPLCN-RGN-ID    TO APPLCN-RGN-ID    OF C3000LK1     30190000
302000     MOVE WS-APPLCN-LOCN-ID   TO APPLCN-LOCN-ID   OF C3000LK1     30200000
302100     MOVE WS-APPLCN-BLG-GR-ID TO APPLCN-BLG-GR-ID OF C3000LK1     30210000
302200     MOVE LT-XIRI1000         TO PROG-ID          OF C3000LK1     30220000
302300     MOVE WS-CURR-SPLR        TO SPLR-ID          OF C3000LK1     30230000
302400     MOVE LT-REGENTRY         TO FUNC-ID          OF C3000LK1     30240000
302500     MOVE HDR98-INV-NO TO CURR-FIL-HDR-SEQ-NO(1)                  30250000
302600                          FIL-HDR-SEQ-NO(1)                       30260000
302700     MOVE HDR98-TM-CRTD TO WS-TIME-4                              30270000
302800     MOVE WS-TIME-4-HH TO WS-TIME-HH                              30280000
302900     MOVE WS-TIME-4-MM TO WS-TIME-MM                              30290000
303000     MOVE '00' TO WS-TIME-SS                                      30300000
303100     MOVE WS-TIME-FRMT TO CURR-FIL-HDR-TM(1)                      30310000
303200                          FIL-HDR-TM(1)                           30320000
303300     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT.                   30330000
303400     SET UPPER-CASE     OF DTFMT TO TRUE.                         30340000
303500     SET USER-SPECIFIED OF DTFMT TO TRUE.                         30350000
303600     MOVE HDR98-RCNCLN-DAT TO DF-YYMMDD OF DTFMT.                 30360000
303700                                                                  30370000
303800     CALL DATETIME USING DTFMT.                                   30380000
303900                                                                  30390000
304000     IF FB-ERROR OF DTFMT                                         30400000
304100       MOVE DATETIME-ERR       TO ERRR-CD OF E1000LK1             30410000
304200       MOVE 'DATETIME ERR '    TO WS-ERRR-LTRL                    30420000
304300       MOVE HDR98-RCNCLN-DAT   TO WS-ERRR-VAL                     30430000
304400       MOVE WS-ERRR-DISPL TO                                      30440000
304500                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  30450000
304600       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 30460000
304700     END-IF.                                                      30470000
304800     MOVE DF-YYYY-MM-DD OF DTFMT  TO CURR-FIL-HDR-DAT(1)          30480000
304900                                     FIL-HDR-DAT(1)               30490000
305000     MOVE LT-I100001I             TO CURR-INPT-OP-DA-NM(1)        30500000
305100                                                                  30510000
305200     CALL LT-XIRC3000 USING C3000LK1                              30520000
305300                                                                  30530000
305400     MOVE RTRN-CD OF C3000LK1 TO LT-ALPHA-RETURN-CODES            30540000
305500     EVALUATE LT-ALPHA-RETURN-CODES                               30550000
305600        WHEN LT-SUCCESSFUL                                        30560000
305700             PERFORM 2231-LOCATE-INPUT-FILE THRU 2231-EXIT        30570000
305800        WHEN OTHER                                                30580000
305900             MOVE RTRN-CD    OF C3000LK1 TO ERRR-CD OF E1000LK1   30590000
306000             MOVE CMMN-SQLCA OF C3000LK1 TO                       30600000
306100                  CMMN-SQLCA OF Z9000LK1                          30610000
306200             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           30620000
306300     END-EVALUATE                                                 30630000
306400     .                                                            30640000
306500 2230-EXIT.                                                       30650000
306600     EXIT.                                                        30660000
306700                                                                  30670000
306800     EJECT                                                        30680000
306900***************************************************************** 30690000
307000*               2231-LOCATE-INPUT-FILE                          * 30700000
307100*                                                               * 30710000
307200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 30720000
307300*       1. SEARCH THE TABLE RETURNED TO FIND THE INPUT FILE.    * 30730000
307400*                                                               * 30740000
307500***************************************************************** 30750000
307600 2231-LOCATE-INPUT-FILE SECTION.                                  30760000
307700     MOVE '2231' TO PROG-PAR-NO                                   30770000
307800     SET PREV-INPT-OP-DA-NM-NOT-FOUND TO TRUE                     30780000
307900     SET PREV-IDX TO +1                                           30790000
308000     PERFORM                                                      30800000
308100       UNTIL PREV-INPT-OP-DA-NM-FOUND                             30810000
308200          OR PREV-INPT-OP-DA-NM OF C3000LK1 (PREV-IDX) = SPACES   30820000
308300          OR PREV-IDX > LT-MAX-PREV-IDX                           30830000
308400             EVALUATE PREV-INPT-OP-DA-NM OF C3000LK1 (PREV-IDX)   30840000
308500                 WHEN LT-I100001I                                 30850000
308600                     PERFORM 22311-CHECK-FIL-HDR-SEQ-NO           30860000
308700                        THRU 22311-EXIT                           30870000
308800                 WHEN OTHER                                       30880000
308900                     SET PREV-IDX UP BY +1                        30890000
309000              END-EVALUATE                                        30900000
309100     END-PERFORM                                                  30910000
309200     .                                                            30920000
309300 2231-EXIT.                                                       30930000
309400     EXIT.                                                        30940000
309500                                                                  30950000
309600     EJECT                                                        30960000
309700***************************************************************** 30970000
309800*               22311-CHECK-FIL-HDR-SEQ-NO                      * 30980000
309900*                                                               * 30990000
310000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 31000000
310100*    1) VERIFY THAT THE FIL HDR SEQ NO HAS INCREASED BY ONE.    * 31010000
310200*       WHEN THE PREVIOUS FIL HDR SEQ NO IS EQUAL TO 99, MOVE   * 31020000
310300*       ZEROES TO THE COMPARE FIELD BECAUSE THE NEXT VALID      * 31030000
310400*       SEQUENCE NUMBER AFTER 99 IS 01.                         * 31040000
310500*                                                               * 31050000
310600***************************************************************** 31060000
310700 22311-CHECK-FIL-HDR-SEQ-NO SECTION.                              31070000
310800     MOVE '22311' TO PROG-PAR-NO                                  31080000
310900     SET PREV-INPT-OP-DA-NM-FOUND TO TRUE                         31090000
311000     MOVE PREV-FIL-HDR-SEQ-NO OF C3000LK1 (PREV-IDX)              31100000
311100       TO WS-PREV-SEQ-PLUS-1                                      31110000
311200                                                                  31120000
311300     IF TB-FIL-HDR-SWITCH IS EQUAL TO LT-Y                        31130000
311400         MOVE TB-FIL-HDR-SEQ-NO TO WS-PREV-SEQ-PLUS-1             31140000
311500     END-IF                                                       31150000
311600                                                                  31160000
311700     IF WS-PREV-SEQ-PLUS-1 IS EQUAL TO LT-99                      31170000
311800         MOVE ZERO TO WS-PREV-SEQ-PLUS-1                          31180000
311900     END-IF                                                       31190000
312000                                                                  31200000
312100     ADD 1 TO WS-PREV-SEQ-PLUS-1                                  31210000
312200                                                                  31220000
312300     IF CURR-FIL-HDR-SEQ-NO (1) NOT EQUAL WS-PREV-SEQ-PLUS-1      31230000
312400         MOVE ERR-3928 TO ERRR-CD OF E1000LK1                     31240000
312500         MOVE WS-INV-HDR-SEQ-NO                                   31250000
312600           TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                     31260000
312700         MOVE WS-CURR-FIL-SEQ-NO TO WS-ERRR-LTRL                  31270000
312800         MOVE CURR-FIL-HDR-SEQ-NO (1) TO WS-ERRR-VAL              31280000
312900         MOVE WS-ERRR-DISPL                                       31290000
313000           TO ERRR-DISPL-FLDS OF Z9000LK1 (2)                     31300000
313100         MOVE WS-PREV-FIL-SEQ-NO TO WS-ERRR-LTRL                  31310000
313200         MOVE PREV-FIL-HDR-SEQ-NO (PREV-IDX) TO WS-ERRR-VAL       31320000
313300         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1 (3)    31330000
313400         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               31340000
313500     END-IF                                                       31350000
313600     .                                                            31360000
313700 22311-EXIT.                                                      31370000
313800     EXIT.                                                        31380000
313900                                                                  31390000
314000     EJECT                                                        31400000
314100***************************************************************** 31410000
314200*                2300-SORT-PROCESSING                           * 31420000
314300*                                                               * 31430000
314400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 31440000
314500*                                                               * 31450000
314600*       1. PROCESS INVOICE RECORDS FOR SUPPLIERS THAT REQUIRE   * 31460000
314700*          THE SORT.                                            * 31470000
314800*                                                               * 31480000
314900***************************************************************** 31490000
315000 2300-SORT-PROCESSING SECTION.                                    31500000
315100     MOVE '2300' TO PROG-PAR-NO                                   31510000
315200     SORT SD-I100003O                                             31520000
315300         ON ASCENDING KEY SORT-KEY                                31530000
315400                                                                  31540000
315500     INPUT  PROCEDURE 2310-INPUT-PROCEDURE                        31550000
315600                                                                  31560000
315700     OUTPUT PROCEDURE 2320-OUTPUT-PROCEDURE                       31570000
315800     .                                                            31580000
315900 2300-EXIT.                                                       31590000
316000     EXIT.                                                        31600000
316100                                                                  31610000
316200     EJECT                                                        31620000
316300***************************************************************** 31630000
316400*            2310-INPUT-PROCEDURE                               * 31640000
316500*                                                               * 31650000
316600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 31660000
316700*                                                               * 31670000
316800*       1. DOES UP FRONT PROCESSING ON THE INVOICE RECORD AND   * 31680000
316900*          THEN RELEASES IT TO THE SORT.  THIS PARAGRAPH IS     * 31690000
317000*          PERFORMED UNTIL A PACK TRAILER IS ENCOUNTERED.       * 31700000
317100*                                                               * 31710000
317200***************************************************************** 31720000
317300 2310-INPUT-PROCEDURE SECTION.                                    31730000
317400                                                                  31740000
317500     MOVE '2310' TO PROG-PAR-NO                                   31750000
317600                                                                  31760000
317700     SET DO-NOT-PERFORM-SORT TO TRUE                              31770000
317800     SET READ-FROM-SORT-AREA TO TRUE                              31780000
317900     SET NOT-END-OF-SORT TO TRUE                                  31790000
318000                                                                  31800000
318100     PERFORM UNTIL PERFORM-SORT                                   31810000
318200                                                                  31820000
318300        EVALUATE TRUE                                             31830000
318400            WHEN PACK-HDR                                         31840000
318500                 PERFORM B100-PACK-HDR THRU B100-EXIT             31850000
318600            WHEN SUM21-RCD                                        31860000
318700                 PERFORM B200-SUM21-RCD THRU B200-EXIT            31870000
318800            WHEN SUM22-RCD                                        31880000
318900                 PERFORM B300-SUM22-RCD THRU B300-EXIT            31890000
319000            WHEN SUM23-RCD                                        31900000
319100                 PERFORM B400-SUM23-RCD THRU B400-EXIT            31910000
319200            WHEN PHR27-RCD                                        31920000
319300                 PERFORM B500-PHR27-RCD THRU B500-EXIT            31930000
319400            WHEN MSG81-RCD                                        31940000
319500                 PERFORM B600-MSG81-RCD THRU B600-EXIT            31950000
319600            WHEN MSG82-RCD                                        31960000
319700                 PERFORM B600-MSG81-RCD THRU B600-EXIT            31970000
319800            WHEN PACK-TRLR                                        31980000
319900                 PERFORM B700-PACK-TRLR THRU B700-EXIT            31990000
320000            WHEN OTHER                                            32000000
320100                 MOVE ERR-3922           TO ERRR-CD OF E1000LK1   32010000
320200                 MOVE WS-INV-RCD-ID-LTRL TO WS-ERRR-LTRL          32020000
320300                 MOVE WS-REC-ID          TO WS-ERRR-VAL           32030000
320400                 MOVE WS-ERRR-DISPL                               32040000
320500                   TO ERRR-DISPL-FLDS OF Z9000LK1 (1)             32050000
320600                 PERFORM E100-PROCESS-ERRORS THRU E100-EXIT       32060000
320700        END-EVALUATE                                              32070000
320800                                                                  32080000
320900        IF PERFORM-SORT                                           32090000
321000            CONTINUE                                              32100000
321100        ELSE                                                      32110000
321200           PERFORM R200-READ-I100001I THRU R200-EXIT              32120000
321300        END-IF                                                    32130000
321400     END-PERFORM                                                  32140000
321500     .                                                            32150000
321600 2310-EXIT.                                                       32160000
321700     EXIT.                                                        32170000
321800                                                                  32180000
321900     EJECT                                                        32190000
322000***************************************************************** 32200000
322100*            2320-OUTPUT-PROCEDURE                              * 32210000
322200*                                                               * 32220000
322300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 32230000
322400*                                                               * 32240000
322500*       1. PROCESSING THAT TAKES PLACE AFTER THE SORT.          * 32250000
322600*                                                               * 32260000
322700***************************************************************** 32270000
322800 2320-OUTPUT-PROCEDURE SECTION.                                   32280000
322900     MOVE '2320' TO PROG-PAR-NO                                   32290000
323000     IF SORT-RETURN IS NOT EQUAL TO ZEROES                        32300000
323100         MOVE ERR-3929 TO ERRR-CD OF E1000LK1                     32310000
323200         MOVE SORT-RETURN TO WS-3929-SRT-RTN                      32320000
323300         MOVE WS-3929-MSG TO ERRR-DISPL-FLDS OF Z9000LK1 (1)      32330000
323400         MOVE LT-XIRI1000 TO MDLE-ID OF Z9000LK1                  32340000
323500         SET DO-NOT-DISPLAY-STD-MSGS TO TRUE                      32350000
323600         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               32360000
323700     END-IF                                                       32370000
323800     PERFORM 2321-RETURN-RECORDS THRU 2321-EXIT                   32380000
323900       UNTIL END-OF-SORT                                          32390000
324000     .                                                            32400000
324100 2320-EXIT.                                                       32410000
324200     EXIT.                                                        32420000
324300                                                                  32430000
324400     EJECT                                                        32440000
324500***************************************************************** 32450000
324600*                2321-RETURN-RECORDS                            * 32460000
324700*                                                               * 32470000
324800*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 32480000
324900*                                                               * 32490000
325000*       1. PROCESS THE INVOICE RECORDS AS THEY RETURN FROM THE  * 32500000
325100*          SORT IN CORRECT ORDER.                               * 32510000
325200*                                                               * 32520000
325300***************************************************************** 32530000
325400 2321-RETURN-RECORDS SECTION.                                     32540000
325500     MOVE '2321' TO PROG-PAR-NO                                   32550000
325600     SET SORT-REC-IDX TO +1                                       32560000
325700     RETURN SD-I100003O                                           32570000
325800         AT END                                                   32580000
325900            SET END-OF-SORT TO TRUE                               32590000
326000     END-RETURN                                                   32600000
326100     ADD +1 TO WS-RCDS-RTRND                                      32610000
326200                                                                  32620000
326300**** TR# 139012   ALAN MASI   04/20/95                            32630000
326400*                                                                 32640000
326500* ADDED CODE TO ALLOW USG-ID'S TO SORT IN CORRECT ORDER WITH      32650000
326600* NEW USG-ID'S BEING CREATED BY S1000.  THE FIRST TWO DIGITS OF   32660000
326700* THE USG-ID IS NOW GOING TO ROTATE BETWEEN THE VALID VALUES      32670000
326800* ASSIGNED TO A SUPPLIER. THE FIRST TWO DIGITS WILL BE MOVED      32680000
326900* TO THE END OF THE USG-ID GOING INTO THE SORT AND BACK TO THE    32690000
327000* FRONT RETURNING FROM THE SORT.                                  32700000
327100*                                                                 32710000
327200     MOVE SORT-RECORD(1:26) TO WS-CONVERT-USG-ID.                 32720000
327300     MOVE WS-CONV-4 TO WS-CNVTD-1.                                32730000
327400     MOVE WS-CONV-3 TO WS-CNVTD-2.                                32740000
327500     MOVE WS-CONVRTD-USG-ID TO SORT-RECORD(1:26).                 32750000
327600                                                                  32760000
327700     IF NOT-END-OF-SORT                                           32770000
327800         MOVE SORT-RECORD    TO WS-TEMP-SORT-RECORD               32780000
327900         MOVE WS-SORT-RECORD TO SORT-REC-TABLE (SORT-REC-IDX)     32790000
328000         MOVE EMI-RECORD-AR OF SORT-REC-TABLE (SORT-REC-IDX)      32800000
328100           TO EMI-RCD OF TRMSN-ACPTNC-RCD                         32810000
328200         MOVE USG-ID OF I1005LK3 (SORT-REC-IDX)                   32820000
328300                                            TO WS-PRIOR-USG-ID    32830000
328400         EVALUATE EMI-RCD-ID OF SORT-REC-TABLE (SORT-REC-IDX)     32840000
328500             WHEN LT-WRAPUP                                       32850000
328600                  PERFORM 23211-FORMAT-FROM-WRAPUP-RCD            32860000
328700                     THRU 23211-EXIT                              32870000
328800             WHEN LT-015121                                       32880000
328900                  PERFORM A300-DETERMINE-IF-CHK-PNT               32890000
329000                     THRU A300-EXIT                               32900000
329100                  PERFORM 23212-ADD-SUMMARY THRU 23212-EXIT       32910000
329200                  PERFORM 23213-ADD-DETAIL THRU 23213-EXIT        32920000
329300             WHEN LT-202206                                       32930000
329400                  PERFORM A400-RESTART-CHECK-POINT                32940000
329500                     THRU A400-EXIT                               32950000
329600                  MOVE ZEROES TO WS-RCDS-RTRND                    32960000
329700             WHEN OTHER                                           32970000
329800                  PERFORM 23213-ADD-DETAIL THRU 23213-EXIT        32980000
329900         END-EVALUATE                                             32990000
330000     END-IF                                                       33000000
330100     .                                                            33010000
330200 2321-EXIT.                                                       33020000
330300     EXIT.                                                        33030000
330400                                                                  33040000
330500     EJECT                                                        33050000
330600***************************************************************** 33060000
330700*               23211-FORMAT-FROM-WRAPUP-RCD                    * 33070000
330800*                                                               * 33080000
330900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 33090000
331000*    1) PROCESS THE INTERNAL WRAPUP RCD THAT WAS CREATED IN THE * 33100000
331100*       INPUT PROCEDURE AT THE END OF EACH INVOICE.  THESE      * 33110000
331200*       AMOUNTS WERE ACCUMULATED FOR EACH INVOICE.  THEN THE    * 33120000
331300*       RECORD WAS RELEASED TO THE SORT.                        * 33130000
331400*    2) IN THE SORT, THE WRAPUP RCD FLOATS TO THE TOP OF THE    * 33140000
331500*       INVOICE SO THAT THE AMOUNTS CAN BE USED IN THE XZ8USA1T * 33150000
331600*       INSERT.                                                 * 33160000
331700*                                                               * 33170000
331800***************************************************************** 33180000
331900 23211-FORMAT-FROM-WRAPUP-RCD SECTION.                            33190000
332000     MOVE '232B' TO PROG-PAR-NO                                   33200000
332100     MOVE SORT-RECORD            TO WS-SRT-WRAPUP-RCD             33210000
332200     MOVE WS-SRT-USG-ID          TO USG-ID OF XIRI004Y            33220000
332300     MOVE WS-SRT-FED-TX-AMT      TO FED-TX-AMT OF XIRI004Y        33230000
332400     MOVE WS-SRT-SUM-RCD-CRTE-NO TO SUM-RCD-CRTE-NO OF XIRI004Y   33240000
332500     MOVE WS-SRT-RCD-NOT-PRTD-NO TO RCD-NOT-PRTD-NO OF XIRI004Y   33250000
332600     MOVE WS-SRT-LOC-ST-TX-AMT   TO LOC-ST-TX-AMT   OF XIRI004Y   33260000
332700     MOVE WS-SRT-MSG-SURCHG-AMT  TO MSG-SURCHG-AMT  OF XIRI004Y   33270000
332800     SUBTRACT WS-SRT-TOT-TX      FROM WS-SRT-TOT-REV-AMT          33280000
332900       GIVING TOT-EXCL-TX-AMT    OF XIRI004Y                      33290000
333000     MOVE WS-SRT-NXT-BILL-DAT                                     33300000
333100       TO GID-EXPTD-BILL-DAT     OF XIRI004Y                      33310000
333200     MOVE WS-SRT-INIT-ASSN-TMSTMP                                 33320000
333300       TO INIT-ASSN-TMSTMP       OF XIRI004Y                      33330000
333400     MOVE WS-SRT-SPLR-AREA       TO WS-SPLR-AREA                  33340000
333500*** EMER   04/17/96   ALAN MASI                                   33350000
333600*                                                                 33360000
333700* MOVE WRAPUP RECORD CONVERTED MA-BLG-NO TO HLD-CNVTD-MA-BLG-NO   33370000
333800*                                                                 33380000
333900     MOVE WS-SRT-CNVTD-MA-BLG-NO TO HLD-CNVTD-MA-BLG-NO           33390000
334000                                                                  33400000
334100*** R961212           SJWETEK                                     33410000
334200*                                                                 33420000
334300* MOVE INTER, INTRA-LTA-INV-INDR   TO INVOICE                     33430000
334400*                                                                 33440000
334500     MOVE WS-SRT-INTERLTA-INDR TO INTERLTA-INV-INDR OF XIRI004Y   33450000
334600     MOVE WS-SRT-INTRALTA-INDR TO INTRALTA-INV-INDR OF XIRI004Y   33460000
334700      .                                                           33470000
334800 23211-EXIT.                                                      33480000
334900     EXIT.                                                        33490000
335000                                                                  33500000
335100     EJECT                                                        33510000
335200***************************************************************** 33520000
335300*               23212-ADD-SUMMARY                               * 33530000
335400*                                                               * 33540000
335500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 33550000
335600*    1) PROCESS THE MARKET MESSAGES (015121) RETURNED FROM THE  * 33560000
335700*       SORT.                                                   * 33570000
335800*                                                               * 33580000
335900***************************************************************** 33590000
336000 23212-ADD-SUMMARY SECTION.                                       33600000
336100     MOVE '232C' TO PROG-PAR-NO                                   33610000
336200     MOVE EMI-RECORD-AR OF SORT-REC-TABLE (SORT-REC-IDX)          33620000
336300       TO E015121                                                 33630000
336400     IF SUM21-MLTPL-SUM-INDR = +1                                 33640000
336500         PERFORM A500-BUILD-SPLR-UNIQ-INV-FLD THRU A500-EXIT      33650000
336600         PERFORM I100-INSERT-XZ8USA1T THRU I100-EXIT              33660000
336700         ADD +1 TO WS-USA1CNT-CNT                                 33670000
336800**** TR# 138943   ALAN MASI  04/12/95                             33680000
336900*                                                                 33690000
337000* ADDED CODE TO CHECK THAT THE TOT-REV-AMT ON THE USA1 TABLE      33700000
337100* IS EQUAL TO THE SUM OF TOT-EXCL-TX-AMT, FED-TX-AMT,             33710000
337200* LOC-ST-TX-AMT, AND MSG-SURCHG-AMT OF SAME RECORD.               33720000
337300*                                                                 33730000
337400         PERFORM D100-COMPARE-USA1-TOTALS THRU D100-EXIT          33740000
337500                                                                  33750000
337600         IF DUPL                                                  33760000
337700             PERFORM A900-DUPL-PROCESS THRU A900-EXIT             33770000
337800         END-IF                                                   33780000
337900         MOVE ZEROES TO WS-BILL-SEQ-NO                            33790000
338000     END-IF                                                       33800000
338100     .                                                            33810000
338200 23212-EXIT.                                                      33820000
338300     EXIT.                                                        33830000
338400                                                                  33840000
338500     EJECT                                                        33850000
338600***************************************************************** 33860000
338700*               23213-ADD-DETAIL                                * 33870000
338800*                                                               * 33880000
338900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 33890000
339000*    2) PERFORM THE ROUTINE TO INSERT THE RECORD TO XZ8USA2T    * 33900000
339100*       UNLESS WE CREATED IT AND MARKED IT AS NOT USABLE.       * 33910000
339200*                                                               * 33920000
339300***************************************************************** 33930000
339400 23213-ADD-DETAIL SECTION.                                        33940000
339500     MOVE '232D' TO PROG-PAR-NO                                   33950000
339600     IF DUPL                                                      33960000
339700         CONTINUE                                                 33970000
339800     ELSE                                                         33980000
339900         IF NON-SPLR-PROV  (SORT-REC-IDX) AND                     33990000
340000            NOT-USE-RECORD (SORT-REC-IDX)                         34000000
340100             CONTINUE                                             34010000
340200         ELSE                                                     34020000
340300             PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT          34030000
340400         END-IF                                                   34040000
340500     END-IF                                                       34050000
340600     .                                                            34060000
340700 23213-EXIT.                                                      34070000
340800     EXIT.                                                        34080000
340900                                                                  34090000
341000     EJECT                                                        34100000
341100***************************************************************** 34110000
341200*                2400-NON-SORT-PROCESSING                       * 34120000
341300*                                                               * 34130000
341400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 34140000
341500*                                                               * 34150000
341600*       1. PROCESS THE INVOICE RECORDS FOR THE SUPPLIERS THAT   * 34160000
341700*          DON'T REQUIRE THE SORT.                              * 34170000
341800*                                                               * 34180000
341900***************************************************************** 34190000
342000 2400-NON-SORT-PROCESSING SECTION.                                34200000
342100     MOVE '2400' TO PROG-PAR-NO                                   34210000
342200                                                                  34220000
342300     IF ADD-HEADING                                               34230000
342400     AND INSERT-015127-HDG                                        34240000
342500     AND NOT PHR27-RCD                                            34250000
342600                                                                  34260000
342700       MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)              34270000
342800         TO WS-HD-EMI-RECORD-AR                                   34280000
342900       MOVE TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)      34290000
343000         TO WS-HD-PHRASE-TYP                                      34300000
343100       MOVE SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)            34310000
343200         TO WS-HD-SPLR-PROV-INDR                                  34320000
343300       MOVE SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       34330000
343400         TO WS-HD-SPLR-TEXT-INDR                                  34340000
343500                                                                  34350000
343600           PERFORM I20B-ADD-HEADING THRU I20B-EXIT                34360000
343700           VARYING SAV-015127-IDX FROM 1 BY 1                     34370000
343800           UNTIL SAV-BILL-SECT-1-10 (SAV-015127-IDX) EQUAL SPACES 34380000
343900                OR SAV-015127-IDX > LT-1000-NUM                   34390000
344000                                                                  34400000
344100       MOVE WS-HD-EMI-RECORD-AR                                   34410000
344200         TO EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)              34420000
344300       MOVE WS-HD-PHRASE-TYP                                      34430000
344400         TO TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)      34440000
344500       MOVE WS-HD-SPLR-PROV-INDR                                  34450000
344600         TO SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)            34460000
344700       MOVE WS-HD-SPLR-TEXT-INDR                                  34470000
344800         TO SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       34480000
344900                                                                  34490000
345000       SET NO-ADD-HEADING TO TRUE                                 34500000
345100       SET NO-UPDATE-HEADING TO TRUE                              34510000
345200       SET NO-BEFORE-HEADING TO TRUE                              34520000
345300     END-IF                                                       34530000
345400                                                                  34540000
345500     EVALUATE TRUE                                                34550000
345600         WHEN PACK-HDR                                            34560000
345700              PERFORM B100-PACK-HDR THRU B100-EXIT                34570000
345800         WHEN SUM21-RCD                                           34580000
345900              PERFORM B200-SUM21-RCD THRU B200-EXIT               34590000
346000         WHEN SUM22-RCD                                           34600000
346100              PERFORM B300-SUM22-RCD THRU B300-EXIT               34610000
346200         WHEN SUM23-RCD                                           34620000
346300              PERFORM B400-SUM23-RCD THRU B400-EXIT               34630000
346400         WHEN PHR27-RCD                                           34640000
346500              PERFORM B500-PHR27-RCD THRU B500-EXIT               34650000
346600         WHEN MSG81-RCD                                           34660000
346700              PERFORM B600-MSG81-RCD THRU B600-EXIT               34670000
346800         WHEN MSG82-RCD                                           34680000
346900              PERFORM B600-MSG81-RCD THRU B600-EXIT               34690000
347000         WHEN PACK-TRLR                                           34700000
347100              PERFORM B700-PACK-TRLR THRU B700-EXIT               34710000
347200         WHEN OTHER                                               34720000
347300              CONTINUE                                            34730000
347400     END-EVALUATE                                                 34740000
347500     .                                                            34750000
347600 2400-EXIT.                                                       34760000
347700     EXIT.                                                        34770000
347800                                                                  34780000
347900     EJECT                                                        34790000
348000***************************************************************** 34800000
348100*                2500-SPLR-TRLR                                 * 34810000
348200*                                                               * 34820000
348300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 34830000
348400*       1) CHECK FOR MISSING PACK TRAILER RECORD.               * 34840000
348500*       2) CHECK PACK COUNT ON THE SUPPLIER TRAILER RECORD      * 34850000
348600*          AGAINST INTERNAL COUNT OF PACKS WITHIN A SUPPLIER.   * 34860000
348700*       3) WRITE THE REJECTS TRAILER RECORDS.                   * 34870000
348800*       4) SAVE ALL FILE AND VIEW INFORMATION FOR THIS SUPPLIER * 34880000
348900*          IN THE INTERNAL TABLE FOR RUN CONTROLS.              * 34890000
349000*       5) RESET THE FLAGS FOR THE NEXT SUPPLIER.               * 34900000
349100*                                                               * 34910000
349200***************************************************************** 34920000
349300 2500-SPLR-TRLR SECTION.                                          34930000
349400     MOVE '2500' TO PROG-PAR-NO                                   34940000
349500     IF PACK-TRLR-NOT-READ AND WS-INV-IN-RCD-CNT >  +3            34950000
349600         MOVE ERR-3912             TO ERRR-CD OF E1000LK1         34960000
349700         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               34970000
349800     END-IF                                                       34980000
349900     SET SPLR-TRLR-READ            TO TRUE                        34990000
350000     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO E202299M                 35000000
350100     ADD +1                        TO WS-HDR-TRL-CNT              35010000
350200     SET PACK-HDR-NOT-READ         TO TRUE                        35020000
350300     SET SUM21-NOT-READ            TO TRUE                        35030000
350400     SET PHR27-NOT-READ            TO TRUE                        35040000
350500                                                                  35050000
350600     DISPLAY 'TRLR99 REC ID: ' TRLR99-RECORD-ID                   35060000
350700     DISPLAY 'TRLR99 PACK TOT: ' TRLR99-PACK-TOT                  35070000
350800     DISPLAY 'WS PACK TOT: ' WS-PACK-CNT                          35080000
350900                                                                  35090000
351000     IF TRLR99-PACK-TOT = WS-PACK-CNT                             35100000
351100         CONTINUE                                                 35110000
351200     ELSE                                                         35120000
351300         MOVE ERR-3905             TO ERRR-CD OF E1000LK1         35130000
351400         MOVE WS-TRLR-PACK-CT-LTRL TO WS-ERRR-LTRL                35140000
351500         MOVE TRLR99-PACK-TOT      TO WS-ERRR-VAL                 35150000
351600         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF  Z9000LK1 (1)   35160000
351700         MOVE WS-PACK-PRCSS-LTRL   TO WS-ERRR-LTRL                35170000
351800         MOVE WS-PACK-CNT          TO WS-ERRR-VAL                 35180000
351900         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF  Z9000LK1 (2)   35190000
352000         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               35200000
352100     END-IF                                                       35210000
352200     PERFORM 2520-ACCUM-RUN-CNTL-INFO THRU 2520-EXIT              35220000
352300     .                                                            35230000
352400 2500-EXIT.                                                       35240000
352500     EXIT.                                                        35250000
352600                                                                  35260000
352700     EJECT                                                        35270000
352800***************************************************************** 35280000
352900*                2520-ACCUM-RUN-CNTL-INFO                       * 35290000
353000*                                                               * 35300000
353100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 35310000
353200*       1. STORE CONTROLS INFORMATION IN THE SUPPLIER TABLE     * 35320000
353300*          TO BE USED WHEN XIRC4000 IS CALLED.                  * 35330000
353400*       2. RE INITIALIZE ALL OF THE SUPPLIER COUNTERS AND       * 35340000
353500*          THE LINKAGE FOR XIRC4000.                            * 35350000
353600*                                                               * 35360000
353700***************************************************************** 35370000
353800 2520-ACCUM-RUN-CNTL-INFO SECTION.                                35380000
353900     MOVE '2520' TO PROG-PAR-NO                                   35390000
354000     MOVE HDR98-TM-CRTD    TO WS-TIME-4                           35400000
354100     MOVE WS-TIME-4-HH     TO WS-TIME-HH                          35410000
354200     MOVE WS-TIME-4-MM     TO WS-TIME-MM                          35420000
354300     MOVE '00'             TO WS-TIME-SS                          35430000
354400                                                                  35440000
354500     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT                    35450000
354600     SET UPPER-CASE     OF DTFMT TO TRUE                          35460000
354700     SET USER-SPECIFIED OF DTFMT TO TRUE                          35470000
354800     MOVE HDR98-RCNCLN-DAT TO DF-YYMMDD OF DTFMT                  35480000
354900                                                                  35490000
355000     CALL DATETIME USING DTFMT                                    35500000
355100                                                                  35510000
355200     IF FB-ERROR OF DTFMT                                         35520000
355300       MOVE DATETIME-ERR       TO ERRR-CD OF E1000LK1             35530000
355400       MOVE 'DATETIME ERR '    TO WS-ERRR-LTRL                    35540000
355500       MOVE HDR98-RCNCLN-DAT   TO WS-ERRR-VAL                     35550000
355600       MOVE WS-ERRR-DISPL TO                                      35560000
355700                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  35570000
355800       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 35580000
355900     END-IF                                                       35590000
356000                                                                  35600000
356100     MOVE DF-YYYY-MM-DD OF DTFMT TO TB-FIL-HDR-DAT                35610000
356200                                                                  35620000
356300     MOVE WS-TIME-FRMT     TO TB-FIL-HDR-TM                       35630000
356400     MOVE HDR98-INV-NO     TO TB-FIL-HDR-SEQ-NO                   35640000
356500     MOVE LT-Y             TO TB-FIL-HDR-SWITCH                   35650000
356600     ADD WS-INV-IN-SPLR-CNT  TO TB-INV-IN-SPLR-CNT                35660000
356700     ADD WS-XIRI001Y-RCD-FET TO TB-XIRI001Y-RCD-FET               35670000
356800     ADD WS-XIRI002Y-RCD-SEL TO TB-XIRI002Y-RCD-SEL               35680000
356900     ADD WS-XIRI003Y-RCD-INS TO TB-XIRI003Y-RCD-INS               35690000
357000     ADD WS-XIRI004Y-RCD-INS TO TB-XIRI004Y-RCD-INS               35700000
357100     ADD WS-XIRI044Y-RCD-INS TO TB-XIRI044Y-RCD-INS               35710000
357200     ADD WS-XIRI006Y-RCD-SEL TO TB-XIRI006Y-RCD-SEL               35720000
357300     ADD WS-XIRI008Y-RCD-SEL TO TB-XIRI008Y-RCD-SEL               35730000
357400     ADD WS-XIRI013Y-RCD-INS TO TB-XIRI013Y-RCD-INS               35740000
357500     ADD WS-XIRI022Y-RCD-FET TO TB-XIRI022Y-RCD-FET               35750000
357600     ADD WS-XIRI031Y-RCD-FET TO TB-XIRI031Y-RCD-FET               35760000
357700     ADD WS-XIRI040Y-RCD-SEL TO TB-XIRI040Y-RCD-SEL               35770000
357800     ADD WS-XIRI041Y-RCD-SEL TO TB-XIRI041Y-RCD-SEL               35780000
357900     ADD WS-XIRI041Y-RCD-INS TO TB-XIRI041Y-RCD-INS               35790000
358000     ADD WS-XIRI041Y-RCD-UPD TO TB-XIRI041Y-RCD-UPD               35800000
358100     ADD WS-XIRI042Y-RCD-SEL TO TB-XIRI042Y-RCD-SEL               35810000
358200     ADD WS-XIRI042Y-RCD-UPD TO TB-XIRI042Y-RCD-UPD               35820000
358300     ADD WS-XIRI043Y-RCD-UPD TO TB-XIRI043Y-RCD-UPD               35830000
358400     ADD WS-HDR-TRL-CNT      TO TB-HDR-TRL-CNT                    35840000
358500     ADD WS-SUM21-CNT        TO TB-SUM21-CNT                      35850000
358600                                                                  35860000
358700**                                                                35870000
358800*** ADD THE SUBROUTINE RUN CONTROL INFO TO THE SPLR TBL           35880000
358900**                                                                35890000
359000     PERFORM 2521-LOAD-SUBROUTINE-TO-TBL THRU 2521-EXIT           35900000
359100     VARYING RUN-IDX FROM 1 BY 1                                  35910000
359200       UNTIL INPT-OP-DA-NM(RUN-IDX) = SPACES                      35920000
359300          OR RUN-IDX IS GREATER THAN +25                          35930000
359400                                                                  35940000
359500**                                                                35950000
359600*** RE INITIALIZE THE OUT PUT COUNTERS.                           35960000
359700**                                                                35970000
359800     INITIALIZE WS-PACK-CNT                                       35980000
359900                WS-XIRI001Y-RCD-FET                               35990000
360000                WS-XIRI002Y-RCD-SEL                               36000000
360100                WS-XIRI003Y-RCD-INS                               36010000
360200                WS-XIRI004Y-RCD-INS                               36020000
360300                WS-XIRI006Y-RCD-SEL                               36030000
360400                WS-XIRI008Y-RCD-SEL                               36040000
360500                WS-XIRI031Y-RCD-FET                               36050000
360600                WS-XIRI040Y-RCD-SEL                               36060000
360700                WS-XIRI041Y-RCD-SEL                               36070000
360800                WS-XIRI041Y-RCD-INS                               36080000
360900                WS-XIRI041Y-RCD-UPD                               36090000
361000                WS-XIRI042Y-RCD-SEL                               36100000
361100                WS-XIRI042Y-RCD-UPD                               36110000
361200                WS-XIRI043Y-RCD-UPD                               36120000
361300                WS-XIRI044Y-RCD-INS                               36130000
361400                WS-HDR-TRL-CNT                                    36140000
361500                WS-SUM21-CNT                                      36150000
361600                WS-INV-IN-SPLR-CNT                                36160000
361700     .                                                            36170000
361800 2520-EXIT.                                                       36180000
361900     EXIT.                                                        36190000
362000                                                                  36200000
362100     EJECT                                                        36210000
362200***************************************************************** 36220000
362300*                2521-LOAD-SUBROUTINE-TO-TBL                    * 36230000
362400*                                                               * 36240000
362500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 36250000
362600*       1. LOAD THE RUN CONTROL INFORMATION FROM THE            * 36260000
362700*          SUBROUTINES TO THE SUPPLIER TABLE.                   * 36270000
362800*                                                               * 36280000
362900***************************************************************** 36290000
363000 2521-LOAD-SUBROUTINE-TO-TBL SECTION.                             36300000
363100     MOVE '2521' TO PROG-PAR-NO                                   36310000
363200     PERFORM                                                      36320000
363300     VARYING WS-CNTL-IDX FROM 1 BY 1                              36330000
363400       UNTIL TB-INPT-OP-DA-NM (WS-CNTL-IDX) =                     36340000
363500                 INPT-OP-DA-NM(RUN-IDX)                           36350000
363600          OR TB-INPT-OP-DA-NM (WS-CNTL-IDX) = SPACES              36360000
363700     END-PERFORM                                                  36370000
363800     MOVE INPT-OP-DA-NM (RUN-IDX)                                 36380000
363900       TO TB-INPT-OP-DA-NM (WS-CNTL-IDX)                          36390000
364000     ADD RCDS-SELD-NO (RUN-IDX)                                   36400000
364100      TO TB-RCDS-SELD-NO (WS-CNTL-IDX)                            36410000
364200     ADD RCDS-INSRTD-NO (RUN-IDX)                                 36420000
364300      TO TB-RCDS-INSRTD-NO (WS-CNTL-IDX)                          36430000
364400     ADD RCDS-UPDTD-NO (RUN-IDX)                                  36440000
364500      TO TB-RCDS-UPDTD-NO (WS-CNTL-IDX)                           36450000
364600     .                                                            36460000
364700 2521-EXIT.                                                       36470000
364800     EXIT.                                                        36480000
364900                                                                  36490000
365000     EJECT                                                        36500000
365100***************************************************************** 36510000
365200*                2600-NDM-TRLR                                  * 36520000
365300*                                                               * 36530000
365400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 36540000
365500*       1. CHECK FOR MISSING SUPPLIER TRAILER RECORD.           * 36550000
365600*       2. VERIFY THAT THE RECORD COUNT ON THE NDM TRAILER IS   * 36560000
365700*          EQUAL TO THE TOTAL RECORDS READ FROM THE FILE.       * 36570000
365800*       3. CALL A ROUTINE TO INSERT A ROW ON THE TRANSMISSION   * 36580000
365900*          INITIAL ASSOCIATION STATUS TABLE (AUA4).             * 36590000
366000*                                                               * 36600000
366100***************************************************************** 36610000
366200 2600-NDM-TRLR SECTION.                                           36620000
366300     MOVE '2600' TO PROG-PAR-NO                                   36630000
366400     IF SPLR-TRLR-NOT-READ                                        36640000
366500         MOVE ERR-3910   TO ERRR-CD OF E1000LK1                   36650000
366600         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               36660000
366700     END-IF                                                       36670000
366800     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO XRQNDMT                  36680000
366900     SET NDM-TRLR-READ TO TRUE                                    36690000
367000*                                                                 36700000
367100**  SUBTRACT 1 FROM THE TOTAL RECORDS COUNTED SINCE WE DONT       36710000
367200**  WANT TO COUNT THE NDM TRAILER IF THERE ARE CONCATENATED INPUT 36720000
367300**  FILES                                                         36730000
367400*                                                                 36740000
367500     SUBTRACT +1 FROM WS-INV-IN-SPLR-CNT                          36750000
367600     IF XRQT-PK-MSG-CNT NOT = WS-INV-IN-RCD-CNT                   36760000
367700         MOVE ERR-3926            TO ERRR-CD OF E1000LK1          36770000
367800         MOVE WS-NDM-TRLR-CT-LTRL TO WS-ERRR-LTRL                 36780000
367900         MOVE XRQT-PK-MSG-CNT     TO WS-ERRR-VAL                  36790000
368000         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1 (1)    36800000
368100         MOVE WS-TOT-INV-CT-LTRL  TO WS-ERRR-LTRL                 36810000
368200         MOVE WS-INV-IN-RCD-CNT   TO WS-ERRR-VAL                  36820000
368300         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1 (2)    36830000
368400         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               36840000
368500     END-IF                                                       36850000
368600     INITIALIZE WS-INV-IN-RCD-CNT                                 36860000
368700     PERFORM I400-INSERT-XZ4AUA4T THRU I400-EXIT                  36870000
368800     .                                                            36880000
368900 2600-EXIT.                                                       36890000
369000     EXIT.                                                        36900000
369100                                                                  36910000
369200     EJECT                                                        36920000
369300***************************************************************** 36930000
369400*                3000-END-MODULE                                * 36940000
369500*                                                               * 36950000
369600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 36960000
369700*       1. MAKE SURE NDM TRAILER HAS BEEN READ.                 * 36970000
369800*       2. CLOSE FILES                                          * 36980000
369900*       3. UNLOADS THE SUPPLIERS RUN CONTROL TABLE.             * 36990000
370000*       4. CALL THE END OF JOB ROUTINE.                         * 37000000
370100*                                                               * 37010000
370200***************************************************************** 37020000
370300 3000-END-MODULE SECTION.                                         37030000
370400     MOVE '3000' TO PROG-PAR-NO                                   37040000
370500     IF NDM-TRLR-NOT-READ                                         37050000
370600         MOVE ERR-3908 TO ERRR-CD OF E1000LK1                     37060000
370700         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               37070000
370800     END-IF                                                       37080000
370900*                                                                 37090000
371000* CLOSE FILES                                                     37100000
371100*                                                                 37110000
371200     CLOSE FD-I100001I                                            37120000
371300     CLOSE FD-I100004O                                            37130000
371400                                                                  37140000
371500*** 961219-62   ALAN MASI   01/21/97                              37150000
371600*                                                                 37160000
371700* REMOVED LOOP TO UNLOAD SPLR TABLE                               37170000
371800*                                                                 37180000
371900     PERFORM 3100-UNLOAD-SPLR-TABLE THRU 3100-EXIT                37190000
372000     PERFORM 3200-CNTL-END-OF-JOB THRU 3200-EXIT                  37200000
372100     .                                                            37210000
372200 3000-EXIT.                                                       37220000
372300     EXIT.                                                        37230000
372400                                                                  37240000
372500     EJECT                                                        37250000
372600***************************************************************** 37260000
372700*                3100-UNLOAD-SPLR-TABLE                         * 37270000
372800*                                                               * 37280000
372900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 37290000
373000*       1. FORMAT C4000LK1 PROPERLY FOR CURRENT SUPPLIER.       * 37300000
373100*       2. CALL XIRC4000 TO UPDATE RUN CONTROLS(XX4DRA2T)       * 37310000
373200*          FOR EACH SUPPLIER PROCESSED.                         * 37320000
373300*                                                               * 37330000
373400***************************************************************** 37340000
373500 3100-UNLOAD-SPLR-TABLE SECTION.                                  37350000
373600     MOVE '3100' TO PROG-PAR-NO                                   37360000
373700     INITIALIZE C4000LK1.                                         37370000
373800     MOVE WS-APPLCN-RGN-ID      TO APPLCN-RGN-ID    OF C4000LK1   37380000
373900     MOVE WS-APPLCN-LOCN-ID     TO APPLCN-LOCN-ID   OF C4000LK1   37390000
374000     MOVE WS-APPLCN-BLG-GR-ID   TO APPLCN-BLG-GR-ID OF C4000LK1   37400000
374100     MOVE TB-SPLR               TO SPLR-ID          OF C4000LK1   37410000
374200     MOVE LT-REGENTRY           TO FUNC-ID          OF C4000LK1   37420000
374300     MOVE LT-XIRI1000           TO PROG-ID          OF C4000LK1   37430000
374400     MOVE WS-CURR-PRCSS-CY-NO   TO PRCSS-CY-NO      OF C4000LK1   37440000
374500     MOVE WS-TIMESTAMP          TO PROG-STRT-TMSTMP OF C4000LK1   37450000
374600**                                                                37460000
374700***   I100001I                                                    37470000
374800**                                                                37480000
374900     SET RUN-IDX TO +1                                            37490000
375000     MOVE TB-FIL-HDR-DAT     TO FIL-HDR-DAT (RUN-IDX)             37500000
375100     MOVE TB-FIL-HDR-TM      TO FIL-HDR-TM  (RUN-IDX)             37510000
375200     MOVE TB-FIL-HDR-SEQ-NO  TO FIL-HDR-SEQ-NO (RUN-IDX)          37520000
375300     MOVE LT-I100001I        TO INPT-OP-DA-NM (RUN-IDX)           37530000
375400     MOVE TB-INV-IN-SPLR-CNT TO RCDS-RD-NO (RUN-IDX)              37540000
375500**                                                                37550000
375600***   XIRI003Y                                                    37560000
375700**                                                                37570000
375800     SET RUN-IDX UP BY +1                                         37580000
375900     MOVE LT-XIRI003Y       TO INPT-OP-DA-NM (RUN-IDX)            37590000
376000     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            37600000
376100     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            37610000
376200     MOVE TB-XIRI003Y-RCD-INS TO RCDS-INSRTD-NO (RUN-IDX)         37620000
376300**                                                                37630000
376400***   XIRI004Y                                                    37640000
376500**                                                                37650000
376600     SET RUN-IDX UP BY +1                                         37660000
376700     MOVE LT-XIRI004Y       TO INPT-OP-DA-NM (RUN-IDX)            37670000
376800     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            37680000
376900     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            37690000
377000     MOVE TB-XIRI004Y-RCD-INS TO RCDS-INSRTD-NO (RUN-IDX)         37700000
377100**                                                                37710000
377200***   XIRI044Y                                                    37720000
377300**                                                                37730000
377400     SET RUN-IDX UP BY +1                                         37740000
377500     MOVE LT-XIRI044Y       TO INPT-OP-DA-NM (RUN-IDX)            37750000
377600     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            37760000
377700     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            37770000
377800     MOVE TB-XIRI044Y-RCD-INS TO RCDS-INSRTD-NO (RUN-IDX)         37780000
377900**                                                                37790000
378000***   XIRI008Y                                                    37800000
378100**                                                                37810000
378200     SET RUN-IDX UP BY +1                                         37820000
378300     MOVE LT-XIRI008Y       TO INPT-OP-DA-NM (RUN-IDX)            37830000
378400     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            37840000
378500     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            37850000
378600     MOVE TB-XIRI008Y-RCD-SEL TO RCDS-SELD-NO (RUN-IDX)           37860000
378700**                                                                37870000
378800***   HDRTRLCT                                                    37880000
378900**                                                                37890000
379000     SET RUN-IDX UP BY +1                                         37900000
379100     MOVE LT-HDRTRLCT       TO INPT-OP-DA-NM (RUN-IDX)            37910000
379200     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            37920000
379300     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            37930000
379400     MOVE TB-HDR-TRL-CNT    TO RCDS-RD-NO (RUN-IDX)               37940000
379500**                                                                37950000
379600***   SUM21CNT                                                    37960000
379700**                                                                37970000
379800     SET RUN-IDX UP BY +1                                         37980000
379900     MOVE LT-SUM21CNT       TO INPT-OP-DA-NM (RUN-IDX)            37990000
380000     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38000000
380100     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38010000
380200     MOVE TB-SUM21-CNT      TO RCDS-INSRTD-NO (RUN-IDX)           38020000
380300**                                                                38030000
380400***   XIRI031Y                                                    38040000
380500**                                                                38050000
380600     SET RUN-IDX UP BY +1                                         38060000
380700     MOVE LT-XIRI031Y       TO INPT-OP-DA-NM (RUN-IDX)            38070000
380800     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38080000
380900     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38090000
381000     MOVE TB-XIRI031Y-RCD-FET TO RCDS-SELD-NO (RUN-IDX)           38100000
381100**                                                                38110000
381200***   USA1CNT                                                     38120000
381300**                                                                38130000
381400     SET RUN-IDX UP BY +1                                         38140000
381500     MOVE LT-USA1CNT        TO INPT-OP-DA-NM (RUN-IDX)            38150000
381600     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38160000
381700     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38170000
381800     MOVE WS-USA1CNT-CNT    TO RCDS-SELD-NO (RUN-IDX)             38180000
381900**** TR# 138943   ALAN MASI  04/12/95                             38190000
382000*                                                                 38200000
382100* ADDED CODE TO WRITE THE NUMBER OF 3978 ERRORS FOUND TO RUN      38210000
382200* CONTROLS SO THAT UNITECH CAN DETECT THEM AND INFORM THE         38220000
382300* PROGRAMMER OF POSSIBLE PROBLEMS ON THE USA1 TABLE.              38230000
382400*                                                                 38240000
382500**                                                                38250000
382600**                                                                38260000
382700***   OUTABAL                                                     38270000
382800**                                                                38280000
382900     SET RUN-IDX UP BY 1.                                         38290000
383000     MOVE LT-OUTABAL        TO INPT-OP-DA-NM (RUN-IDX).           38300000
383100     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX).           38310000
383200     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX).           38320000
383300     COMPUTE RCDS-INSRTD-NO(RUN-IDX) =                            38330000
383400             WS-OUTABAL-CNT + WS-FI-CNTLS-OUT-BAL                 38340000
383500     END-COMPUTE.                                                 38350000
383600**                                                                38360000
383700***   XIRI040Y                                                    38370000
383800**                                                                38380000
383900     SET RUN-IDX UP BY +1                                         38390000
384000     MOVE LT-XIRI040Y       TO INPT-OP-DA-NM (RUN-IDX)            38400000
384100     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38410000
384200     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38420000
384300     MOVE TB-XIRI040Y-RCD-SEL TO RCDS-SELD-NO (RUN-IDX)           38430000
384400**                                                                38440000
384500***   XIRI041Y                                                    38450000
384600**                                                                38460000
384700     SET RUN-IDX UP BY +1                                         38470000
384800     MOVE LT-XIRI041Y       TO INPT-OP-DA-NM (RUN-IDX)            38480000
384900     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38490000
385000     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38500000
385100     MOVE TB-XIRI041Y-RCD-SEL TO RCDS-SELD-NO (RUN-IDX)           38510000
385200     MOVE TB-XIRI041Y-RCD-INS TO RCDS-INSRTD-NO (RUN-IDX)         38520000
385300     MOVE TB-XIRI041Y-RCD-UPD TO RCDS-UPDTD-NO (RUN-IDX)          38530000
385400**                                                                38540000
385500***   XIRI042Y                                                    38550000
385600**                                                                38560000
385700     SET RUN-IDX UP BY +1                                         38570000
385800     MOVE LT-XIRI042Y       TO INPT-OP-DA-NM (RUN-IDX)            38580000
385900     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38590000
386000     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38600000
386100     MOVE TB-XIRI042Y-RCD-SEL TO RCDS-SELD-NO (RUN-IDX)           38610000
386200     MOVE TB-XIRI042Y-RCD-UPD TO RCDS-UPDTD-NO (RUN-IDX)          38620000
386300**                                                                38630000
386400***   XIRI043Y                                                    38640000
386500**                                                                38650000
386600     SET RUN-IDX UP BY +1                                         38660000
386700     MOVE LT-XIRI043Y       TO INPT-OP-DA-NM (RUN-IDX)            38670000
386800     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38680000
386900     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38690000
387000     MOVE TB-XIRI043Y-RCD-UPD TO RCDS-UPDTD-NO (RUN-IDX)          38700000
387100**                                                                38710000
387200***   INVINCNT                                                    38720000
387300**                                                                38730000
387400     SET RUN-IDX UP BY +1                                         38740000
387500     MOVE LT-INVINCNT       TO INPT-OP-DA-NM (RUN-IDX)            38750000
387600     MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM    (RUN-IDX)            38760000
387700     MOVE WS-TIMESTAMP-DAT  TO FIL-HDR-DAT   (RUN-IDX)            38770000
387800     MOVE WS-INVINCNT-CNT   TO RCDS-SELD-NO (RUN-IDX)             38780000
387900                                                                  38790000
388000     SET RUN-IDX UP BY +1                                         38800000
388100     PERFORM                                                      38810000
388200       VARYING WS-CNTL-IDX FROM 1 BY 1                            38820000
388300       UNTIL TB-INPT-OP-DA-NM (WS-CNTL-IDX) = SPACES              38830000
388400          OR WS-CNTL-IDX IS GREATER THAN +6                       38840000
388500             MOVE TB-INPT-OP-DA-NM (WS-CNTL-IDX)                  38850000
388600               TO INPT-OP-DA-NM (RUN-IDX)                         38860000
388700             MOVE TB-RCDS-INSRTD-NO (WS-CNTL-IDX)                 38870000
388800               TO RCDS-INSRTD-NO (RUN-IDX)                        38880000
388900             MOVE TB-RCDS-UPDTD-NO (WS-CNTL-IDX)                  38890000
389000               TO RCDS-UPDTD-NO (RUN-IDX)                         38900000
389100             MOVE TB-RCDS-SELD-NO (WS-CNTL-IDX)                   38910000
389200               TO RCDS-SELD-NO (RUN-IDX)                          38920000
389300             MOVE WS-TIMESTAMP-TIME TO FIL-HDR-TM (RUN-IDX)       38930000
389400             MOVE WS-TIMESTAMP-DAT TO FIL-HDR-DAT (RUN-IDX)       38940000
389500             SET RUN-IDX UP BY +1                                 38950000
389600     END-PERFORM                                                  38960000
389700**                                                                38970000
389800***   CHECK IF SUPPLIER HAS BEEN PROCESSED, IF SO CALL XIRC4000.  38980000
389900**                                                                38990000
390000     IF TB-SPLR-PROCESSED                                         39000000
390100         PERFORM 3110-END-SPLR THRU 3110-EXIT                     39010000
390200     END-IF                                                       39020000
390300**                                                                39030000
390400***   INIT C4000LK1 FOR NEXT SUPPLIER                             39040000
390500**                                                                39050000
390600     PERFORM                                                      39060000
390700     VARYING RUN-IDX FROM 1 BY 1                                  39070000
390800       UNTIL RUN-IDX = +25                                        39080000
390900         INITIALIZE FIL-DTL OF C4000LK1 (RUN-IDX)                 39090000
391000     END-PERFORM                                                  39100000
391100     .                                                            39110000
391200 3100-EXIT.                                                       39120000
391300     EXIT.                                                        39130000
391400                                                                  39140000
391500     EJECT                                                        39150000
391600***************************************************************** 39160000
391700*                3110-END-SPLR                                  * 39170000
391800*                                                               * 39180000
391900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 39190000
392000*       1. CALL THE UPDATE CONTROLS MODULE.                     * 39200000
392100*                                                               * 39210000
392200***************************************************************** 39220000
392300 3110-END-SPLR SECTION.                                           39230000
392400     MOVE '3110' TO PROG-PAR-NO                                   39240000
392500     CALL LT-XIRC4000 USING C4000LK1                              39250000
392600                                                                  39260000
392700     MOVE RTRN-CD OF C4000LK1 TO LT-ALPHA-RETURN-CODES            39270000
392800     EVALUATE LT-ALPHA-RETURN-CODES                               39280000
392900         WHEN LT-SUCCESSFUL                                       39290000
393000              CONTINUE                                            39300000
393100         WHEN OTHER                                               39310000
393200              MOVE RTRN-CD OF C4000LK1 TO ERRR-CD OF E1000LK1     39320000
393300              MOVE CMMN-SQLCA OF C4000LK1 TO                      39330000
393400                   CMMN-SQLCA OF Z9000LK1                         39340000
393500              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          39350000
393600     END-EVALUATE                                                 39360000
393700     .                                                            39370000
393800 3110-EXIT.                                                       39380000
393900     EXIT.                                                        39390000
394000                                                                  39400000
394100     EJECT                                                        39410000
394200***************************************************************** 39420000
394300*                3200-CNTL-END-OF-JOB                           * 39430000
394400*                                                               * 39440000
394500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 39450000
394600*       1. CALL THE END OF JOB CONTROLS MODULE.                 * 39460000
394700*                                                               * 39470000
394800***************************************************************** 39480000
394900 3200-CNTL-END-OF-JOB SECTION.                                    39490000
395000     MOVE '3200' TO PROG-PAR-NO                                   39500000
395100     MOVE LT-XIRI1000         TO PROG-ID          OF C5000LK1     39510000
395200     MOVE LT-REGENTRY         TO FUNC-ID          OF C5000LK1     39520000
395300     MOVE WS-TIMESTAMP        TO PROG-STRT-TMSTMP OF C5000LK1     39530000
395400     MOVE WS-CURR-PRCSS-CY-NO TO PRCSS-CY-NO      OF C5000LK1     39540000
395500     MOVE WS-APPLCN-RGN-ID    TO APPLCN-RGN-ID    OF C5000LK1     39550000
395600     MOVE WS-APPLCN-LOCN-ID   TO APPLCN-LOCN-ID   OF C5000LK1     39560000
395700     MOVE WS-APPLCN-BLG-GR-ID TO APPLCN-BLG-GR-ID OF C5000LK1     39570000
395800                                                                  39580000
395900     CALL LT-XIRC5000 USING C5000LK1                              39590000
396000                                                                  39600000
396100     MOVE RTRN-CD OF C5000LK1 TO LT-ALPHA-RETURN-CODES            39610000
396200     EVALUATE LT-ALPHA-RETURN-CODES                               39620000
396300        WHEN LT-SUCCESSFUL                                        39630000
396400           CONTINUE                                               39640000
396500        WHEN OTHER                                                39650000
396600           MOVE RTRN-CD OF C5000LK1 TO ERRR-CD OF E1000LK1        39660000
396700           MOVE CMMN-SQLCA OF C5000LK1 TO CMMN-SQLCA OF Z9000LK1  39670000
396800           PERFORM E100-PROCESS-ERRORS THRU E100-EXIT             39680000
396900     END-EVALUATE                                                 39690000
397000     .                                                            39700000
397100 3200-EXIT.                                                       39710000
397200     EXIT.                                                        39720000
397300                                                                  39730000
397400     EJECT                                                        39740000
397500***************************************************************** 39750000
397600*                A100-CHECK-SET-SEQ                             * 39760000
397700*                                                               * 39770000
397800*    THIS PARAGRAPH WILL ASSURE THAT EACH INVOICE SET CONSISTS  * 39780000
397900*    OF RECORDS WITH THE SAME USG-ID AND ASCENDING USG-SEQ-NO   * 39790000
398000*    BEGINNING WITH ONE.                                        * 39800000
398100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 39810000
398200*       1. CHECK IF THE USG-ID EQUALS THE PREVIOUS USG-ID.      * 39820000
398300*        - IF IT DOESN'T, THE RECORD MUST BE A MARKET SUMMARY   * 39830000
398400*          AND THE SEQUENCE NUMBER MUST BE ONE; OTHERWISE       * 39840000
398500*          ERRORS IS CALLED.                                    * 39850000
398600*        - IF IT DOES, THE SEQUENCE NUMBER MUST BE ONE GREATER  * 39860000
398700*          THAN THE PREVIOUS SEQUENCE NUMBER AND THE RECORD     * 39870000
398800*          MUST NOT BE A MARKET SUMMARY RECORD; OTHERWISE       * 39880000
398900*          ERRORS IS CALLED.                                    * 39890000
399000*                                                               * 39900000
399100***************************************************************** 39910000
399200 A100-CHECK-SET-SEQ SECTION.                                      39920000
399300     MOVE 'A100' TO PROG-PAR-NO                                   39930000
399400     IF USG-ID OF TRMSN-ACPTNC-RCD = WS-PREV-USG-ID               39940000
399500         IF USG-SEQ-NO OF TRMSN-ACPTNC-RCD =                      39950000
399600                          WS-PREV-USG-SEQ-NO + +1                 39960000
399700             IF SUM21-RCD                                         39970000
399800                 IF SUM21-MLTPL-SUM-INDR IS GREATER THAN +1       39980000
399900                     MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD          39990000
400000                       TO WS-PREV-USG-SEQ-NO                      40000000
400100                 ELSE                                             40010000
400200                     MOVE USG-ID OF TRMSN-ACPTNC-RCD              40020000
400300                       TO WS-ERRR-USG-ID                          40030000
400400                     MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD          40040000
400500                       TO WS-3913-USG-SEQ                         40050000
400600                     MOVE +1 TO WS-3913-SEQ-NXT                   40060000
400700                     MOVE WS-USG-ID-ERRR TO ERRR-DISPL-FLDS (1)   40070000
400800                     MOVE WS-3913-MSG-2 TO ERRR-DISPL-FLDS (2)    40080000
400900                     MOVE WS-3913-MSG-3 TO ERRR-DISPL-FLDS (3)    40090000
401000                     MOVE ERR-3913 TO ERRR-CD OF E1000LK1         40100000
401100                     PERFORM E100-PROCESS-ERRORS THRU E100-EXIT   40110000
401200                 END-IF                                           40120000
401300             ELSE                                                 40130000
401400                 MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD              40140000
401500                   TO WS-PREV-USG-SEQ-NO                          40150000
401600             END-IF                                               40160000
401700         ELSE                                                     40170000
401800             MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-ERRR-USG-ID    40180000
401900             MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                  40190000
402000               TO WS-3913-USG-SEQ                                 40200000
402100             MOVE WS-PREV-USG-SEQ-NO TO WS-3913-SEQ-NXT           40210000
402200             ADD +1 TO WS-3913-SEQ-NXT                            40220000
402300             MOVE WS-USG-ID-ERRR TO ERRR-DISPL-FLDS (1)           40230000
402400             MOVE WS-3913-MSG-2 TO ERRR-DISPL-FLDS (2)            40240000
402500             MOVE WS-3913-MSG-3 TO ERRR-DISPL-FLDS (3)            40250000
402600             MOVE ERR-3913 TO ERRR-CD OF E1000LK1                 40260000
402700             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           40270000
402800         END-IF                                                   40280000
402900     ELSE                                                         40290000
403000         IF SUM21-RCD                                             40300000
403100             IF SUM21-MLTPL-SUM-INDR IS EQUAL TO +1               40310000
403200                 IF USG-SEQ-NO OF TRMSN-ACPTNC-RCD = +1           40320000
403300                    CONTINUE                                      40330000
403400                 ELSE                                             40340000
403500                     MOVE USG-ID OF TRMSN-ACPTNC-RCD              40350000
403600                       TO WS-ERRR-USG-ID                          40360000
403700                     MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD          40370000
403800                       TO WS-3913-USG-SEQ                         40380000
403900                     MOVE +1 TO WS-3913-SEQ-NXT                   40390000
404000                     MOVE WS-USG-ID-ERRR TO ERRR-DISPL-FLDS (1)   40400000
404100                     MOVE WS-3913-MSG-2 TO ERRR-DISPL-FLDS (2)    40410000
404200                     MOVE WS-3913-MSG-3 TO ERRR-DISPL-FLDS (3)    40420000
404300                     MOVE ERR-3913 TO ERRR-CD OF E1000LK1         40430000
404400                     PERFORM E100-PROCESS-ERRORS THRU E100-EXIT   40440000
404500                 END-IF                                           40450000
404600             ELSE                                                 40460000
404700                 MOVE USG-ID OF TRMSN-ACPTNC-RCD                  40470000
404800                   TO WS-ERRR-USG-ID                              40480000
404900                 MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD              40490000
405000                   TO WS-3913-USG-SEQ                             40500000
405100                 MOVE +1 TO WS-3913-SEQ-NXT                       40510000
405200                 MOVE WS-USG-ID-ERRR TO ERRR-DISPL-FLDS (1)       40520000
405300                 MOVE WS-3913-MSG-2 TO ERRR-DISPL-FLDS (2)        40530000
405400                 MOVE WS-3913-MSG-3 TO ERRR-DISPL-FLDS (3)        40540000
405500                 MOVE ERR-3913 TO ERRR-CD OF E1000LK1             40550000
405600                 PERFORM E100-PROCESS-ERRORS THRU E100-EXIT       40560000
405700             END-IF                                               40570000
405800         ELSE                                                     40580000
405900             MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-ERRR-USG-ID    40590000
406000             MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                  40600000
406100               TO WS-3913-USG-SEQ                                 40610000
406200             MOVE +1 TO WS-3913-SEQ-NXT                           40620000
406300             MOVE WS-USG-ID-ERRR TO ERRR-DISPL-FLDS (1)           40630000
406400             MOVE WS-3913-MSG-2 TO ERRR-DISPL-FLDS (2)            40640000
406500             MOVE WS-3913-MSG-3 TO ERRR-DISPL-FLDS (3)            40650000
406600             MOVE ERR-3902 TO ERRR-CD OF E1000LK1                 40660000
406700             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           40670000
406800         END-IF                                                   40680000
406900     END-IF.                                                      40690000
407000                                                                  40700000
407100     PERFORM C500-CALL-XIRZB000                                   40710000
407200        THRU C500-EXIT.                                           40720000
407300                                                                  40730000
407400 A100-EXIT.                                                       40740000
407500     EXIT.                                                        40750000
407600                                                                  40760000
407700     EJECT                                                        40770000
407800***************************************************************** 40780000
407900*                A300-DETERMINE-IF-CHK-PNT                      * 40790000
408000*                                                               * 40800000
408100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 40810000
408200*      1) DETERMINE IF CHECK POINT BASED ON THE NUMBER OF       * 40820000
408300*         RECORDS READ OR THE NUMBER OF RECORDS RETURNED FROM   * 40830000
408400*         THE SORT.                                             * 40840000
408500*                                                               * 40850000
408600***************************************************************** 40860000
408700 A300-DETERMINE-IF-CHK-PNT SECTION.                               40870000
408800     MOVE 'A300' TO PROG-PAR-NO                                   40880000
408900     EVALUATE TRUE                                                40890000
409000         WHEN TB-SORT-INPUT                                       40900000
409100            IF WS-RCDS-RTRND > WS-PROG-CMMT-FREQ                  40910000
409200                MOVE ZERO TO WS-RCDS-RTRND                        40920000
409300                MOVE WS-TOT-IN-FILE-CNT TO WS-TEMP-CNT            40930000
409400                MOVE WS-SORT-RCD-IN-CNT TO WS-TOT-IN-FILE-CNT     40940000
409500                MOVE SPACES             TO WS-PREV-USG-ID         40950000
409600                PERFORM A400-RESTART-CHECK-POINT THRU A400-EXIT   40960000
409700                MOVE WS-TEMP-CNT        TO WS-TOT-IN-FILE-CNT     40970000
409800            END-IF                                                40980000
409900         WHEN OTHER                                               40990000
410000            ADD +1 TO WS-RESTART-IN-CNT                           41000000
410100            IF WS-RESTART-IN-CNT > WS-PROG-CMMT-FREQ AND SUM21-RCD41010000
410200              MOVE ZERO TO WS-RESTART-IN-CNT                      41020000
410300              PERFORM A400-RESTART-CHECK-POINT THRU A400-EXIT     41030000
410400            END-IF                                                41040000
410500     END-EVALUATE                                                 41050000
410600     .                                                            41060000
410700 A300-EXIT.                                                       41070000
410800     EXIT.                                                        41080000
410900                                                                  41090000
411000     EJECT                                                        41100000
411100***************************************************************** 41110000
411200*                A400-RESTART-CHECK-POINT                       * 41120000
411300*                                                               * 41130000
411400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 41140000
411500*       1) MOVE ALL RESTART SAVE AREAS TO THE LINKAGE AREA      * 41150000
411600*          FOR CO90.                                            * 41160000
411700*       2) CALL THE RESTART ROUTINE.                            * 41170000
411800*                                                               * 41180000
411900***************************************************************** 41190000
412000 A400-RESTART-CHECK-POINT SECTION.                                41200000
412100     MOVE 'A400' TO PROG-PAR-NO                                   41210000
412200     MOVE SPLR-INFO-AR          TO RS-SPLR-INFO-AR                41220000
412300     MOVE XIRI002Y              TO RS-XIRI002Y                    41230000
412400     MOVE XRQNDMH               TO RS-XRQNDMH                     41240000
412500     MOVE E202298M              TO RS-E202298M                    41250000
412600     MOVE E202205M              TO RS-E202205M                    41260000
412700     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO RS-RESTART-HOLD-EMI-RCD  41270000
412800     MOVE WS-FIRST-RESTART-500  TO RESTART-WS-DATA-RCD (01)       41280000
412900     MOVE WS-SECOND-RESTART-500 TO RESTART-WS-DATA-RCD (02)       41290000
413000     MOVE WS-THIRD-RESTART-500  TO RESTART-WS-DATA-RCD (03)       41300000
413100     MOVE WS-FOURTH-RESTART-500 TO RESTART-WS-DATA-RCD (04)       41310000
413200     MOVE WS-5TH-RESTART-500    TO RESTART-WS-DATA-RCD (05)       41320000
413300     MOVE WS-6TH-RESTART-500    TO RESTART-WS-DATA-RCD (06)       41330000
413400     MOVE WS-7TH-RESTART-500    TO RESTART-WS-DATA-RCD (07)       41340000
413500                                                                  41350000
413600     MOVE 7                     TO RESTART-DATA-STRG-QTY          41360000
413700     SET UPDATE-RQST            TO TRUE                           41370000
413800     SET COMMIT-RQST            TO TRUE                           41380000
413900                                                                  41390000
414000     CALL LT-CO900AA0 USING CO90KY0C                              41400000
414100     .                                                            41410000
414200 A400-EXIT.                                                       41420000
414300     EXIT.                                                        41430000
414400                                                                  41440000
414500     EJECT                                                        41450000
414600***************************************************************** 41460000
414700*                A500-BUILD-SPLR-UNIQ-INV-FLD                   * 41470000
414800*                                                               * 41480000
414900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 41490000
415000*    1. GET THE UNIQUE KEY FIELDS FROM THE DATA DICTIONARY -    * 41500000
415100*       DATA DICTIONARY RECORDS TABLE JOIN FOR THE CURRENT      * 41510000
415200*       SUPPLIER. (DSE3 AND DSE8)                               * 41520000
415300*    2. USING OFSETS AND LENGTHS THE VALUE OF THESE FIELDS      * 41530000
415400*       ARE MOVED INTO THE XZ8USA1T UNIQUE KEY FIELD FROM THE   * 41540000
415500*       015121 RECORD.                                          * 41550000
415600*                                                               * 41560000
415700***************************************************************** 41570000
415800 A500-BUILD-SPLR-UNIQ-INV-FLD SECTION.                            41580000
415900     MOVE 'A500' TO PROG-PAR-NO                                   41590000
416000     INITIALIZE WS-SPLR-UNIQ-INV-LEN                              41600000
416100     MOVE SPACES               TO WS-SPLR-UNIQ-INV-DA             41610000
416200     MOVE WS-CURR-SPLR         TO WS-SPLR-UNIQ-INV-DA (1:6)       41620000
416300     ADD +6                    TO WS-SPLR-UNIQ-INV-LEN            41630000
416400                                                                  41640000
416500     PERFORM                                                      41650000
416600       VARYING WS-DD-IDX FROM 1 BY 1                              41660000
416700       UNTIL WS-REF-ELEM-NM (WS-DD-IDX) = SPACES                  41670000
416800          OR WS-DD-IDX = LT-DATA-DICT-TBL-SZ                      41680000
416900        COMPUTE WS-POSITION = WS-SPLR-UNIQ-INV-LEN + 1            41690000
417000        MOVE EMI-RCD OF TRMSN-ACPTNC-RCD                          41700000
417100             (WS-POS-NO(WS-DD-IDX):WS-LNGTH-NO(WS-DD-IDX))        41710000
417200        TO WS-SPLR-UNIQ-INV-DA(WS-POSITION:WS-LNGTH-NO(WS-DD-IDX))41720000
417300        ADD WS-LNGTH-NO (WS-DD-IDX) TO WS-SPLR-UNIQ-INV-LEN       41730000
417400     END-PERFORM                                                  41740000
417500     .                                                            41750000
417600 A500-EXIT.                                                       41760000
417700     EXIT.                                                        41770000
417800                                                                  41780000
417900     EJECT                                                        41790000
418000***************************************************************** 41800000
418100*                A600-CHECK-II-CNTLS                            * 41810000
418200*                                                               * 41820000
418300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 41830000
418400*    1) VERIFY THAT THE NUMBER OF PRINTABLE RECORDS ON USA2 FOR * 41840000
418500*       A PARTICULAR INVOICE EQUALS THE TOTAL SUMMARY RECORDS   * 41850000
418600*       + THE TOTAL MESSAGES + THE RECORDS CREATED - THE        * 41860000
418700*       RECORDS NOT PRINTED VALUES FROM Z8USA1.  IF OUT OF      * 41870000
418800*       BALANCE, POST A WARNING ERROR UNLESS THE THRESHOLD IS   * 41880000
418900*       REACHED, THEN POST A SEVERE ERROR.                      * 41890000
419000*                                                               * 41900000
419100***************************************************************** 41910000
419200 A600-CHECK-II-CNTLS SECTION.                                     41920000
419300     MOVE 'A600' TO PROG-PAR-NO                                   41930000
419400     EVALUATE TRUE                                                41940000
419500         WHEN TB-SORT-INPUT                                       41950000
419600             MOVE WS-SUM-RCD-CRTE-NO          TO WS-RECS-CRTD     41960000
419700             MOVE WS-RCD-NOT-PRTD-NO          TO WS-RECS-NOT-PRTD 41970000
419800         WHEN TB-NOT-SORT-INPUT                                   41980000
419900             MOVE WS-SUM-RCD-CRTE-NO          TO WS-RECS-CRTD     41990000
420000             MOVE WS-RCD-NOT-PRTD-NO          TO WS-RECS-NOT-PRTD 42000000
420100     END-EVALUATE                                                 42010000
420200                                                                  42020000
420300     IF (WS-TOT-SUM-RECS + WS-TOT-MSG-NO + WS-RECS-CRTD           42030000
420400         - WS-RECS-NOT-PRTD) = WS-USA2-PRNTBLE-RECS               42040000
420500        CONTINUE                                                  42050000
420600     ELSE                                                         42060000
420700        MOVE ERR-3976    TO ERRR-CD OF E1000LK1                   42070000
420800        MOVE SPACES      TO VW-NM   OF Z9000LK1                   42080000
420900                            ERRR-DA OF E1000LK1                   42090000
421000                            MDLE-ID OF Z9000LK1                   42100000
421100        SET DO-NOT-DISPLAY-STD-MSGS TO TRUE                       42110000
421200        MOVE LT-USA2-PRNTBLE-RECS TO WS-ERRR-LTRL                 42120000
421300        MOVE WS-USA2-PRNTBLE-RECS TO WS-ERRR-VAL                  42130000
421400        MOVE WS-ERRR-DISPL TO                                     42140000
421500             ERRR-DISPL-FLDS OF  Z9000LK1 (1)                     42150000
421600        MOVE LT-TOT-SUM-RECS      TO WS-ERRR-LTRL                 42160000
421700        MOVE WS-TOT-SUM-RECS      TO WS-ERRR-VAL                  42170000
421800        MOVE WS-ERRR-DISPL TO                                     42180000
421900             ERRR-DISPL-FLDS OF  Z9000LK1 (2)                     42190000
422000        MOVE LT-TOT-MSG-NO        TO WS-ERRR-LTRL                 42200000
422100        MOVE WS-TOT-MSG-NO        TO WS-ERRR-VAL                  42210000
422200        MOVE WS-ERRR-DISPL TO                                     42220000
422300             ERRR-DISPL-FLDS OF  Z9000LK1 (3)                     42230000
422400        MOVE LT-RECS-CRTD         TO WS-ERRR-LTRL                 42240000
422500        MOVE WS-RECS-CRTD         TO WS-ERRR-VAL                  42250000
422600        MOVE WS-ERRR-DISPL TO                                     42260000
422700             ERRR-DISPL-FLDS OF  Z9000LK1 (4)                     42270000
422800        MOVE LT-RECS-NOT-PRTD     TO WS-ERRR-LTRL                 42280000
422900        MOVE WS-RECS-NOT-PRTD     TO WS-ERRR-VAL                  42290000
423000        MOVE WS-ERRR-DISPL TO                                     42300000
423100             ERRR-DISPL-FLDS OF  Z9000LK1 (5)                     42310000
423200        EVALUATE TRUE                                             42320000
423300           WHEN TB-SORT-INPUT                                     42330000
423400              MOVE WS-PRIOR-USG-ID TO WS-ERRR-USG-ID              42340000
423500           WHEN TB-NOT-SORT-INPUT                                 42350000
423600              MOVE WS-PREV-USG-ID  TO WS-ERRR-USG-ID              42360000
423700        END-EVALUATE                                              42370000
423800        MOVE WS-USG-ID-ERRR     TO ERRR-DISPL-FLDS OF Z9000LK1(6) 42380000
423900        MOVE WS-II-CNTLS-ERRR-1 TO ERRR-DISPL-FLDS OF Z9000LK1(7) 42390000
424000        MOVE WS-II-CNTLS-ERRR-2 TO ERRR-DISPL-FLDS OF Z9000LK1(8) 42400000
424100        PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                42410000
424200     END-IF                                                       42420000
424300     INITIALIZE WS-INV-REC-COUNTERS                               42430000
424400     .                                                            42440000
424500 A600-EXIT.                                                       42450000
424600     EXIT.                                                        42460000
424700                                                                  42470000
424800     EJECT                                                        42480000
424900***************************************************************** 42490000
425000*                A800-DETERMINE-BILL-SEC-CD                     * 42500000
425100*                                                               * 42510000
425200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 42520000
425300*       1) LOAD THE WORKING-STORAGE SECTION IN TO THE           * 42530000
425400*          LINKAGE AREA FOR XIRI1010.                           * 42540000
425500*       2) CALL XIRI1010 TO GET THE BILL SECTION CODES.         * 42550000
425600*                                                               * 42560000
425700***************************************************************** 42570000
425800 A800-DETERMINE-BILL-SEC-CD SECTION.                              42580000
425900     MOVE 'A800' TO PROG-PAR-NO                                   42590000
426000     MOVE TB-SPLR TO SPLR-ID OF I1010LK1                          42600000
426100     MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD TO USG-SEQ-NO OF I1010LK142610000
426200                                            WS-LAST-USG-SEQ-NO    42620000
426300     MOVE USG-ID OF TRMSN-ACPTNC-RCD TO USG-ID OF I1010LK1        42630000
426400     MOVE RESTART-PROG-RETRY-NO TO RETRY-NO OF I1010LK1           42640000
426500     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO RCD-AR OF I1010LK1       42650000
426600                                                                  42660000
426700     CALL 'XIRI1010' USING I1010LK1, I1005LK3, Z9000LK1           42670000
426800                                                                  42680000
426900     EVALUATE TRUE                                                42690000
427000         WHEN LK-NORMAL-RETURN OF I1010LK1                        42700000
427100             MOVE USG-ID OF TRMSN-ACPTNC-RCD                      42710000
427200               TO USG-ID OF I1005LK3(1)                           42720000
427300         WHEN OTHER                                               42730000
427400              MOVE ERRR-CD OF Z9000LK1 TO ERRR-CD OF E1000LK1     42740000
427500              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          42750000
427600     END-EVALUATE                                                 42760000
427700     .                                                            42770000
427800 A800-EXIT.                                                       42780000
427900     EXIT.                                                        42790000
428000                                                                  42800000
428100     EJECT                                                        42810000
428200***************************************************************** 42820000
428300*                A900-DUPL-PROCESS                              * 42830000
428400*                                                               * 42840000
428500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 42850000
428600*       1) SELECT THE 015121 RECORD OFF XZ8USA1T THAT CAUSED    * 42860000
428700*          THE DUPLICATE INSERT, AND LOG A NOT-FATAL ERROR.     * 42870000
428800*       2) FORMAT THE SUPPLIER UNIQUE INVOICE FIELD WITH THE    * 42880000
428900*          USG ID, AND INSERT THE RECORD ON XZ8USA1T.           * 42890000
429000*                                                               * 42900000
429100***************************************************************** 42910000
429200 A900-DUPL-PROCESS SECTION.                                       42920000
429300* TR XXXXX BEN GOMEZ DUPLICATE INVOICE USG-ID                     42930000
429400     IF RESTART-PROG-RETRY-NO = WS-RETRY-CNT                      42940000
429500         MOVE 'A900' TO PROG-PAR-NO                               42950000
429600         PERFORM A910-SELECT-DUPL THRU A910-EXIT                  42960000
429700**BGN TR #154223  KGE 10/30/95                                    42970000
429800         MOVE ERR-8001 TO ERRR-CD OF E1000LK1                     42980000
429900**END TR #154223  KGE 10/30/95                                    42990000
430000         MOVE SPACES TO WS-SPLR-UNIQ-INV-DA                       43000000
430100         EVALUATE TRUE                                            43010000
430200             WHEN TB-SORT-INPUT                                   43020000
430300                  MOVE USG-ID OF SORT-REC-TABLE (SORT-REC-IDX)    43030000
430400                    TO WS-SPLR-UNIQ-INV-DA                        43040000
430500                       TRNSCTN-ID OF E1000LK1                     43050000
430600                 DISPLAY 'DUPLICATE USG-ID = '                    43060000
430700                   USG-ID OF SORT-REC-TABLE (SORT-REC-IDX)        43070000
430800             WHEN OTHER                                           43080000
430900                  MOVE USG-ID OF TRMSN-ACPTNC-RCD                 43090000
431000                    TO WS-SPLR-UNIQ-INV-DA                        43100000
431100                       TRNSCTN-ID OF E1000LK1                     43110000
431200                 DISPLAY 'DUPLICATE USG-ID = '                    43120000
431300                   USG-ID OF TRMSN-ACPTNC-RCD                     43130000
431400         END-EVALUATE                                             43140000
431500         MOVE +1 TO TRNSCTN-SEQ-NO OF E1000LK1                    43150000
431600         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               43160000
431700         MOVE SPACES       TO TRNSCTN-ID OF E1000LK1              43170000
431800         MOVE ZEROES       TO TRNSCTN-SEQ-NO OF E1000LK1          43180000
431900         PERFORM I100-INSERT-XZ8USA1T THRU I100-EXIT              43190000
432000     ELSE                                                         43200000
432100         EVALUATE TRUE                                            43210000
432200             WHEN TB-SORT-INPUT                                   43220000
432300                  MOVE USG-ID OF XIRI004Y                         43230000
432400                    TO USG-ID OF SORT-REC-TABLE (SORT-REC-IDX)    43240000
432500                       WS-CURR-USG-ID                             43250000
432600             WHEN OTHER                                           43260000
432700                  MOVE USG-ID OF XIRI004Y                         43270000
432800                    TO USG-ID OF TRMSN-ACPTNC-RCD                 43280000
432900                       WS-CURR-USG-ID                             43290000
433000         END-EVALUATE                                             43300000
433100     END-IF                                                       43310000
433200     .                                                            43320000
433300 A900-EXIT.                                                       43330000
433400     EXIT.                                                        43340000
433500                                                                  43350000
433600     EJECT                                                        43360000
433700***************************************************************** 43370000
433800*                A910-SELECT-DUPL                               * 43380000
433900*                                                               * 43390000
434000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 43400000
434100*     1. SELECT FROM XZ8USA1T BY THE UNIQUE INVOICE FIELD WHICH * 43410000
434200*        WAS USED IN THE PREVIOUSLY ATTEMPTED INSERT.  THIS     * 43420000
434300*        WILL PRODUCE THE INVOICE THAT CAUSED THE DUPLICATE.    * 43430000
434400*                                                               * 43440000
434500***************************************************************** 43450000
434600 A910-SELECT-DUPL SECTION.                                        43460000
434700     MOVE 'A910' TO PROG-PAR-NO                                   43470000
434800                                                                  43480000
434900     MOVE WS-SPLR-UNIQ-INV-DA TO SPLR-UNIQ-INV-DA OF XIRI008Y     43490000
435000                                                                  43500000
435100     INITIALIZE WS-RETRY-CNT                                      43510000
435200     SET LOCKED-OUT  TO TRUE                                      43520000
435300     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           43530000
435400          OR NOT LOCKED                                           43540000
435500        EXEC SQL                                                  43550000
435600            INCLUDE XIRI08S1                                      43560000
435700        END-EXEC                                                  43570000
435800        ADD +1       TO WS-RETRY-CNT                              43580000
435900        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         43590000
436000     END-PERFORM                                                  43600000
436100                                                                  43610000
436200     EVALUATE SQLCODE                                             43620000
436300         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             43630000
436400             MOVE USG-ID OF XIRI008Y TO ERRR-DA OF E1000LK1       43640000
436500         WHEN OTHER                                               43650000
436600             MOVE ERR-3923          TO ERRR-CD     OF E1000LK1    43660000
436700             MOVE LT-XIRI008Y       TO VW-NM       OF Z9000LK1    43670000
436800             MOVE SQLCA             TO SQLCA-AR    OF Z9000LK1    43680000
436900             SET ERRR-IDX           TO +1                         43690000
437000             MOVE WS-USA1T-ERRR-MSG TO ERRR-DISPL-FLDS (ERRR-IDX) 43700000
437100             SET ERRR-IDX             UP BY +1                    43710000
437200             MOVE LT-SPLR-UNIQ-INV-DA TO WS-ERRR-LTRL             43720000
437300             MOVE SPLR-UNIQ-INV-DA OF XIRI008Y TO WS-ERRR-VAL     43730000
437400             MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS (ERRR-IDX)     43740000
437500             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           43750000
437600     END-EVALUATE                                                 43760000
437700     .                                                            43770000
437800 A910-EXIT.                                                       43780000
437900     EXIT.                                                        43790000
438000                                                                  43800000
438100     EJECT                                                        43810000
438200***************************************************************** 43820000
438300*                B100-PACK-HDR                                  * 43830000
438400*                                                               * 43840000
438500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 43850000
438600*       1. CHECK FOR MISSING SUPPLIER HEADER RECORD.            * 43860000
438700*       2. INCREMENT THE COUNTER FOR PACKS WITHIN A SUPPLIER.   * 43870000
438800*                                                               * 43880000
438900***************************************************************** 43890000
439000 B100-PACK-HDR SECTION.                                           43900000
439100     MOVE 'B100' TO PROG-PAR-NO                                   43910000
439200     IF SPLR-HDR-NOT-READ                                         43920000
439300         MOVE ERR-3909 TO ERRR-CD OF E1000LK1                     43930000
439400         MOVE TB-SPLR    TO WS-CURR-SPLR                          43940000
439500         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               43950000
439600     END-IF                                                       43960000
439700     MOVE TRMSN-ID     OF TRMSN-ACPTNC-RCD TO WS-TRMSN-ID         43970000
439800     MOVE TRMSN-SEQ-NO OF TRMSN-ACPTNC-RCD TO WS-TRMSN-SEQ-NO     43980000
439900     MOVE PACK-ID      OF TRMSN-ACPTNC-RCD TO WS-PACK-ID          43990000
440000     MOVE PACK-SEQ-NO  OF TRMSN-ACPTNC-RCD TO WS-PACK-SEQ-NO      44000000
440100     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO E202205M                 44010000
440200     MOVE HDR05-FIL-TYP-INDR        TO WS-SAVE-FIL-TYP-INDR       44020000
440300     MOVE HDR05-PACK-TYP TO WS-PACK-TYPE                          44030000
440400     IF FIRST-TIME-IN-PACK-HDR                                    44040000
440500          PERFORM S800-LOAD-DATA-DICT-TBL THRU S800-EXIT          44050000
440600     END-IF                                                       44060000
440700     SET NOT-FIRST-TIME-IN-PACK-HDR TO TRUE                       44070000
440800     SET PACK-HDR-READ              TO TRUE                       44080000
440900     ADD +1                         TO WS-PACK-CNT                44090000
441000     ADD +1                         TO WS-HDR-TRL-CNT             44100000
441100     .                                                            44110000
441200 B100-EXIT.                                                       44120000
441300     EXIT.                                                        44130000
441400                                                                  44140000
441500     EJECT                                                        44150000
441600***************************************************************** 44160000
441700*                B200-SUM21-RCD                                 * 44170000
441800*                                                               * 44180000
441900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 44190000
442000*       1) CHECK FOR MISSING PACK HEADER RECORD.                * 44200000
442100*       2) CALL ROUTINE TO WRAP UP THE PREVIOUS INVOICE.        * 44210000
442200*       3) CALL ROUTINE TO CHECK II CONTROLS.                   * 44220000
442300*       4) CALL ROUTINE TO EITHER BUILD THE TAX RECORD OR       * 44230000
442400*          UPDATE THE PREVIOUS INVOICE.                         * 44240000
442500*       5) CALL ROUTINE TO CHECK INVOICE SEQUENCE.              * 44250000
442600*       6) CALL A ROUTINE TO PROCESS BORDER POINT AND RAO.      * 44260000
442700*       7) CALL ROUTINE TO EITHER RELEASE RECORD TO SORT OR     * 44270000
442800*          INSERT RECORD TO XZ8USA1T                            * 44280000
442900*                                                               * 44290000
443000***************************************************************** 44300000
443100 B200-SUM21-RCD SECTION.                                          44310000
443200     MOVE 'B200' TO PROG-PAR-NO                                   44320000
443300*** 950203-70   ALAN MASI  10/11/95 R960509                       44330000
443400*                                                                 44340000
443500* INITALIZE DISCOUNT, TIMEBANK, CASHBACK, AND OCC COUNTERS        44350000
443600* MOVE SPACES TO IND-015122, AND IND-015123 BY SETTING IND-       44360000
443700* 015122-RESET AND IND-015123-RESET TO TRUE.                      44370000
443800*                                                                 44380000
443900     MOVE ZEROES TO TIMEBANK-CNT                                  44390000
444000                    CASHBACK-CNT                                  44400000
444100                    DISCOUNT-CNT                                  44410000
444200                    OCC-CNT                                       44420000
444300                                                                  44430000
444400     SET IND-015122-RESET TO TRUE                                 44440000
444500     SET IND-015123-RESET TO TRUE                                 44450000
444600                                                                  44460000
444700     IF PACK-HDR-NOT-READ                                         44470000
444800         MOVE ERR-3911 TO ERRR-CD OF E1000LK1                     44480000
444900         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               44490000
445000     END-IF                                                       44500000
445100                                                                  44510000
445200     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD   TO E015121                44520000
445300                                                                  44530000
445400     IF FIRST-TIME-015121                                         44540000
445500         MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO WS-SAVE-E015121      44550000
445600         SET NOT-FIRST-TIME-015121      TO TRUE                   44560000
445700     END-IF                                                       44570000
445800                                                                  44580000
445900     IF SUM21-MLTPL-SUM-INDR EQUAL TO +1                          44590000
446000         IF TB-SORT-INPUT AND NOT-FIRST-RSTRT-PACK                44600000
446100            ADD +1 TO WS-INVINCNT-CNT                             44610000
446200         END-IF                                                   44620000
446300         MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO WS-HOLD-E015121      44630000
446400         MOVE WS-SAVE-E015121           TO E015121                44640000
446500         MOVE NO-OF-SUM-RCDS-WITHIN-INV TO WS-TOT-SUM-RECS        44650000
446600         MOVE SUM21-TOT-MSG             TO WS-TOT-MSG-NO          44660000
446700         MOVE WS-SAVE-E015121           TO EMI-RCD-AR OF I1005LK1 44670000
446800         PERFORM B800-FINISH-PREV-INVOICE THRU B800-EXIT          44680000
446900         MOVE WS-HOLD-E015121           TO E015121                44690000
447000         MOVE WS-HOLD-E015121           TO WS-SAVE-E015121        44700000
447100         MOVE WS-HOLD-E015121           TO EMI-RCD-AR OF I1005LK1 44710000
447200     END-IF                                                       44720000
447300                                                                  44730000
447400     IF FIRST-015121-IN-PACK                                      44740000
447500         MOVE SUM21-TOT-REV             TO WS-TOT-REV             44750000
447600         SET NOT-FIRST-015121-IN-PACK   TO TRUE                   44760000
447700     ELSE                                                         44770000
447800         PERFORM A600-CHECK-II-CNTLS THRU A600-EXIT               44780000
447900         EVALUATE TRUE                                            44790000
448000             WHEN TB-SORT-INPUT                                   44800000
448100***      B900-CREATE-WRAP-UP-RCD IS TO CLEAN UP PREVIOUS ACCOUNT  44810000
448200                  PERFORM B900-CREATE-WRAP-UP-RCD THRU B900-EXIT  44820000
448300             WHEN TB-NOT-SORT-INPUT                               44830000
448400                  PERFORM U100-UPDATE-XZ8USA1T THRU U100-EXIT     44840000
448500                  MOVE SUM21-TOT-REV TO WS-TOT-REV                44850000
448600         END-EVALUATE                                             44860000
448700         INITIALIZE WS-FED-TX-AMT                                 44870000
448800                    WS-LOC-ST-TX-AMT                              44880000
448900                    WS-MSG-SURCHG-AMT                             44890000
449000                    WS-TOT-TX                                     44900000
449100                    WS-SUM-RCD-CRTE-NO                            44910000
449200                    WS-RCD-NOT-PRTD-NO                            44920000
449300     END-IF                                                       44930000
449400                                                                  44940000
449500     SET FIRST-81-RECORD TO TRUE                                  44950000
449600     SET NOT-CARD-ONLY   TO TRUE                                  44960000
449700                                                                  44970000
449800***  R961212 SJWETEK    09/17/96                                  44980000
449900*                                                                 44990000
450000*    INITIALIZE INTER, INTRALTA FLDS FOR EACH NEW INVOICE         45000000
450100*                                                                 45010000
450200         MOVE LT-N                      TO WS-INTERLTA-INV-INDR   45020000
450300         MOVE LT-N                      TO WS-INTRALTA-INV-INDR   45030000
450400                                                                  45040000
450500     SET SUM21-READ TO TRUE                                       45050000
450600     PERFORM A100-CHECK-SET-SEQ THRU A100-EXIT                    45060000
450700                                                                  45070000
450800     IF SUM21-MLTPL-SUM-INDR EQUAL TO +1                          45080000
450900        PERFORM B210-DO-NPA-SPLIT THRU B210-EXIT                  45090000
451000        MOVE LT-DFLT-TMSTMP TO INIT-ASSN-TMSTMP   OF XIRI004Y     45100000
451100        MOVE LT-DFLT-DAT    TO GID-EXPTD-BILL-DAT OF XIRI004Y     45110000
451200     END-IF                                                       45120000
451300     EVALUATE TRUE                                                45130000
451400         WHEN TB-SORT-INPUT                                       45140000
451500             PERFORM B220-RLSE-SUM21 THRU B220-EXIT               45150000
451600         WHEN OTHER                                               45160000
451700             IF SUM21-MLTPL-SUM-INDR = +1                         45170000
451800                 MOVE ZEROES TO WS-BILL-SEQ-NO                    45180000
451900                 PERFORM B230-LOAD-SUM21 THRU B230-EXIT           45190000
452000             END-IF                                               45200000
452100     END-EVALUATE                                                 45210000
452200                                                                  45220000
452300     IF WS-DUPLICATE-USG-ID > SPACES                              45230000
452400        MOVE WS-DUPLICATE-USG-ID TO WS-PRIOR-USG-ID               45240000
452500     ELSE                                                         45250000
452600        MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-PRIOR-USG-ID        45260000
452700     END-IF                                                       45270000
452800*                                                                 45280000
452900* WIJAYA ADDING HEADING CHECK FOR 015121 RECORDS                  45290000
453000*                                                                 45300000
453100     IF INSERT-015127-HDG AND TB-NOT-SORT-INPUT                   45310000
453200       EVALUATE TRUE                                              45320000
453300       WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = 'HD'      45330000
453400         MOVE 'HD' TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)   45340000
453500         SET WS-HDG-3 TO TRUE                                     45350000
453600       WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = 'HD'      45360000
453700         MOVE 'HD' TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)   45370000
453800         SET WS-HDG-4 TO TRUE                                     45380000
453900       WHEN SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) = 'HD'      45390000
454000         MOVE 'HD' TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)   45400000
454100         SET WS-HDG-5 TO TRUE                                     45410000
454200       WHEN OTHER                                                 45420000
454300         SET WS-HDG-NO TO TRUE                                    45430000
454400       END-EVALUATE                                               45440000
454500                                                                  45450000
454600       IF WS-HDG-NO                                               45460000
454700           CONTINUE                                               45470000
454800       ELSE                                                       45480000
454900          PERFORM I20A-CREATE-HEADING THRU I20A-EXIT              45490000
455000       END-IF                                                     45500000
455100     END-IF                                                       45510000
455200                                                                  45520000
455300     .                                                            45530000
455400 B200-EXIT.                                                       45540000
455500     EXIT.                                                        45550000
455600                                                                  45560000
455700     EJECT                                                        45570000
455800***************************************************************** 45580000
455900*                B210-DO-NPA-SPLIT                              * 45590000
456000*                                                               * 45600000
456100*    THIS PARAGRAPH CALLS THE NPA CONVERSION ROUTINE ONCE OR    * 45610000
456200*    TWICE DEPENDING ON THE MASTER BILLING NUMBER VALUE.        * 45620000
456300*                                                               * 45630000
456400***************************************************************** 45640000
456500 B210-DO-NPA-SPLIT SECTION.                                       45650000
456600***  EMER   ALAN MASI   03/18/96                                  45660000
456700*                                                                 45670000
456800* CHANGED PARA TO DO BORDER POINT BEFORE NPA CONVERSION           45680000
456900* AND STORE OFF CONVERTED MA-BLG-NO SO THE CONVERTED ONE          45690000
457000* CAN BE MOVED TO XZ8USA1T.                                       45700000
457100*                                                                 45710000
457200     MOVE 'B211' TO PROG-PAR-NO                                   45720000
457300     MOVE WS-CURR-SPLR TO SPLR-ID OF C4000LK1                     45730000
457400     IF SUM21-MA-BLG-NO IS EQUAL TO ZEROES                        45740000
457500        MOVE SUM21-MA-BLG-NO TO HLD-CNVTD-MA-BLG-NO               45750000
457600     ELSE                                                         45760000
457700*                                                                 45770000
457800* CONVERT SUM21-MA-BLG-NO                                         45780000
457900*                                                                 45790000
458000        MOVE SUM21-MA-BLG-NO TO WS-SPLR-AREA                      45800000
458100        IF TRNSLT-BDR-PT-INDR = LT-Y                              45810000
458200           PERFORM B212-SEARCH-RAO THRU B212-EXIT                 45820000
458300        END-IF                                                    45830000
458400        MOVE WS-SPLR-AREA TO OLD-PHN-NO OF Z1100LK1               45840000
458500        PERFORM B211-CALL-NPA-CONV THRU B211-EXIT                 45850000
458600        MOVE WS-SPLR-AREA TO HLD-CNVTD-MA-BLG-NO                  45860000
458700     END-IF                                                       45870000
458800*                                                                 45880000
458900* CONVERT SUM21-BLG-NO                                            45890000
459000*                                                                 45900000
459100     MOVE SUM21-BLG-NO TO WS-SPLR-AREA                            45910000
459200     IF TRNSLT-BDR-PT-INDR = LT-Y                                 45920000
459300        PERFORM B212-SEARCH-RAO THRU B212-EXIT                    45930000
459400     END-IF                                                       45940000
459500     MOVE WS-SPLR-AREA TO OLD-PHN-NO OF Z1100LK1                  45950000
459600     PERFORM B211-CALL-NPA-CONV THRU B211-EXIT                    45960000
459700     .                                                            45970000
459800 B210-EXIT.                                                       45980000
459900     EXIT.                                                        45990000
460000                                                                  46000000
460100     EJECT                                                        46010000
460200***************************************************************** 46020000
460300*               B211-CALL-NPA-CONV                              * 46030000
460400*                                                               * 46040000
460500*    THIS PARAGRAPH CALLS THE NPA CONVERSION MODULE.  THIS      * 46050000
460600*    MODULE WILL BE RESPONSIBLE FOR CONVERTING TELEPHONE        * 46060000
460700*    NUMBERS THAT CARRIERS SEND IN, TO A NEW NPA VALUE, IF THE  * 46070000
460800*    TELEPHONE NUMBER WAS IDENTIFIED TO BE A PHONE NUMBER THAT  * 46080000
460900*    EXISTS IN A CONVERTED PREFIX AREA.                         * 46090000
461000*                                                               * 46100000
461100***************************************************************** 46110000
461200 B211-CALL-NPA-CONV SECTION.                                      46120000
461300     MOVE 'B211' TO PROG-PAR-NO                                   46130000
461400     MOVE WS-CURR-PRCSS-CY-DAT TO PRCSS-CY-DAT   OF Z1100LK1      46140000
461500     MOVE WS-APPLCN-LOCN-ID    TO APPLCN-LOCN-ID OF Z1100LK1      46150000
461600                                                                  46160000
461700     CALL LT-XIRZ1100 USING Z1100LK1                              46170000
461800                                                                  46180000
461900     MOVE RTRN-CD OF Z1100LK1 TO LT-ALPHA-RETURN-CODES            46190000
462000     EVALUATE LT-ALPHA-RETURN-CODES                               46200000
462100         WHEN LT-SUCCESSFUL                                       46210000
462200              MOVE NEW-PHN-NO OF Z1100LK1 TO WS-SPLR-AREA         46220000
462300         WHEN OTHER                                               46230000
462400              MOVE RTRN-CD OF Z1100LK1 TO ERRR-CD OF E1000LK1     46240000
462500              MOVE SQLCA-AR OF Z1100LK1 TO CMMN-SQLCA OF Z9000LK1 46250000
462600              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          46260000
462700     END-EVALUATE                                                 46270000
462800     .                                                            46280000
462900 B211-EXIT.                                                       46290000
463000     EXIT.                                                        46300000
463100                                                                  46310000
463200     EJECT                                                        46320000
463300***************************************************************** 46330000
463400*                B212-SEARCH-RAO                                * 46340000
463500*                                                               * 46350000
463600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 46360000
463700*       1. ATTEMPTS TO MATCH THE RAO FROM THE INVOICE TO A RAO  * 46370000
463800*          ON THE INTERNAL RAO TABLE.  THIS IS A BORDER POINT   * 46380000
463900*          SITUATION WHICH INVOLVES SWITCHING THE NPA OF THE    * 46390000
464000*          BILLING NUMBER WITH THE NPA FROM THE RAO TABLE.      * 46400000
464100*       2. CALLS THE ERRORS ROUTINE INDICATING THAT THE RAO WAS * 46410000
464200*          NOT FOUND ON THE INTERNAL RAO TABLE.                 * 46420000
464300*                                                               * 46430000
464400***************************************************************** 46440000
464500 B212-SEARCH-RAO SECTION.                                         46450000
464600     MOVE 'B212' TO PROG-PAR-NO                                   46460000
464700     PERFORM                                                      46470000
464800     VARYING WS-RAO-IDX FROM 1 BY 1                               46480000
464900       UNTIL BILL-RAO OF TRMSN-ACPTNC-RCD                         46490000
465000              = WS-RVN-ACCTG-OFC-CD(WS-RAO-IDX)                   46500000
465100          OR    WS-RVN-ACCTG-OFC-CD(WS-RAO-IDX) = SPACES          46510000
465200          OR WS-RAO-IDX > LT-100-NUM                              46520000
465300     END-PERFORM                                                  46530000
465400     IF WS-RVN-ACCTG-OFC-CD(WS-RAO-IDX) = SPACES                  46540000
465500     OR WS-RAO-IDX > LT-100-NUM                                   46550000
465600         MOVE ERR-3925                     TO ERRR-CD OF E1000LK1 46560000
465700         MOVE WS-BILL-RAO-LTRL             TO WS-ERRR-LTRL        46570000
465800         MOVE BILL-RAO OF TRMSN-ACPTNC-RCD TO WS-ERRR-VAL         46580000
465900         MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1 (1)    46590000
466000         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               46600000
466100     ELSE                                                         46610000
466200         MOVE WS-NO-PL-AR-ID (WS-RAO-IDX)  TO WS-NPA              46620000
466300     END-IF                                                       46630000
466400     .                                                            46640000
466500 B212-EXIT.                                                       46650000
466600     EXIT.                                                        46660000
466700                                                                  46670000
466800     EJECT                                                        46680000
466900***************************************************************** 46690000
467000*                B220-RLSE-SUM21                                * 46700000
467100*                                                               * 46710000
467200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 46720000
467300*       1) PASS THE MARKET MESSAGE (015121) TO THE BUILD AND    * 46730000
467400*          SORT INVOICES MODULE.                                * 46740000
467500*       2) CALL ROUTINE TO RELEASE THE RECORD TO THE SORT.      * 46750000
467600*                                                               * 46760000
467700***************************************************************** 46770000
467800 B220-RLSE-SUM21 SECTION.                                         46780000
467900     MOVE 'B220' TO PROG-PAR-NO                                   46790000
468000     ADD +1                           TO WS-PACK-IN-RCD-CNT       46800000
468100     IF SUM21-MLTPL-SUM-INDR = +1                                 46810000
468200         SET NEW-INVOICE              TO TRUE                     46820000
468300     ELSE                                                         46830000
468400         SET CONTINUE-INVOICE-PROCESS TO TRUE                     46840000
468500     END-IF                                                       46850000
468600     PERFORM C200-CALL-XIRI1005 THRU C200-EXIT                    46860000
468700     PERFORM C300-UNLD-TBL THRU C300-EXIT                         46870000
468800       VARYING SORT-REC-IDX FROM 1 BY 1                           46880000
468900       UNTIL SORT-REC-IDX > CNTR-SRT-REC-TBL-ENTRIES              46890000
469000          OR SORT-REC-IDX > LT-1000-NUM                           46900000
469100          OR CNTR-SRT-REC-TBL-ENTRIES = ZEROS                     46910000
469200     SET SORT-REC-IDX                 TO +1                       46920000
469300     .                                                            46930000
469400 B220-EXIT.                                                       46940000
469500     EXIT.                                                        46950000
469600                                                                  46960000
469700     EJECT                                                        46970000
469800***************************************************************** 46980000
469900*                B230-LOAD-SUM21                                * 46990000
470000*                                                               * 47000000
470100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 47010000
470200*       1. CALL A ROUTINE TO BUILD THE UNIQUE KEY FIELD         * 47020000
470300*          FOR XZ8USA1T                                         * 47030000
470400*       2. CALL A ROUTINE TO INSERT THE RECORD TO XZ8USA1T.     * 47040000
470500*       3. CALL A ROUTINE TO FIND THE RECORD WHICH CAUSED A     * 47050000
470600*          DUPLICATE INSERT ERROR.                              * 47060000
470700*       4. CALL A ROUTINE TO GET THE BILL SECTION CODES.        * 47070000
470800*       5. CALL A ROUTINE TO INSERT THE RECORD TO XZ8USA2T.     * 47080000
470900*                                                               * 47090000
471000***************************************************************** 47100000
471100 B230-LOAD-SUM21 SECTION.                                         47110000
471200     MOVE 'B230' TO PROG-PAR-NO                                   47120000
471300     ADD +1 TO WS-PACK-IN-RCD-CNT                                 47130000
471400***  R961212 SJWETEK    09/17/96                                  47140000
471500*                                                                 47150000
471600*    INITIALIZE INTER, INTRALTA FLDS                              47160000
471700*                                                                 47170000
471800     MOVE LT-N                TO INTERLTA-INV-INDR OF XIRI004Y    47180000
471900     MOVE LT-N                TO INTRALTA-INV-INDR OF XIRI004Y    47190000
472000     SET INSERT-USA7          TO TRUE                             47200000
472100                                                                  47210000
472200     PERFORM A500-BUILD-SPLR-UNIQ-INV-FLD THRU A500-EXIT          47220000
472300     PERFORM I100-INSERT-XZ8USA1T THRU I100-EXIT                  47230000
472400                                                                  47240000
472500     IF DUPL                                                      47250000
472600         PERFORM A900-DUPL-PROCESS THRU A900-EXIT                 47260000
472700     END-IF                                                       47270000
472800                                                                  47280000
472900     PERFORM A800-DETERMINE-BILL-SEC-CD THRU A800-EXIT            47290000
473000     PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT                  47300000
473100     ADD +1 TO WS-SUM21-CNT                                       47310000
473200     .                                                            47320000
473300 B230-EXIT.                                                       47330000
473400     EXIT.                                                        47340000
473500                                                                  47350000
473600     EJECT                                                        47360000
473700***************************************************************** 47370000
473800*                B300-SUM22-RCD                                 * 47380000
473900*                                                               * 47390000
474000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 47400000
474100*       1) CALL ROUTINE TO CHECK INVOICE SET SEQUENCE           * 47410000
474200*       2) INSERT RECORD ON XZ8USA2T OR RELEASE TO SORT         * 47420000
474300*                                                               * 47430000
474400***************************************************************** 47440000
474500 B300-SUM22-RCD SECTION.                                          47450000
474600     MOVE 'B300' TO PROG-PAR-NO                                   47460000
474700*** 950203-70   ALAN MASI  10/11/95 R960509                       47470000
474800*                                                                 47480000
474900* IF IND-015122-RESET THEN THIS IS THE FIRST 015122 RECORD        47490000
475000* IF FIRST-015122-REC IS TRUE THEN IT IS NOT THE FIRST RECORD     47500000
475100* THIS CHECK IS NEEDED BECAUSE SPRINT CAN SEND UP TO NINE         47510000
475200* 015122 AND 015123 RECORDS AND CERTAIN THINGS LIKE TAXES         47520000
475300* ARE ONLY DONE FOR THE FIRST RECORD.                             47530000
475400*                                                                 47540000
475500     IF NOT-FIRST-015122-REC                                      47550000
475600        CONTINUE                                                  47560000
475700     ELSE                                                         47570000
475800        IF IND-015122-RESET                                       47580000
475900           SET FIRST-015122-REC TO TRUE                           47590000
476000        ELSE                                                      47600000
476100           IF FIRST-015122-REC                                    47610000
476200              SET NOT-FIRST-015122-REC TO TRUE                    47620000
476300           END-IF                                                 47630000
476400        END-IF                                                    47640000
476500     END-IF                                                       47650000
476600     PERFORM A100-CHECK-SET-SEQ THRU A100-EXIT                    47660000
476700     ADD +1 TO WS-PACK-IN-RCD-CNT                                 47670000
476800     IF DUPL                                                      47680000
476900        CONTINUE                                                  47690000
477000     ELSE                                                         47700000
477100        EVALUATE TRUE                                             47710000
477200           WHEN TB-SORT-INPUT                                     47720000
477300              SET CONTINUE-INVOICE-PROCESS TO TRUE                47730000
477400              PERFORM C200-CALL-XIRI1005 THRU C200-EXIT           47740000
477500              PERFORM C300-UNLD-TBL THRU C300-EXIT                47750000
477600                VARYING SORT-REC-IDX FROM 1 BY 1                  47760000
477700                UNTIL SORT-REC-IDX IS GREATER THAN                47770000
477800                      CNTR-SRT-REC-TBL-ENTRIES                    47780000
477900                   OR SORT-REC-IDX > LT-1000-NUM                  47790000
478000                   OR CNTR-SRT-REC-TBL-ENTRIES = ZEROES           47800000
478100              SET SORT-REC-IDX TO +1                              47810000
478200           WHEN OTHER                                             47820000
478300              PERFORM A800-DETERMINE-BILL-SEC-CD THRU A800-EXIT   47830000
478400              PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT         47840000
478500        END-EVALUATE                                              47850000
478600        PERFORM                                                   47860000
478700          VARYING SORT-REC-IDX FROM 1 BY 1                        47870000
478800          UNTIL SORT-REC-IDX IS GREATER THAN                      47880000
478900                CNTR-SRT-REC-TBL-ENTRIES                          47890000
479000             OR SORT-REC-IDX IS GREATER THAN LT-1000-NUM          47900000
479100             OR CNTR-SRT-REC-TBL-ENTRIES IS EQUAL TO              47910000
479200                ZEROES                                            47920000
479300           IF NON-SPLR-PROV (SORT-REC-IDX)                        47930000
479400              ADD +1 TO WS-SUM-RCD-CRTE-NO                        47940000
479500           END-IF                                                 47950000
479600           IF NOT-USE-RECORD (SORT-REC-IDX)                       47960000
479700              ADD +1 TO WS-RCD-NOT-PRTD-NO                        47970000
479800           END-IF                                                 47980000
479900        END-PERFORM                                               47990000
480000        SET SORT-REC-IDX TO +1                                    48000000
480100     END-IF                                                       48010000
480200     .                                                            48020000
480300 B300-EXIT.                                                       48030000
480400     EXIT.                                                        48040000
480500                                                                  48050000
480600     EJECT                                                        48060000
480700***************************************************************** 48070000
480800*                B400-SUM23-RCD                                 * 48080000
480900*                                                               * 48090000
481000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 48100000
481100*       1) CALL A ROUTINE TO CHECK THE INVOICE SET SEQUENCE     * 48110000
481200*       2) INSERT RECORD TO XZ8USA2T OR RELEASE TO SORT         * 48120000
481300*                                                               * 48130000
481400***************************************************************** 48140000
481500 B400-SUM23-RCD SECTION.                                          48150000
481600     MOVE 'B400' TO PROG-PAR-NO                                   48160000
481700*** 950203-70   ALAN MASI  10/11/95 R960509                       48170000
481800*                                                                 48180000
481900* IF IND-015123-RESET THEN THIS IS THE FIRST 015123 RECORD        48190000
482000* IF FIRST-015123-REC IS TRUE THEN IT IS NOT THE FIRST RECORD     48200000
482100* THIS CHECK IS NEEDED BECAUSE SPRINT CAN SEND UP TO NINE         48210000
482200* 015122 AND 015123 RECORDS AND CERTAIN THINGS LIKE TAXES         48220000
482300* ARE ONLY DONE FOR THE FIRST RECORD.                             48230000
482400*                                                                 48240000
482500     IF NOT-FIRST-015123-REC                                      48250000
482600        CONTINUE                                                  48260000
482700     ELSE                                                         48270000
482800        IF IND-015123-RESET                                       48280000
482900           SET FIRST-015123-REC TO TRUE                           48290000
483000        ELSE                                                      48300000
483100           IF FIRST-015123-REC                                    48310000
483200              SET NOT-FIRST-015123-REC TO TRUE                    48320000
483300           END-IF                                                 48330000
483400        END-IF                                                    48340000
483500     END-IF                                                       48350000
483600     PERFORM A100-CHECK-SET-SEQ THRU A100-EXIT                    48360000
483700     ADD +1 TO WS-PACK-IN-RCD-CNT                                 48370000
483800     IF DUPL                                                      48380000
483900        CONTINUE                                                  48390000
484000     ELSE                                                         48400000
484100        EVALUATE TRUE                                             48410000
484200           WHEN TB-SORT-INPUT                                     48420000
484300              SET CONTINUE-INVOICE-PROCESS TO TRUE                48430000
484400              PERFORM C200-CALL-XIRI1005 THRU C200-EXIT           48440000
484500              PERFORM C300-UNLD-TBL THRU C300-EXIT                48450000
484600                VARYING SORT-REC-IDX FROM 1 BY 1                  48460000
484700                UNTIL SORT-REC-IDX IS GREATER THAN                48470000
484800                      CNTR-SRT-REC-TBL-ENTRIES                    48480000
484900                   OR SORT-REC-IDX > LT-1000-NUM                  48490000
485000                   OR CNTR-SRT-REC-TBL-ENTRIES = ZEROES           48500000
485100              SET SORT-REC-IDX TO +1                              48510000
485200           WHEN OTHER                                             48520000
485300              PERFORM A800-DETERMINE-BILL-SEC-CD THRU A800-EXIT   48530000
485400              PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT         48540000
485500        END-EVALUATE                                              48550000
485600                                                                  48560000
485700        PERFORM                                                   48570000
485800         VARYING SORT-REC-IDX FROM 1 BY 1                         48580000
485900           UNTIL SORT-REC-IDX IS GREATER THAN                     48590000
486000                 CNTR-SRT-REC-TBL-ENTRIES                         48600000
486100              OR SORT-REC-IDX > LT-1000-NUM                       48610000
486200              OR CNTR-SRT-REC-TBL-ENTRIES = ZEROES                48620000
486300            IF NON-SPLR-PROV (SORT-REC-IDX)                       48630000
486400               ADD +1 TO WS-SUM-RCD-CRTE-NO                       48640000
486500            END-IF                                                48650000
486600            IF NOT-USE-RECORD (SORT-REC-IDX)                      48660000
486700               ADD +1 TO WS-RCD-NOT-PRTD-NO                       48670000
486800            END-IF                                                48680000
486900        END-PERFORM                                               48690000
487000        SET SORT-REC-IDX TO +1                                    48700000
487100     END-IF                                                       48710000
487200     .                                                            48720000
487300 B400-EXIT.                                                       48730000
487400     EXIT.                                                        48740000
487500                                                                  48750000
487600     EJECT                                                        48760000
487700***************************************************************** 48770000
487800*                B500-PHR27-RCD                                 * 48780000
487900*                                                               * 48790000
488000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 48800000
488100*       1. CHECK FOR MISSING MARKET SUMMARY RECORD.             * 48810000
488200*       2. CALL A ROUTINE TO VALIDATE THE INVOICE SEQUENCE.     * 48820000
488300*       3. IF INCREMENT TAX AMOUNTS WHEN TAX RECORD IS FOUND.   * 48830000
488400*       4. RELEASE RECORD TO THE SORT OR INSERT TO XZ8USA2T     * 48840000
488500*                                                               * 48850000
488600***************************************************************** 48860000
488700 B500-PHR27-RCD SECTION.                                          48870000
488800     MOVE 'B500' TO PROG-PAR-NO                                   48880000
488900                                                                  48890000
489000     IF SUM21-NOT-READ                                            48900000
489100         MOVE ERR-3902 TO ERRR-CD OF E1000LK1                     48910000
489200         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               48920000
489300     END-IF                                                       48930000
489400                                                                  48940000
489500     SET PHR27-READ TO TRUE                                       48950000
489600     ADD +1 TO WS-PACK-IN-RCD-CNT                                 48960000
489700     PERFORM A100-CHECK-SET-SEQ THRU A100-EXIT                    48970000
489800     IF DUPL                                                      48980000
489900        GO TO B500-EXIT                                           48990000
490000     END-IF                                                       49000000
490100     EVALUATE TRUE                                                49010000
490200        WHEN TB-SORT-INPUT                                        49020000
490300           PERFORM B510-RLSE-PHR27-RCD THRU B510-EXIT             49030000
490400        WHEN OTHER                                                49040000
490500           PERFORM A800-DETERMINE-BILL-SEC-CD THRU A800-EXIT      49050000
490600*** 951221-71   ALAN MASI  08/19/96 R961114 - PCS WIRELESS        49060000
490700*                                                                 49070000
490800* ADDED CODE TO SET USE-RECORD-INDR TO 'N' IF THE PHRS-TYP-CD     49080000
490900* IS EQUAL TO 0.                                                  49090000
491000*                                                                 49100000
491100           IF TRANSLATED-PHRASE-TYP OF I1005LK3(SORT-REC-IDX) = 0 49110000
491200              MOVE LT-N                                           49120000
491300                TO USE-RECORD-INDR  OF I1005LK3(SORT-REC-IDX)     49130000
491400           END-IF                                                 49140000
491500                                                                  49150000
491600           IF REC-DETAILS-IND  OF E015127  = LT-Y                 49160000
491700              MOVE LT-N                                           49170000
491800                TO USE-RECORD-INDR  OF I1005LK3(SORT-REC-IDX)     49180000
491900           END-IF                                                 49190000
492000                                                                  49200000
492100*                                                                 49210000
492200*  ADDED CODE TO PROCESS SPECIAL CHARS IN PHRS-VARS    R961114    49220000
492300*                                                                 49230000
492400                                                                  49240000
492500           MOVE PHRS-VAR-1 OF E015127 TO WS-PHRS-VAR-1            49250000
492600           MOVE PHRS-VAR-2 OF E015127 TO WS-PHRS-VAR-2            49260000
492700           MOVE PHRS-VAR-3 OF E015127 TO WS-PHRS-VAR-3            49270000
492800           MOVE PHRS-VAR-4 OF E015127 TO WS-PHRS-VAR-4            49280000
492900           MOVE PHRS-VAR-5 OF E015127 TO WS-PHRS-VAR-5            49290000
493000           MOVE PHRS-VAR-6 OF E015127 TO WS-PHRS-VAR-6            49300000
493100           MOVE PHRS-VAR-7 OF E015127 TO WS-PHRS-VAR-7            49310000
493200                                                                  49320000
493300           MOVE ZEROES                TO LT-RTM-CNT               49330000
493400           MOVE SPACES                TO WS-PHRS-VAR-8            49340000
493500           INSPECT PHRS-VAR-DATA OF E015127                       49350000
493600           TALLYING LT-RTM-CNT FOR ALL LT-ASCI-RTM                49360000
493700           IF LT-RTM-CNT > ZERO                                   49370000
493800              SET SPEC-CHAR-8 TO TRUE                             49380000
493900           END-IF                                                 49390000
494000                                                                  49400000
494100           IF SPEC-CHAR-1 OR SPEC-CHAR-2 OR                       49410000
494200              SPEC-CHAR-3 OR SPEC-CHAR-4 OR                       49420000
494300              SPEC-CHAR-5 OR SPEC-CHAR-6 OR                       49430000
494400              SPEC-CHAR-7 OR SPEC-CHAR-8                          49440000
494500                PERFORM B512-PRCS-SPEC-CHARS THRU B512-EXIT       49450000
494600           END-IF                                                 49460000
494700                                                                  49470000
494800* WIJAYA TEMP ADD                                                 49480000
494900     SET NO-ADD-BLANK-HEADING TO TRUE                             49490000
495000     MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                49500000
495100      TO  WS-015127-BLANK                                         49510000
495200                                                                  49520000
495300     IF (SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = 'BL'         49530000
495400     OR SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = 'BL'          49540000
495500     OR SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) = 'BL')         49550000
495600     AND BILL-CAT-TYP OF WS-015127-BLANK > 10                     49560000
495700*    AND ADD-HEADING                                              49570000
495800        SET ADD-BLANK-HEADING TO TRUE                             49580000
495900     END-IF                                                       49590000
496000                                                                  49600000
496100     IF (ADD-HEADING                                              49610000
496200     AND INSERT-015127-HDG                                        49620000
496300     AND WS-HD-BILL-SECT-1-10 NOT EQUAL                           49630000
496400         SA-BILL-SECT-1-10 OF I1005LK3 (SORT-REC-IDX)             49640000
496500     )                                                            49650000
496600     OR ADD-BLANK-HEADING                                         49660000
496700                                                                  49670000
496800       MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)              49680000
496900         TO WS-HD-EMI-RECORD-AR                                   49690000
497000       MOVE TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)      49700000
497100         TO WS-HD-PHRASE-TYP                                      49710000
497200       MOVE SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)            49720000
497300         TO WS-HD-SPLR-PROV-INDR                                  49730000
497400       MOVE SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       49740000
497500         TO WS-HD-SPLR-TEXT-INDR                                  49750000
497600                                                                  49760000
497700         IF ADD-BLANK-HEADING                                     49770000
497800           PERFORM I20C-ADD-BLANK-HEADING THRU I20C-EXIT          49780000
497900         ELSE                                                     49790000
498000           IF ADD-HEADING                                         49800000
498100             PERFORM I20B-ADD-HEADING THRU I20B-EXIT              49810000
498200             VARYING SAV-015127-IDX FROM 1 BY 1                   49820000
498300           UNTIL SAV-BILL-SECT-1-10 (SAV-015127-IDX) EQUAL SPACES 49830000
498400                OR SAV-015127-IDX > LT-1000-NUM                   49840000
498500           END-IF                                                 49850000
498600         END-IF                                                   49860000
498700                                                                  49870000
498800       MOVE WS-HD-EMI-RECORD-AR                                   49880000
498900         TO EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)              49890000
499000       MOVE WS-HD-PHRASE-TYP                                      49900000
499100         TO TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)      49910000
499200       MOVE WS-HD-SPLR-PROV-INDR                                  49920000
499300         TO SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)            49930000
499400       MOVE WS-HD-SPLR-TEXT-INDR                                  49940000
499500         TO SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       49950000
499600     END-IF                                                       49960000
499700     SET NO-ADD-HEADING TO TRUE                                   49970000
499800     SET NO-UPDATE-HEADING TO TRUE                                49980000
499900     SET NO-BEFORE-HEADING TO TRUE                                49990000
500000                                                                  50000000
500100     IF INSERT-015127-HDG                                         50010000
500200                                                                  50020000
500300       EVALUATE TRUE                                              50030000
500400       WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = 'HD'      50040000
500500         MOVE SPACES TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) 50050000
500600         SET WS-HDG-3 TO TRUE                                     50060000
500700       WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = 'HD'      50070000
500800         MOVE SPACES TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) 50080000
500900         SET WS-HDG-4 TO TRUE                                     50090000
501000       WHEN SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) = 'HD'      50100000
501100         MOVE SPACES TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) 50110000
501200         SET WS-HDG-5 TO TRUE                                     50120000
501300       WHEN OTHER                                                 50130000
501400         SET WS-HDG-NO TO TRUE                                    50140000
501500       END-EVALUATE                                               50150000
501600*                                                                 50160000
501700* WIJAYA ADD UPDATE FUNCTIONALITY TO ADD-HEADING                  50170000
501800* UPDATE HEADING SHOULD BE INCLUDE WITH ADD HEADING               50180000
501900* SO SECT-CD SHOULD BE HD - UP                                    50190000
502000*                                                                 50200000
502100       IF WS-HDG-NO                                               50210000
502200           CONTINUE                                               50220000
502300       ELSE                                                       50230000
502400         EVALUATE TRUE                                            50240000
502500         WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = 'UP'    50250000
502600         MOVE SPACES TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) 50260000
502700           SET UPDATE-HEADING TO TRUE                             50270000
502800         WHEN SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) = 'UP'    50280000
502900         MOVE SPACES TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) 50290000
503000           SET UPDATE-HEADING TO TRUE                             50300000
503100         WHEN SA-BILL-SECT-6 OF I1005LK3 (SORT-REC-IDX) = 'UP'    50310000
503200         MOVE SPACES TO SA-BILL-SECT-6 OF I1005LK3 (SORT-REC-IDX) 50320000
503300           SET UPDATE-HEADING TO TRUE                             50330000
503400         WHEN OTHER                                               50340000
503500           SET NO-UPDATE-HEADING TO TRUE                          50350000
503600         END-EVALUATE                                             50360000
503700                                                                  50370000
503800         EVALUATE TRUE                                            50380000
503900         WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = 'BF'    50390000
504000         MOVE SPACES TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) 50400000
504100           SET BEFORE-HEADING TO TRUE                             50410000
504200         WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = 'BF'    50420000
504300         MOVE SPACES TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) 50430000
504400           SET BEFORE-HEADING TO TRUE                             50440000
504500         WHEN SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) = 'BF'    50450000
504600         MOVE SPACES TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX) 50460000
504700           SET BEFORE-HEADING TO TRUE                             50470000
504800         WHEN OTHER                                               50480000
504900           SET NO-BEFORE-HEADING TO TRUE                          50490000
505000         END-EVALUATE                                             50500000
505100       END-IF                                                     50510000
505200     END-IF                                                       50520000
505300                                                                  50530000
505400     IF NO-UPDATE-HEADING AND NO-BEFORE-HEADING                   50540000
505500           PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT            50550000
505600     END-IF                                                       50560000
505700                                                                  50570000
505800                                                                  50580000
505900     END-EVALUATE                                                 50590000
506000*                                                                 50600000
506100* R961114 - SJW - USE TRAIT FOR JOURNAL TO CALL XIRZA000          50610000
506200*                                                                 50620000
506300     IF DO-JOURNALS                                               50630000
506400         PERFORM C400-CALL-XIRZA000 THRU C400-EXIT                50640000
506500     END-IF                                                       50650000
506600                                                                  50660000
506700*** 930203-70   ALAN MASI   05/02/96                              50670000
506800*                                                                 50680000
506900* ADDED CODE TO POPULATE TAX FIELDS IF SECT-CD 2 OR 3 = 'TS'      50690000
507000* SPRINTS TAX RECORDS ARE IN SECTION CODE 3 AND ATT ARE IN        50700000
507100* SECTION CD 2.                                                   50710000
507200*                                                                 50720000
507300     PERFORM                                                      50730000
507400      VARYING SORT-REC-IDX FROM 1 BY 1                            50740000
507500       UNTIL SORT-REC-IDX IS GREATER THAN                         50750000
507600             CNTR-SRT-REC-TBL-ENTRIES                             50760000
507700          OR SORT-REC-IDX IS GREATER THAN LT-1000-NUM             50770000
507800          OR CNTR-SRT-REC-TBL-ENTRIES IS EQUAL TO                 50780000
507900             ZEROES                                               50790000
508000        IF SA-BILL-SECT-2 OF I1005LK3 (SORT-REC-IDX) = LT-TS OR   50800000
508100           SA-BILL-SECT-2 OF I1005LK3 (SORT-REC-IDX) = LT-TX OR   50810000
508200           SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = LT-TS OR   50820000
508300           SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = LT-TX      50830000
508400          EVALUATE TRUE                                           50840000
508500* FOR SPRINT                                                      50850000
508600            WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = LT-FT50860000
508700                 ADD BILL-AMT OF E015127 TO WS-FED-TX-AMT         50870000
508800                                            WS-TOT-TX             50880000
508900            WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = LT-SL50890000
509000                 ADD BILL-AMT OF E015127 TO WS-LOC-ST-TX-AMT      50900000
509100                                            WS-TOT-TX             50910000
509200            WHEN SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX) = LT-BS50920000
509300                 ADD BILL-AMT OF E015127 TO WS-MSG-SURCHG-AMT     50930000
509400                                            WS-TOT-TX             50940000
509500* FOR ALL OTHER CARRIERS                                          50950000
509600            WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = LT-FT50960000
509700                 ADD BILL-AMT OF E015127 TO WS-FED-TX-AMT         50970000
509800                                            WS-TOT-TX             50980000
509900            WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = LT-SL50990000
510000                 ADD BILL-AMT OF E015127 TO WS-LOC-ST-TX-AMT      51000000
510100                                            WS-TOT-TX             51010000
510200                 IF BILL-SUB-CAT-ID OF E015127 = 'TAX'            51020000
510300                    AND                                           51030000
510400                    PHRS-MSG-CD OF E015127 = 'DC027'              51040000
510500                    AND                                           51050000
510600                    BLBL-LN-IND OF E015127 = '0'                  51060000
510700                    AND                                           51070000
510800                    PHRS-TYP-IND OF E015127 = 'D'                 51080000
510900                      SET SUM27-TAX-ADDED TO TRUE                 51090000
511000                 END-IF                                           51100000
511100            WHEN SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = LT-BS51110000
511200                 ADD BILL-AMT OF E015127 TO WS-MSG-SURCHG-AMT     51120000
511300                                            WS-TOT-TX             51130000
511400          END-EVALUATE                                            51140000
511500        END-IF                                                    51150000
511600        IF NON-SPLR-PROV (SORT-REC-IDX)                           51160000
511700           ADD +1 TO WS-SUM-RCD-CRTE-NO                           51170000
511800        END-IF                                                    51180000
511900        IF NOT-USE-RECORD (SORT-REC-IDX)                          51190000
512000           ADD +1 TO WS-RCD-NOT-PRTD-NO                           51200000
512100        END-IF                                                    51210000
512200     END-PERFORM                                                  51220000
512300     SET SORT-REC-IDX TO +1                                       51230000
512400                                                                  51240000
512500     IF INSERT-015127-HDG AND TB-NOT-SORT-INPUT                   51250000
512600       IF WS-HDG-NO                                               51260000
512700         CONTINUE                                                 51270000
512800       ELSE                                                       51280000
512900                                                                  51290000
513000         EVALUATE TRUE                                            51300000
513100           WHEN WS-HDG-3                                          51310000
513200             MOVE 'HD'                                            51320000
513300               TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)       51330000
513400           WHEN WS-HDG-4                                          51340000
513500             MOVE 'HD'                                            51350000
513600               TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)       51360000
513700           WHEN WS-HDG-5                                          51370000
513800             MOVE 'HD'                                            51380000
513900               TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)       51390000
514000         END-EVALUATE                                             51400000
514100                                                                  51410000
514200         PERFORM I20A-CREATE-HEADING THRU I20A-EXIT               51420000
514300                                                                  51430000
514400         IF UPDATE-HEADING                                        51440000
514500           EVALUATE TRUE                                          51450000
514600             WHEN WS-HDG-3                                        51460000
514700               MOVE SPACES                                        51470000
514800                 TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)     51480000
514900             WHEN WS-HDG-4                                        51490000
515000               MOVE SPACES                                        51500000
515100                 TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)     51510000
515200             WHEN WS-HDG-5                                        51520000
515300               MOVE SPACES                                        51530000
515400                 TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)     51540000
515500           END-EVALUATE                                           51550000
515600                                                                  51560000
515700           PERFORM I20B-ADD-HEADING THRU I20B-EXIT                51570000
515800           VARYING SAV-015127-IDX FROM 1 BY 1                     51580000
515900           UNTIL SAV-BILL-SECT-1-10 (SAV-015127-IDX) EQUAL SPACES 51590000
516000                OR SAV-015127-IDX > LT-1000-NUM                   51600000
516100                                                                  51610000
516200           SET NO-ADD-HEADING TO TRUE                             51620000
516300           SET NO-UPDATE-HEADING TO TRUE                          51630000
516400         END-IF                                                   51640000
516500                                                                  51650000
516600         IF BEFORE-HEADING                                        51660000
516700           MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)          51670000
516800             TO SAVE-EMI-RECORD-AR                                51680000
516900           MOVE SPLR-PROV-INDR OF I1005LK3 (SORT-REC-IDX)         51690000
517000             TO SAVE-SPLR-PROV-INDR                               51700000
517100           MOVE SPLR-TEXT-PROV-INDR OF I1005LK3 (SORT-REC-IDX)    51710000
517200             TO SAVE-SPLR-TEXT-PROV-INDR                          51720000
517300           EVALUATE TRUE                                          51730000
517400             WHEN WS-HDG-3                                        51740000
517500               MOVE SPACES                                        51750000
517600                 TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)     51760000
517700             WHEN WS-HDG-4                                        51770000
517800               MOVE SPACES                                        51780000
517900                 TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)     51790000
518000             WHEN WS-HDG-5                                        51800000
518100               MOVE SPACES                                        51810000
518200                 TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)     51820000
518300           END-EVALUATE                                           51830000
518400                                                                  51840000
518500           PERFORM I20B-ADD-HEADING THRU I20B-EXIT                51850000
518600           VARYING SAV-015127-IDX FROM 1 BY 1                     51860000
518700           UNTIL SAV-BILL-SECT-1-10 (SAV-015127-IDX) EQUAL SPACES 51870000
518800                OR SAV-015127-IDX > LT-1000-NUM                   51880000
518900                                                                  51890000
519000           SET NO-ADD-HEADING TO TRUE                             51900000
519100           SET NO-BEFORE-HEADING TO TRUE                          51910000
519200           MOVE SAVE-EMI-RECORD-AR                                51920000
519300             TO EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)          51930000
519400           MOVE SAVE-SPLR-PROV-INDR                               51940000
519500             TO SPLR-PROV-INDR OF I1005LK3 (SORT-REC-IDX)         51950000
519600           MOVE SAVE-SPLR-TEXT-PROV-INDR                          51960000
519700             TO SPLR-TEXT-PROV-INDR OF I1005LK3 (SORT-REC-IDX)    51970000
519800           PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT            51980000
519900         END-IF                                                   51990000
520000       END-IF                                                     52000000
520100     END-IF                                                       52010000
520200                                                                  52020000
520300     .                                                            52030000
520400 B500-EXIT.                                                       52040000
520500     EXIT.                                                        52050000
520600                                                                  52060000
520700     EJECT                                                        52070000
520800***************************************************************** 52080000
520900*                B510-RLSE-PHR27-RCD                            * 52090000
521000*                                                               * 52100000
521100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 52110000
521200*       1) CALL THE BUILD AND SORT INVOICES ROUTINE             * 52120000
521300*       2) ALL TOTAL RECORDS SENT BY THE CARRIER ARE STORED     * 52130000
521400*          IN AN INTERNAL TABLE                                 * 52140000
521500*       3) CALL THE ROUTINE THAT RELEASES RECORDS TO THE SORT   * 52150000
521600*                                                               * 52160000
521700***************************************************************** 52170000
521800 B510-RLSE-PHR27-RCD SECTION.                                     52180000
521900     MOVE 'B510' TO PROG-PAR-NO                                   52190000
522000     SET CONTINUE-INVOICE-PROCESS TO TRUE                         52200000
522100     PERFORM C200-CALL-XIRI1005 THRU C200-EXIT                    52210000
522200     IF  PHRS-TYP-IND OF E015127 IS EQUAL TO LT-ALPHA-3           52220000
522300         PERFORM B511-STORE-OPC-RCD THRU B511-EXIT                52230000
522400     END-IF                                                       52240000
522500     PERFORM C300-UNLD-TBL THRU C300-EXIT                         52250000
522600     VARYING SORT-REC-IDX FROM 1 BY 1                             52260000
522700       UNTIL SORT-REC-IDX IS GREATER THAN                         52270000
522800             CNTR-SRT-REC-TBL-ENTRIES                             52280000
522900          OR SORT-REC-IDX IS GREATER THAN LT-1000-NUM             52290000
523000          OR CNTR-SRT-REC-TBL-ENTRIES IS EQUAL TO                 52300000
523100             ZEROES                                               52310000
523200     SET SORT-REC-IDX TO +1                                       52320000
523300     .                                                            52330000
523400 B510-EXIT.                                                       52340000
523500     EXIT.                                                        52350000
523600                                                                  52360000
523700     EJECT                                                        52370000
523800***************************************************************** 52380000
523900*                B511-STORE-OPC-RCD                             * 52390000
524000*                                                               * 52400000
524100*    THIS PARAGRAPH SAVES OFF ALL TOTAL RECORDS THAT COME IN    * 52410000
524200*    FROM THE CARRIER TO AN INTERNAL TABLE.  THEN LATER ON IF   * 52420000
524300*    IT IS DETERMINED THAT A PARTICULAR TOTAL IS TO BE PRINTED  * 52430000
524400*    AND A TOTAL LINE EXISTS IN THIS TABLE FOR IT, THE RECORD   * 52440000
524500*    IS USED.                                                   * 52450000
524600*                                                               * 52460000
524700***************************************************************** 52470000
524800 B511-STORE-OPC-RCD SECTION.                                      52480000
524900     MOVE 'B511' TO PROG-PAR-NO                                   52490000
525000     INITIALIZE SAV-015127-TABLE (SAV-015127-IDX)                 52500000
525100     MOVE WS-CURR-SPLR TO SAV-SPLR-ID (SAV-015127-IDX)            52510000
525200     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD                             52520000
525300                  TO RCD-015127 (SAV-015127-IDX)                  52530000
525400     MOVE SA-BILL-SECT-1 (SORT-REC-IDX)                           52540000
525500       TO SAV-BILL-SECT-1 (SAV-015127-IDX)                        52550000
525600     MOVE SA-BILL-SECT-2 (SORT-REC-IDX)                           52560000
525700       TO SAV-BILL-SECT-2 (SAV-015127-IDX)                        52570000
525800     IF SA-BILL-SECT-3 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT       52580000
525900      MOVE SA-BILL-SECT-3 (SORT-REC-IDX)                          52590000
526000        TO SAV-BILL-SECT-3 (SAV-015127-IDX)                       52600000
526100      IF SA-BILL-SECT-4 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT      52610000
526200       MOVE SA-BILL-SECT-4 (SORT-REC-IDX)                         52620000
526300         TO SAV-BILL-SECT-4 (SAV-015127-IDX)                      52630000
526400       IF SA-BILL-SECT-5 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT     52640000
526500        MOVE SA-BILL-SECT-5 (SORT-REC-IDX)                        52650000
526600          TO SAV-BILL-SECT-5 (SAV-015127-IDX)                     52660000
526700        IF SA-BILL-SECT-6 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT    52670000
526800         MOVE SA-BILL-SECT-6 (SORT-REC-IDX)                       52680000
526900           TO SAV-BILL-SECT-6 (SAV-015127-IDX)                    52690000
527000         IF SA-BILL-SECT-7 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT   52700000
527100          MOVE SA-BILL-SECT-7 (SORT-REC-IDX)                      52710000
527200            TO SAV-BILL-SECT-7 (SAV-015127-IDX)                   52720000
527300          IF SA-BILL-SECT-8 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT  52730000
527400           MOVE SA-BILL-SECT-8 (SORT-REC-IDX)                     52740000
527500             TO SAV-BILL-SECT-8 (SAV-015127-IDX)                  52750000
527600           IF SA-BILL-SECT-9 (SORT-REC-IDX) IS NOT EQUAL TO LT-DT 52760000
527700            MOVE SA-BILL-SECT-9 (SORT-REC-IDX)                    52770000
527800              TO SAV-BILL-SECT-9 (SAV-015127-IDX)                 52780000
527900            IF SA-BILL-SECT-10(SORT-REC-IDX) IS NOT EQUAL TO LT-DT52790000
528000             MOVE SA-BILL-SECT-10 (SORT-REC-IDX)                  52800000
528100               TO SAV-BILL-SECT-10 (SAV-015127-IDX)               52810000
528200            END-IF                                                52820000
528300           END-IF                                                 52830000
528400          END-IF                                                  52840000
528500         END-IF                                                   52850000
528600        END-IF                                                    52860000
528700       END-IF                                                     52870000
528800      END-IF                                                      52880000
528900     END-IF                                                       52890000
529000     MOVE BILL-CAT-TYP OF RCD-015127 (SAV-015127-IDX)             52900000
529100       TO SAV-BILL-CAT-ID (SAV-015127-IDX)                        52910000
529200     MOVE BILL-SUB-CAT-ID OF RCD-015127 (SAV-015127-IDX)          52920000
529300       TO SAV-BILL-SUB-CAT-ID (SAV-015127-IDX)                    52930000
529400     SET SAV-015127-IDX UP BY +1                                  52940000
529500     IF SAV-015127-IDX IS GREATER THAN LT-1000-NUM                52950000
529600         MOVE ERR-3943 TO ERRR-CD OF E1000LK1                     52960000
529700         MOVE SPACES TO VW-NM OF Z9000LK1                         52970000
529800         MOVE SPACES TO SQLCA-AR OF Z9000LK1                      52980000
529900         MOVE USG-ID OF TRMSN-ACPTNC-RCD                          52990000
530000           TO WS-3943-USG-ID                                      53000000
530100         MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                      53010000
530200           TO WS-3943-USG-SEQ-NO                                  53020000
530300         MOVE WS-3943-ERR-MSG-1                                   53030000
530400           TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                     53040000
530500         MOVE WS-3943-ERR-MSG-2                                   53050000
530600           TO ERRR-DISPL-FLDS OF Z9000LK1 (2)                     53060000
530700         PERFORM E100-PROCESS-ERRORS THRU E100-EXIT               53070000
530800     END-IF                                                       53080000
530900     .                                                            53090000
531000 B511-EXIT.                                                       53100000
531100     EXIT.                                                        53110000
531200                                                                  53120000
531300     EJECT                                                        53130000
531400***************************************************************** 53140000
531500*                B512-PRCS-SPEC-CHARS                           * 53150000
531600*                                                               * 53160000
531700*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 53170000
531800*       1) CHECKS THE PHRS-VAR-1 THRU PHRS-VAR-7                * 53180000
531900*          TO SEE IF THERE ARE ANY SPECIAL CHARACTERS           * 53190000
532000*          TO CONVERT TO SPEC-CHAR MARKS                        * 53200000
532100*       2) WRITE OUT THE CHGD RECORD TO USA2 TABLE WITH THE     * 53210000
532200*          PRINTABLE FLAG SET                                   * 53220000
532300*                                                               * 53230000
532400***************************************************************** 53240000
532500 B512-PRCS-SPEC-CHARS SECTION.                                    53250000
532600     MOVE 'B512' TO PROG-PAR-NO                                   53260000
532700                                                                  53270000
532800     MOVE SPLR-ID OF C1000LK1 TO SPLR-ID OF XIRI1080-PASS-AR      53280000
532900     MOVE APPLCN-RGN-ID OF C3000LK1 TO                            53290000
533000          APPLCN-RGN-ID OF XIRI1080-PASS-AR                       53300000
533100                                                                  53310000
533200     CALL 'XIRI1080'  USING I1080LK1                              53320000
533300                            E015127                               53330000
533400                            WS-015127-REPLACEMENT-REC.            53340000
533500     IF REPLACING-RECORD                                          53350000
533600        SET NOT-USE-RECORD OF I1005LK3 (SORT-REC-IDX) TO TRUE     53360000
533700        ADD +1 TO WS-RCD-NOT-PRTD-NO                              53370000
533800        PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT               53380000
533900        MOVE WS-015127-REPLACEMENT-REC TO                         53390000
534000             EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)             53400000
534100        SET NON-SPLR-PROV OF I1005LK3 (SORT-REC-IDX) TO TRUE      53410000
534200        SET NOT-REPLACING-RECORD OF XIRI1080-RTRN-AR TO TRUE      53420000
534300        IF (PHRS-TYP-IND OF E015127 = '0')                        53430000
534400            SET NOT-USE-RECORD OF I1005LK3 (SORT-REC-IDX)         53440000
534500               TO TRUE                                            53450000
534600        ELSE                                                      53460000
534700            SET USE-RECORD OF I1005LK3 (SORT-REC-IDX) TO TRUE     53470000
534800        END-IF                                                    53480000
534900     END-IF                                                       53490000
535000                                                                  53500000
535100     .                                                            53510000
535200 B512-EXIT.                                                       53520000
535300     EXIT.                                                        53530000
535400                                                                  53540000
535500     EJECT                                                        53550000
535600***************************************************************** 53560000
535700*                B600-MSG81-RCD                                 * 53570000
535800*                                                               * 53580000
535900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 53590000
536000*       1) CHECK FOR MISSING PHRASE SUMMARY RECORD.             * 53600000
536100*       2) CALL A ROUTINE TO VALIDATE THE INVOICE SEQUENCE.     * 53610000
536200*       3) INSERT THE DETAIL RECORD OR RELEASE IT TO THE SORT   * 53620000
536300*                                                               * 53630000
536400***************************************************************** 53640000
536500 B600-MSG81-RCD SECTION.                                          53650000
536600     MOVE 'B600' TO PROG-PAR-NO                                   53660000
536700*                                                                 53670000
536800* R961114 - SJW - USE TRAIT FOR NO 015127 RECORDS                 53680000
536900*                 INSTEAD OF SPLR-ID IFO                          53690000
537000*                                                                 53700000
537100     IF DONT-USE-015127-RCDS                                      53710000
537200         CONTINUE                                                 53720000
537300     ELSE                                                         53730000
537400         IF PHR27-NOT-READ                                        53740000
537500             MOVE ERR-3903 TO ERRR-CD OF E1000LK1                 53750000
537600             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           53760000
537700         END-IF                                                   53770000
537800     END-IF                                                       53780000
537900                                                                  53790000
538000*** TR#175774  ALAN MASI  09/03/96  R961114                       53800000
538100*                                                                 53810000
538200* ADDED CODE TO SET CARD ONLY WHEN THE FIRST 81 RECORD            53820000
538300* HAS A MSG-TYP = 3.  THEN IF ANY OF THE FOLLOWING 81 RECORDS     53830000
538400* DO NOT HAVE A MESSAGE TYPE 3 NOT-CARD-ONLY IS SET TO TRUE.      53840000
538500*                                                                 53850000
538600     IF FIRST-81-RECORD                                           53860000
538700        IF BMD81-MSG-TYP = LT-3                                   53870000
538800           SET CARD-ONLY TO TRUE                                  53880000
538900        END-IF                                                    53890000
539000        SET NOT-FIRST-81-RECORD TO TRUE                           53900000
539100     END-IF                                                       53910000
539200                                                                  53920000
539300     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO E81XXXX                  53930000
539400                                                                  53940000
539500     IF SUMMING-WIRELESS-ON                                       53950000
539600        IF E81XXXX(210:3) = WS-WRELS-PNTR                         53960000
539700           ADD +1 TO WS-TOTAL-WRELS-MSG-NO                        53970000
539800           ADD BMD81-CHG TO WS-TOTAL-WRELS-MSG-AMT                53980000
539900        END-IF                                                    53990000
540000     END-IF.                                                      54000000
540100                                                                  54010000
540200     ADD +1 TO WS-PACK-IN-RCD-CNT                                 54020000
540300     PERFORM A100-CHECK-SET-SEQ THRU A100-EXIT                    54030000
540400     IF DUPL                                                      54040000
540500        CONTINUE                                                  54050000
540600     ELSE                                                         54060000
540700        IF BMD81-MSG-TYP NOT = LT-3                               54070000
540800           SET NOT-CARD-ONLY TO TRUE                              54080000
540900        END-IF                                                    54090000
541000        EVALUATE TRUE                                             54100000
541100           WHEN TB-SORT-INPUT                                     54110000
541200              PERFORM B610-RLSE-MSG81-RCD THRU B610-EXIT          54120000
541300           WHEN OTHER                                             54130000
541400              PERFORM A800-DETERMINE-BILL-SEC-CD THRU A800-EXIT   54140000
541500              PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT         54150000
541600        END-EVALUATE                                              54160000
541700*                                                                 54170000
541800* R961114 - SJW - USE TRAIT FOR JOURNAL TO CALL XIRZA000          54180000
541900*                                                                 54190000
542000        IF DO-JOURNALS                                            54200000
542100            PERFORM C400-CALL-XIRZA000 THRU C400-EXIT             54210000
542200        END-IF                                                    54220000
542300     END-IF                                                       54230000
542400***  R961212 SJWETEK    09/17/96                                  54240000
542500*                                                                 54250000
542600*    MODIFY INTER, INTRALTA INDR BASED ON 81-SETLMT-CD            54260000
542700*                                                                 54270000
542800     IF BMD81-SETLMT-CD IS NUMERIC                                54280000
542900         SET INTRALTA-MSGS-FND TO TRUE                            54290000
543000     ELSE                                                         54300000
543100         SET INTERLTA-MSGS-FND TO TRUE                            54310000
543200     END-IF                                                       54320000
543300                                                                  54330000
543400     .                                                            54340000
543500 B600-EXIT.                                                       54350000
543600     EXIT.                                                        54360000
543700                                                                  54370000
543800     EJECT                                                        54380000
543900***************************************************************** 54390000
544000*                B610-RLSE-MSG81-RCD                            * 54400000
544100*                                                               * 54410000
544200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 54420000
544300*       1) CALL BUILD AND SORT INVOICE ROUTINE                  * 54430000
544400*       2) RELEASE RECORD TO SORT                               * 54440000
544500*                                                               * 54450000
544600*                                                               * 54460000
544700*                                                               * 54470000
544800***************************************************************** 54480000
544900 B610-RLSE-MSG81-RCD SECTION.                                     54490000
545000     MOVE 'B610' TO PROG-PAR-NO                                   54500000
545100     SET CONTINUE-INVOICE-PROCESS TO TRUE                         54510000
545200     PERFORM C200-CALL-XIRI1005 THRU C200-EXIT                    54520000
545300     PERFORM C300-UNLD-TBL THRU C300-EXIT                         54530000
545400      VARYING SORT-REC-IDX FROM 1 BY 1                            54540000
545500       UNTIL SORT-REC-IDX > CNTR-SRT-REC-TBL-ENTRIES              54550000
545600          OR SORT-REC-IDX > LT-1000-NUM                           54560000
545700          OR CNTR-SRT-REC-TBL-ENTRIES = ZEROES                    54570000
545800     SET SORT-REC-IDX TO +1                                       54580000
545900     .                                                            54590000
546000 B610-EXIT.                                                       54600000
546100     EXIT.                                                        54610000
546200                                                                  54620000
546300     EJECT                                                        54630000
546400***************************************************************** 54640000
546500*                B700-PACK-TRLR                                 * 54650000
546600*                                                               * 54660000
546700*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 54670000
546800*       1) CHECK RECORD COUNT ON THE PACK TRAILER RECORD AGAINST* 54680000
546900*          INTERNAL COUNT OF RECORDS WITHIN A PACK.             * 54690000
547000*       2) WRAP UP PROCESSING FOR THE PREVIOUS INVOICE          * 54700000
547100*                                                               * 54710000
547200***************************************************************** 54720000
547300 B700-PACK-TRLR SECTION.                                          54730000
547400     MOVE 'B700' TO PROG-PAR-NO                                   54740000
547500     MOVE EMI-RCD OF TRMSN-ACPTNC-RCD TO E202206M                 54750000
547600     ADD +1       TO WS-HDR-TRL-CNT                               54760000
547700     SET PACK-TRLR-READ TO TRUE                                   54770000
547800     IF TB-SORT-INPUT AND FIRST-RSTRT-PACK                        54780000
547900        CONTINUE                                                  54790000
548000     ELSE                                                         54800000
548100        IF WS-PACK-IN-RCD-CNT = TRL06-TOT-REC-CT OF E202206M      54810000
548200           CONTINUE                                               54820000
548300        ELSE                                                      54830000
548400           MOVE ERR-3904             TO ERRR-CD OF E1000LK1       54840000
548500           MOVE WS-PACK-TRLR-CT-LTRL TO WS-ERRR-LTRL              54850000
548600           MOVE TRL06-TOT-REC-CT OF E202206M TO WS-ERRR-VAL       54860000
548700           MOVE WS-ERRR-DISPL                                     54870000
548800             TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                   54880000
548900           MOVE WS-PACK-RCD-CT-LTRL  TO WS-ERRR-LTRL              54890000
549000           MOVE WS-PACK-IN-RCD-CNT   TO WS-ERRR-VAL               54900000
549100           MOVE WS-ERRR-DISPL                                     54910000
549200             TO ERRR-DISPL-FLDS OF Z9000LK1 (2)                   54920000
549300           PERFORM E100-PROCESS-ERRORS THRU E100-EXIT             54930000
549400        END-IF                                                    54940000
549500     END-IF                                                       54950000
549600     MOVE NO-OF-SUM-RCDS-WITHIN-INV TO WS-TOT-SUM-RECS            54960000
549700     MOVE SUM21-TOT-MSG             TO WS-TOT-MSG-NO              54970000
549800     EVALUATE TRUE                                                54980000
549900        WHEN TB-SORT-INPUT                                        54990000
550000           IF SUM21-READ                                          55000000
550100              PERFORM B800-FINISH-PREV-INVOICE THRU B800-EXIT     55010000
550200              PERFORM A600-CHECK-II-CNTLS THRU A600-EXIT          55020000
550300***      B900-CREATE-WRAP-UP-RCD IS TO CLEAN UP PREVIOUS ACCOUNT  55030000
550400              PERFORM B900-CREATE-WRAP-UP-RCD THRU B900-EXIT      55040000
550500           END-IF                                                 55050000
550600        WHEN TB-NOT-SORT-INPUT                                    55060000
550700           IF SUM21-READ                                          55070000
550800              PERFORM A600-CHECK-II-CNTLS THRU A600-EXIT          55080000
550900              PERFORM U100-UPDATE-XZ8USA1T THRU U100-EXIT         55090000
551000           END-IF                                                 55100000
551100     END-EVALUATE                                                 55110000
551200                                                                  55120000
551300     IF TB-SORT-INPUT                                             55130000
551400        SET SORT-REC-IDX TO +1                                    55140000
551500        MOVE HIGH-VALUES                                          55150000
551600          TO SORTFILE-OUT-KEY OF SORT-REC-TABLE (SORT-REC-IDX)    55160000
551700        MOVE EMI-RCD OF TRMSN-ACPTNC-RCD                          55170000
551800          TO EMI-RECORD-AR    OF SORT-REC-TABLE (SORT-REC-IDX)    55180000
551900        MOVE SORT-REC-TABLE (SORT-REC-IDX) TO WS-SORT-RECORD      55190000
552000        MOVE WS-TOT-IN-FILE-CNT            TO WS-SORT-RCD-IN-CNT  55200000
552100        MOVE WS-TEMP-SORT-RECORD           TO SORT-RECORD         55210000
552200        PERFORM R100-RLSE-RECORD THRU R100-EXIT                   55220000
552300     END-IF                                                       55230000
552400                                                                  55240000
552500     IF TB-SORT-INPUT                                             55250000
552600        IF FIRST-RSTRT-PACK                                       55260000
552700           SET NOT-FIRST-RSTRT-PACK TO TRUE                       55270000
552800        END-IF                                                    55280000
552900     END-IF                                                       55290000
553000                                                                  55300000
553100     INITIALIZE WS-FED-TX-AMT                                     55310000
553200                WS-LOC-ST-TX-AMT                                  55320000
553300                WS-MSG-SURCHG-AMT                                 55330000
553400                WS-TOT-TX                                         55340000
553500                WS-SUM-RCD-CRTE-NO                                55350000
553600                WS-RCD-NOT-PRTD-NO                                55360000
553700                WS-PACK-IN-RCD-CNT                                55370000
553800     SET NOT-READ-FROM-SORT-AREA     TO TRUE                      55380000
553900     SET PERFORM-SORT                TO TRUE                      55390000
554000     SET SUM21-NOT-READ              TO TRUE                      55400000
554100     SET FIRST-015121-IN-PACK        TO TRUE                      55410000
554200     .                                                            55420000
554300 B700-EXIT.                                                       55430000
554400     EXIT.                                                        55440000
554500                                                                  55450000
554600     EJECT                                                        55460000
554700***************************************************************** 55470000
554800*                B800-FINISH-PREV-INVOICE                       * 55480000
554900*                                                               * 55490000
555000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 55500000
555100*       1. WRAP UP PROCESSING FOR THE PREVIOUS INVOICE.  THIS   * 55510000
555200*          PARAGRAPH IS CALLED WHEN THE FIRST RECORD OF A NEW   * 55520000
555300*          INVOICE IS ENCOUNTERED, AND AT PACK TRAILER.         * 55530000
555400*       2. CALL THE BUILD 015127 ROUTINE                        * 55540000
555500*       3. CALL THE BUILD AND SORT INVOICE ROUTINE              * 55550000
555600*       4. CALL THE CHECK FI CONTROLS ROUTINE                   * 55560000
555700*                                                               * 55570000
555800***************************************************************** 55580000
555900 B800-FINISH-PREV-INVOICE SECTION.                                55590000
556000     MOVE 'B800' TO PROG-PAR-NO                                   55600000
556100     IF DUPL                                                      55610000
556200        SET SAV-015127-IDX TO +1                                  55620000
556300     ELSE                                                         55630000
556400        PERFORM B810-CALL-XIRI1050 THRU B810-EXIT                 55640000
556500        IF TB-SORT-INPUT                                          55650000
556600           PERFORM B820-CALL-XIRI1060 THRU B820-EXIT              55660000
556700        END-IF                                                    55670000
556800        MOVE WS-HOLD-E015121  TO E015121                          55680000
556900        MOVE HIGH-VALUES      TO I1060LK2                         55690000
557000                                 I1005LK2                         55700000
557100        MOVE ZEROES TO SUBTOT-AMT  OF I1005LK2(1)                 55710000
557200                       SUBTOT-AMT  OF I1005LK2(2)                 55720000
557300                       SUBTOT-AMT  OF I1005LK2(3)                 55730000
557400                       SUBTOT-AMT  OF I1005LK2(4)                 55740000
557500                       CNTR-SUBTOT-TBL-ENTRIES OF I1005LK2        55750000
557600        SET NOT-MULTILINE TO TRUE                                 55760000
557700        SET SAV-015127-IDX TO +1                                  55770000
557800        PERFORM                                                   55780000
557900         VARYING SORT-REC-IDX FROM 1 BY 1                         55790000
558000          UNTIL SORT-REC-IDX IS GREATER THAN                      55800000
558100                CNTR-SRT-REC-TBL-ENTRIES                          55810000
558200          OR SORT-REC-IDX IS GREATER THAN LT-1000-NUM             55820000
558300          OR CNTR-SRT-REC-TBL-ENTRIES IS EQUAL TO ZEROES          55830000
558400           PERFORM B830-CHECK-FI-CNTLS THRU B830-EXIT             55840000
558500*** 930203-70   ALAN MASI   05/02/96                              55850000
558600*                                                                 55860000
558700* ADDED CODE TO POPULATE TAX FIELDS IF SECT-CD 2 OR 3 ARE =       55870000
558800* 'TS' SPRINTS TAX RECORDS ARE IN SECTION CODE 3 AND ATT ARE      55880000
558900* IN SECTION CD 2.                                                55890000
559000*                                                                 55900000
559100           IF SA-BILL-SECT-2 OF I1005LK3(SORT-REC-IDX)            55910000
559200                             = LT-TS OR                           55920000
559300              SA-BILL-SECT-2 OF I1005LK3(SORT-REC-IDX)            55930000
559400                             = LT-TX OR                           55940000
559500              SA-BILL-SECT-3 OF I1005LK3(SORT-REC-IDX)            55950000
559600                             = LT-TS OR                           55960000
559700              SA-BILL-SECT-3 OF I1005LK3(SORT-REC-IDX)            55970000
559800                             = LT-TX                              55980000
559900              IF SUM27-TAX-ADDED                                  55990000
560000                CONTINUE                                          56000000
560100              ELSE                                                56010000
560200                MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)     56020000
560300                  TO WS-E015127-HOLD                              56030000
560400                EVALUATE TRUE                                     56040000
560500* FOR SPRINT                                                      56050000
560600                 WHEN SA-BILL-SECT-4 OF I1005LK3(SORT-REC-IDX)    56060000
560700                      = LT-FT                                     56070000
560800                   ADD BILL-AMT OF WS-E015127-HOLD                56080000
560900                    TO WS-FED-TX-AMT                              56090000
561000                       WS-TOT-TX                                  56100000
561100                 WHEN SA-BILL-SECT-4 OF I1005LK3(SORT-REC-IDX)    56110000
561200                      = LT-SL                                     56120000
561300                   ADD BILL-AMT OF WS-E015127-HOLD                56130000
561400                    TO WS-LOC-ST-TX-AMT                           56140000
561500                       WS-TOT-TX                                  56150000
561600                 WHEN SA-BILL-SECT-4 OF I1005LK3(SORT-REC-IDX)    56160000
561700                      = LT-BS                                     56170000
561800                   ADD BILL-AMT OF WS-E015127-HOLD                56180000
561900                    TO WS-MSG-SURCHG-AMT                          56190000
562000                       WS-TOT-TX                                  56200000
562100* FOR ALL OTHER CARRIERS                                          56210000
562200                 WHEN SA-BILL-SECT-3 OF I1005LK3(SORT-REC-IDX)    56220000
562300                      = LT-FT                                     56230000
562400                   ADD BILL-AMT OF WS-E015127-HOLD                56240000
562500                    TO WS-FED-TX-AMT                              56250000
562600                       WS-TOT-TX                                  56260000
562700                 WHEN SA-BILL-SECT-3 OF I1005LK3(SORT-REC-IDX)    56270000
562800                      = LT-SL                                     56280000
562900                   ADD BILL-AMT OF WS-E015127-HOLD                56290000
563000                    TO WS-LOC-ST-TX-AMT                           56300000
563100                       WS-TOT-TX                                  56310000
563200                 WHEN SA-BILL-SECT-3 OF I1005LK3(SORT-REC-IDX)    56320000
563300                      = LT-BS                                     56330000
563400                   ADD BILL-AMT OF WS-E015127-HOLD                56340000
563500                    TO WS-MSG-SURCHG-AMT                          56350000
563600                       WS-TOT-TX                                  56360000
563700                END-EVALUATE                                      56370000
563800              END-IF                                              56380000
563900           END-IF                                                 56390000
564000           IF NON-SPLR-PROV  (SORT-REC-IDX) AND                   56400000
564100              NOT-USE-RECORD (SORT-REC-IDX)                       56410000
564200              CONTINUE                                            56420000
564300           ELSE                                                   56430000
564400              IF TB-SORT-INPUT                                    56440000
564500                 IF NON-SPLR-PROV (SORT-REC-IDX)                  56450000
564600                   ADD +1 TO WS-SUM-RCD-CRTE-NO                   56460000
564700                 END-IF                                           56470000
564800                 IF NOT-USE-RECORD (SORT-REC-IDX)                 56480000
564900                   ADD +1 TO WS-RCD-NOT-PRTD-NO                   56490000
565000                 END-IF                                           56500000
565100              END-IF                                              56510000
565200           END-IF                                                 56520000
565300        END-PERFORM                                               56530000
565400        SET SORT-REC-IDX TO +1                                    56540000
565500        SET SUM27-TAX-NOT-ADDED TO TRUE                           56550000
565600     END-IF                                                       56560000
565700     .                                                            56570000
565800 B800-EXIT.                                                       56580000
565900     EXIT.                                                        56590000
566000                                                                  56600000
566100     EJECT                                                        56610000
566200***************************************************************** 56620000
566300*                B810-CALL-XIRI1050                             * 56630000
566400*                                                               * 56640000
566500*    THIS PARAGRAPH CALLS THE ACCUMULATE SUBTOTALS MODULE.      * 56650000
566600*                                                               * 56660000
566700***************************************************************** 56670000
566800 B810-CALL-XIRI1050 SECTION.                                      56680000
566900     MOVE 'B810' TO PROG-PAR-NO                                   56690000
567000     MOVE TB-SPLR TO SPLR-ID OF I1050LK1                          56700000
567100     MOVE CNTR-SUBTOT-TBL-ENTRIES OF I1005LK2                     56710000
567200       TO CNTR-SUBTOT-TBL-ENTRIES OF I1050LK1                     56720000
567300     CALL 'XIRI1050' USING I1050LK1, I1005LK2, I1000IND, Z9000LK1 56730000
567400                                                                  56740000
567500     EVALUATE ERRR-CD OF Z9000LK1                                 56750000
567600         WHEN LT-SUCCESSFUL                                       56760000
567700             CONTINUE                                             56770000
567800         WHEN OTHER                                               56780000
567900             SET DO-NOT-DISPLAY-STD-MSGS TO TRUE                  56790000
568000             MOVE ERRR-CD OF Z9000LK1 TO ERRR-CD OF E1000LK1      56800000
568100             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           56810000
568200     END-EVALUATE                                                 56820000
568300     .                                                            56830000
568400 B810-EXIT.                                                       56840000
568500     EXIT.                                                        56850000
568600                                                                  56860000
568700     EJECT                                                        56870000
568800***************************************************************** 56880000
568900*                B820-CALL-XIRI1060                             * 56890000
569000*                                                               * 56900000
569100*    THIS PARAGRAPH CALLS THE BUILD 015127 MODULE.              * 56910000
569200*                                                               * 56920000
569300***************************************************************** 56930000
569400 B820-CALL-XIRI1060 SECTION.                                      56940000
569500     MOVE 'B820' TO PROG-PAR-NO                                   56950000
569600     MOVE WS-APPLCN-RGN-ID TO APPLCN-RGN-ID OF I1060LK1           56960000
569700     MOVE RESTART-PROG-RETRY-NO TO RETRY-NO OF I1060LK1           56970000
569800     INITIALIZE I1005LK3                                          56980000
569900     CALL 'XIRI1060' USING I1060LK1,                              56990000
570000                           I1060LK2,                              57000000
570100                           I1005LK2,                              57010000
570200                           I1005LK3,                              57020000
570300                           I1000IND,                              57030000
570400                           Z9000LK1                               57040000
570500     EVALUATE ERRR-CD OF Z9000LK1                                 57050000
570600         WHEN LT-SUCCESSFUL                                       57060000
570700             PERFORM C300-UNLD-TBL THRU C300-EXIT                 57070000
570800               VARYING SORT-REC-IDX FROM 1 BY 1                   57080000
570900               UNTIL SORT-REC-IDX IS GREATER THAN                 57090000
571000                     CNTR-SRT-REC-TBL-ENTRIES                     57100000
571100                  OR SORT-REC-IDX IS GREATER THAN LT-1000-NUM     57110000
571200                  OR CNTR-SRT-REC-TBL-ENTRIES IS EQUAL TO ZEROES  57120000
571300         WHEN OTHER                                               57130000
571400             SET DO-NOT-DISPLAY-STD-MSGS TO TRUE                  57140000
571500             MOVE ERRR-CD OF Z9000LK1 TO ERRR-CD OF E1000LK1      57150000
571600             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           57160000
571700     END-EVALUATE                                                 57170000
571800     .                                                            57180000
571900 B820-EXIT.                                                       57190000
572000     EXIT.                                                        57200000
572100                                                                  57210000
572200     EJECT                                                        57220000
572300***************************************************************** 57230000
572400*                B830-CHECK-FI-CNTLS                            * 57240000
572500*                                                               * 57250000
572600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 57260000
572700*       1) WHEN THE SUMMARY OF CHARGES RECORD IS ENCOUNTERED,   * 57270000
572800*          IT'S AMOUNT IS CHECKED AGAINST THE TOTAL REVENUE     * 57280000
572900*          FROM THE MARKET SUMMARY RECORD.  IF THEY DON'T       * 57290000
573000*          BALANCE, WARNING ERRORS ARE POSTED UNTIL THE         * 57300000
573100*          THRESHOLD IS REACHED, THEN A FATAL ERROR IS POSTED.  * 57310000
573200*                                                               * 57320000
573300***************************************************************** 57330000
573400 B830-CHECK-FI-CNTLS SECTION.                                     57340000
573500     MOVE 'B830' TO PROG-PAR-NO                                   57350000
573600*** 951221-71   ALAN MASI  06/04/96 R961114 - PCS WIRELESS        57360000
573700*                                                                 57370000
573800* CHANGED 'IF' STMT TO NOT CHECK FOR SPLR-ID.  ALL CARRIERS CAN   57380000
573900* CHECK FOR SECT-CD1 = IR, SECT-CD2 = SC, SECT-CD3 = SPACES AND   57390000
574000* TRANSLATED-PHRASE-TYP = D.                                      57400000
574100*                                                                 57410000
574200     IF (SA-BILL-SECT-1 OF I1005LK3 (SORT-REC-IDX) = LT-IR AND    57420000
574300        SA-BILL-SECT-2 OF I1005LK3 (SORT-REC-IDX) = LT-SC AND     57430000
574400        SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX) = SPACES AND    57440000
574500        TRANSLATED-PHRASE-TYP OF I1005LK3(SORT-REC-IDX) = LT-D)   57450000
574600           MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)          57460000
574700             TO WS-E015127-HOLD                                   57470000
574800           IF BILL-AMT OF WS-E015127-HOLD = WS-TOT-REV            57480000
574900              CONTINUE                                            57490000
575000           ELSE                                                   57500000
575100              ADD +1 TO WS-FI-CNTLS-OUT-BAL                       57510000
575200              ADD +1 TO WS-OUTABAL-CNT                            57520000
575300              DISPLAY '***  FI CNTLS OUTABAL ***'                 57530000
575400              DISPLAY '   USG-ID         = ',                     57540000
575500                      USG-ID OF I1005LK3(SORT-REC-IDX)            57550000
575600              DISPLAY '   WS-PREV-USG-ID = ', WS-PREV-USG-ID      57560000
575700              MOVE    BILL-AMT OF WS-E015127-HOLD                 57570000
575800                TO    WS-DISPLAY-BILL-AMT                         57580000
575900              DISPLAY '   CALCULATED TOT-REV-AMT = ',             57590000
576000                      WS-DISPLAY-BILL-AMT                         57600000
576100              MOVE    WS-TOT-REV                                  57610000
576200                TO    WS-DISPLAY-BILL-AMT                         57620000
576300              DISPLAY '   015121     TOT-REV-AMT = ',             57630000
576400                      WS-DISPLAY-BILL-AMT                         57640000
576500              IF WS-FI-CNTLS-OUT-BAL = WS-TH-ERRR-NO              57650000
576600                 MOVE ERR-3974 TO ERRR-CD OF E1000LK1             57660000
576700                 MOVE SPACES  TO ERRR-DA OF E1000LK1              57670000
576800                 MOVE WS-FI-CNTLS-ERRR                            57680000
576900                   TO ERRR-DISPL-FLDS OF Z9000LK1 (1)             57690000
577000                 MOVE LT-FI-CNTLS-OUT-BAL TO WS-ERRR-LTRL         57700000
577100                 MOVE WS-FI-CNTLS-OUT-BAL TO WS-ERRR-VAL          57710000
577200                 MOVE WS-ERRR-DISPL                               57720000
577300                   TO ERRR-DISPL-FLDS OF Z9000LK1 (2)             57730000
577400              ELSE                                                57740000
577500                 MOVE ERR-3975 TO ERRR-CD OF E1000LK1             57750000
577600*** 950203-70  ALAN MASI  02/26/96  R960509                       57760000
577700*                                                                 57770000
577800* CHANGED TO USE USG-ID FROM I1005LK3 INSTEAD OF WS-PREV-USG-ID   57780000
577900*                                                                 57790000
578000                 MOVE USG-ID OF I1005LK3(SORT-REC-IDX)            57800000
578100                   TO TRNSCTN-ID OF E1000LK1                      57810000
578200                 MOVE +1 TO TRNSCTN-SEQ-NO OF E1000LK1            57820000
578300                 MOVE BILL-AMT OF WS-E015127-HOLD                 57830000
578400                   TO WS-DISPLAY-AMT                              57840000
578500                 MOVE WS-DISPLAY-AMT TO ERRR-DA OF E1000LK1       57850000
578600              END-IF                                              57860000
578700              IF ERRR-CD OF E1000LK1 = ERR-3975                   57870000
578800                  PERFORM E200-CHECK-FOR-DUPL-ERRR THRU E200-EXIT 57880000
578900              ELSE                                                57890000
579000                  PERFORM E100-PROCESS-ERRORS THRU E100-EXIT      57900000
579100              END-IF                                              57910000
579200              MOVE SPACES TO TRNSCTN-ID     OF E1000LK1           57920000
579300              MOVE ZEROES TO TRNSCTN-SEQ-NO OF E1000LK1           57930000
579400           END-IF                                                 57940000
579500     END-IF                                                       57950000
579600     .                                                            57960000
579700 B830-EXIT.                                                       57970000
579800     EXIT.                                                        57980000
579900                                                                  57990000
580000     EJECT                                                        58000000
580100***************************************************************** 58010000
580200*                B900-CREATE-WRAP-UP-RCD                        * 58020000
580300*                                                               * 58030000
580400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 58040000
580500*     1) FORMATS A WRAP UP RECORD AT THE END OF EACH INVOICE.   * 58050000
580600*        THIS RECORD IS THEN RELEASED TO THE SORT.  IT WILL     * 58060000
580700*        FLOAT TO THE TOP OF THE INVOICE SO THAT UPON RETURN    * 58070000
580800*        FROM THE SORT THESE VALUES WILL BE AVAILABLE           * 58080000
580900*        FOR THE INSERT TO XZ8USA1T                             * 58090000
581000*                                                               * 58100000
581100***************************************************************** 58110000
581200 B900-CREATE-WRAP-UP-RCD SECTION.                                 58120000
581300     MOVE 'B900' TO PROG-PAR-NO                                   58130000
581400     INITIALIZE WS-SRT-WRAPUP-RCD                                 58140000
581500     MOVE LT-WRAPUP          TO WS-SRT-RCD-ID                     58150000
581600     MOVE WS-PRIOR-USG-ID    TO WS-SRT-USG-ID                     58160000
581700     MOVE WS-FED-TX-AMT      TO WS-SRT-FED-TX-AMT                 58170000
581800     MOVE WS-SUM-RCD-CRTE-NO TO WS-SRT-SUM-RCD-CRTE-NO            58180000
581900     MOVE WS-RCD-NOT-PRTD-NO TO WS-SRT-RCD-NOT-PRTD-NO            58190000
582000     MOVE WS-LOC-ST-TX-AMT   TO WS-SRT-LOC-ST-TX-AMT              58200000
582100     MOVE WS-MSG-SURCHG-AMT  TO WS-SRT-MSG-SURCHG-AMT             58210000
582200     MOVE WS-TOT-REV         TO WS-SRT-TOT-REV-AMT                58220000
582300     MOVE WS-TOT-TX          TO WS-SRT-TOT-TX                     58230000
582400     IF CARD-ONLY                                                 58240000
582500         MOVE LT-C           TO WS-SRT-RVN-SCE-TYP-CD             58250000
582600     ELSE                                                         58260000
582700         MOVE SPACE          TO WS-SRT-RVN-SCE-TYP-CD             58270000
582800     END-IF                                                       58280000
582900     MOVE GID-EXPTD-BILL-DAT OF XIRI004Y                          58290000
583000       TO WS-SRT-NXT-BILL-DAT                                     58300000
583100     MOVE INIT-ASSN-TMSTMP   OF XIRI004Y                          58310000
583200       TO WS-SRT-INIT-ASSN-TMSTMP                                 58320000
583300     MOVE WS-SPLR-AREA      TO WS-SRT-SPLR-AREA                   58330000
583400*** EMER   04/17/96   ALAN MASI                                   58340000
583500*                                                                 58350000
583600* MOVE CONVERTED MA-BLG-NO TO WRAPUP RECORD TO BE USED AFTER      58360000
583700* SORTING.                                                        58370000
583800*                                                                 58380000
583900     MOVE HLD-CNVTD-MA-BLG-NO TO WS-SRT-CNVTD-MA-BLG-NO           58390000
584000*** R961212           SJWETEK                                     58400000
584100*                                                                 58410000
584200* MOVE INTER, INTRA-LTA-INV-INDR TO  RECORD TO BE USED AFTER      58420000
584300* SORTING.                                                        58430000
584400*                                                                 58440000
584500     MOVE WS-INTERLTA-INV-INDR TO WS-SRT-INTERLTA-INDR            58450000
584600     MOVE WS-INTRALTA-INV-INDR TO WS-SRT-INTRALTA-INDR            58460000
584700                                                                  58470000
584800     MOVE WS-TOTAL-WRELS-MSG-AMT TO WS-TOT-WRELS-MSG-AMT          58480000
584900     MOVE WS-TOTAL-WRELS-MSG-NO  TO WS-TOT-WRELS-MSG-NO           58490000
585000                                                                  58500000
585100     MOVE ZEROS TO WS-TOTAL-WRELS-MSG-AMT                         58510000
585200                   WS-TOTAL-WRELS-MSG-NO                          58520000
585300                                                                  58530000
585400     MOVE WS-SRT-WRAPUP-RCD TO SORT-RECORD                        58540000
585500     PERFORM R100-RLSE-RECORD THRU R100-EXIT                      58550000
585600     MOVE SUM21-TOT-REV TO WS-TOT-REV                             58560000
585700     .                                                            58570000
585800 B900-EXIT.                                                       58580000
585900     EXIT.                                                        58590000
586000                                                                  58600000
586100     EJECT                                                        58610000
586200***************************************************************** 58620000
586300*                C100-CALL-XIRZ1000                             * 58630000
586400*                                                               * 58640000
586500*    THIS PARAGRAPH CALLS THE DATE TIMESTAMP MODULE.  THIS WILL * 58650000
586600*    SEND BACK THE DATE TIMESTAMP THAT WILL BE USED THROUGHOUT  * 58660000
586700*    THE PROGRAM IN CALLS TO ALL CONTROL MODULES.               * 58670000
586800*                                                               * 58680000
586900***************************************************************** 58690000
587000 C100-CALL-XIRZ1000 SECTION.                                      58700000
587100     MOVE 'C100' TO PROG-PAR-NO                                   58710000
587200     CALL LT-XIRZ1000 USING Z1000LK1                              58720000
587300     MOVE RTRN-CD OF Z1000LK1 TO LT-ALPHA-RETURN-CODES            58730000
587400     EVALUATE LT-ALPHA-RETURN-CODES                               58740000
587500         WHEN LT-SUCCESSFUL                                       58750000
587600              CONTINUE                                            58760000
587700         WHEN OTHER                                               58770000
587800              MOVE RTRN-CD OF Z1000LK1 TO ERRR-CD OF E1000LK1     58780000
587900              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          58790000
588000     END-EVALUATE                                                 58800000
588100     .                                                            58810000
588200 C100-EXIT.                                                       58820000
588300     EXIT.                                                        58830000
588400                                                                  58840000
588500     EJECT                                                        58850000
588600***************************************************************** 58860000
588700*                C200-CALL-XIRI1005                             * 58870000
588800*                                                               * 58880000
588900*    THIS PARAGRAPH CALLS THE BUILD AND SORT INVOICES MODULE.   * 58890000
589000*                                                               * 58900000
589100***************************************************************** 58910000
589200 C200-CALL-XIRI1005 SECTION.                                      58920000
589300     MOVE 'C200' TO PROG-PAR-NO                                   58930000
589400     IF FINISH-PREVIOUS-INVOICE                                   58940000
589500        CONTINUE                                                  58950000
589600     ELSE                                                         58960000
589700        MOVE USG-ID OF TRMSN-ACPTNC-RCD TO USG-ID OF I1005LK1     58970000
589800                                           USG-ID OF I1060LK1     58980000
589900        MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                       58990000
590000          TO USG-SEQ-NO OF I1005LK1                               59000000
590100             WS-LAST-USG-SEQ-NO                                   59010000
590200        MOVE EMI-RCD OF TRMSN-ACPTNC-RCD                          59020000
590300                     TO EMI-RCD-AR OF I1005LK1                    59030000
590400     END-IF                                                       59040000
590500     CALL 'XIRI1005' USING I1005LK1,                              59050000
590600                           I1005LK2,                              59060000
590700                           I1005LK3,                              59070000
590800                           I1000IND,                              59080000
590900                           Z9000LK1                               59090000
591000     EVALUATE ERRR-CD OF Z9000LK1                                 59100000
591100        WHEN LT-SUCCESSFUL                                        59110000
591200           MOVE SPACES TO MDLE-ID OF Z9000LK1                     59120000
591300        WHEN OTHER                                                59130000
591400           IF ERRR-CD OF Z9000LK1 = ERR-3977                      59140000
591500              ADD +1 TO WS-NOPR-ERRR-CNT                          59150000
591600              IF WS-NOPR-ERRR-CNT = WS-TH-ERRR-NO                 59160000
591700                 MOVE ERR-3978   TO ERRR-CD OF E1000LK1           59170000
591800              ELSE                                                59180000
591900                 MOVE ERRR-CD        OF Z9000LK1                  59190000
592000                   TO ERRR-CD        OF E1000LK1                  59200000
592100                 MOVE USG-ID         OF I1005LK1                  59210000
592200                   TO TRNSCTN-ID     OF E1000LK1                  59220000
592300                 MOVE USG-SEQ-NO     OF I1005LK1                  59230000
592400                   TO TRNSCTN-SEQ-NO OF E1000LK1                  59240000
592500              END-IF                                              59250000
592600           ELSE                                                   59260000
592700              MOVE ERRR-CD OF Z9000LK1                            59270000
592800                TO ERRR-CD OF E1000LK1                            59280000
592900           END-IF                                                 59290000
593000           MOVE SPACES  TO ERRR-DA OF E1000LK1                    59300000
593100           IF ERRR-CD OF E1000LK1 = ERR-3977                      59310000
593200              PERFORM E200-CHECK-FOR-DUPL-ERRR THRU E200-EXIT     59320000
593300           ELSE                                                   59330000
593400              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          59340000
593500           END-IF                                                 59350000
593600           MOVE SPACES TO ERRR-CD        OF Z9000LK1              59360000
593700           MOVE SPACES TO TRNSCTN-ID     OF E1000LK1              59370000
593800           MOVE ZEROES TO TRNSCTN-SEQ-NO OF E1000LK1              59380000
593900     END-EVALUATE                                                 59390000
594000     .                                                            59400000
594100 C200-EXIT.                                                       59410000
594200     EXIT.                                                        59420000
594300                                                                  59430000
594400     EJECT                                                        59440000
594500***************************************************************** 59450000
594600*                C300-UNLD-TBL                                  * 59460000
594700*                                                               * 59470000
594800*    THIS PARAGRAPH CALLS THE ROUTINE TO RELEASE RECORDS TO THE * 59480000
594900*    SORT UTILITY, UNLESS THEY ARE CREATED BY USW AND MARKED AS * 59490000
595000*    NOT USABLE.                                                * 59500000
595100*                                                               * 59510000
595200***************************************************************** 59520000
595300 C300-UNLD-TBL SECTION.                                           59530000
595400     MOVE 'C300' TO PROG-PAR-NO                                   59540000
595500     IF NON-SPLR-PROV (SORT-REC-IDX) AND                          59550000
595600        NOT-USE-RECORD (SORT-REC-IDX)                             59560000
595700         CONTINUE                                                 59570000
595800     ELSE                                                         59580000
595900         IF USE-RECORD-INDR  OF I1005LK3 (SORT-REC-IDX) = LT-Y    59590000
596000             ADD +1  TO WS-USA2-PRNTBLE-RECS                      59600000
596100         END-IF                                                   59610000
596200         MOVE SORT-REC-TABLE (SORT-REC-IDX) TO WS-SORT-RECORD     59620000
596300         MOVE WS-TOT-IN-FILE-CNT            TO WS-SORT-RCD-IN-CNT 59630000
596400         MOVE WS-TEMP-SORT-RECORD           TO SORT-RECORD        59640000
596500         PERFORM R100-RLSE-RECORD THRU R100-EXIT                  59650000
596600     END-IF                                                       59660000
596700     .                                                            59670000
596800 C300-EXIT.                                                       59680000
596900     EXIT.                                                        59690000
597000                                                                  59700000
597100     EJECT                                                        59710000
597200***************************************************************** 59720000
597300*                C400-CALL-XIRZA000                             * 59730000
597400*                                                               * 59740000
597500*    THIS PARAGRAPH CALLS THE JOURNAL MODULE.                   * 59750000
597600*                                                               * 59760000
597700***************************************************************** 59770000
597800 C400-CALL-XIRZA000 SECTION.                                      59780000
597900     MOVE 'C400' TO PROG-PAR-NO                                   59790000
598000     MOVE LT-D                       TO RUN-TYPE   OF ZA000LK1    59800000
598100     MOVE WS-PROGRAM-NAME-LIT        TO PROG-ID    OF ZA000LK1    59810000
598200     MOVE WS-CURR-SPLR               TO SPLR-ID    OF ZA000LK1    59820000
598300     MOVE USG-ID OF TRMSN-ACPTNC-RCD TO USG-ID     OF ZA000LK1    59830000
598400*** TR#181443   ALAN MASI  10/28/96 R961114                       59840000
598500*                                                                 59850000
598600* CHANGED TO MOVE THE BILL-ORD-SEQ-NO THAT WAS WRITTEN TO         59860000
598700* USA2 TO ALSO BE WRITTEN TO XYTRVA1T.                            59870000
598800*                                                                 59880000
598900     MOVE WS-BILL-SEQ-NO             TO USG-SEQ-NO OF ZA000LK1    59890000
599000*** TR#181311   ALAN MASI  10/28/96 R961114                       59900000
599100*                                                                 59910000
599200* ADDED CODE TO PASS THE BLG-RAO TO XIRZA000                      59920000
599300*                                                                 59930000
599400     MOVE BILL-RAO OF TRMSN-ACPTNC-RCD TO BLG-RAO  OF ZA000LK1    59940000
599500     MOVE EMI-RCD  OF TRMSN-ACPTNC-RCD TO EMI-RCD  OF ZA000LK1    59950000
599600                                                                  59960000
599700     CALL LT-XIRZA000 USING ZA000LK1, C4000LK1                    59970000
599800                                                                  59980000
599900     EVALUATE RTRN-CD OF ZA000LK1                                 59990000
600000         WHEN ZEROS                                               60000000
600100             CONTINUE                                             60010000
600200         WHEN OTHER                                               60020000
600300             MOVE PARA-NO  OF ZA000LK1 TO PROG-PAR-NO OF Z9000LK1 60030000
600400             MOVE RTRN-CD  OF ZA000LK1 TO ERRR-CD OF E1000LK1     60040000
600500             MOVE SQLCA-AR OF ZA000LK1 TO CMMN-SQLCA OF Z9000LK1  60050000
600600             MOVE VW-NM    OF ZA000LK1 TO VW-NM OF Z9000LK1       60060000
600700             MOVE SPLR-ID  OF ZA000LK1 TO SPLR-ID OF E1000LK1     60070000
600800             MOVE SPACES               TO TRNSCTN-ID OF E1000LK1  60080000
600900             MOVE ZEROES             TO TRNSCTN-SEQ-NO OF E1000LK160090000
601000             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           60100000
601100     END-EVALUATE                                                 60110000
601200     .                                                            60120000
601300 C400-EXIT.                                                       60130000
601400     EXIT.                                                        60140000
601500     EJECT                                                        60150000
601600***************************************************************** 60160000
601700*                C500-CALL-XIRZB000                             * 60170000
601800*                                                               * 60180000
601900*    THIS PARAGRAPH CALLS THE PTN ID MODULE.                    * 60190000
602000*                                                               * 60200000
602100***************************************************************** 60210000
602200 C500-CALL-XIRZB000 SECTION.                                      60220000
602300     IF USG-ID OF TRMSN-ACPTNC-RCD = WS-PREV-USG-ID-4-ZB          60230000
602400        GO TO C500-EXIT                                           60240000
602500     END-IF.                                                      60250000
602600                                                                  60260000
602700     MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-PREV-USG-ID-4-ZB.      60270000
602800     MOVE WS-CURR-SPLR TO SPLR-ID OF ZB000LK1.                    60280000
602900                                                                  60290000
603000     CALL LT-XIRZB000 USING ZB000LK1,                             60300000
603100                            Z9000LK1.                             60310000
603200                                                                  60320000
603300     IF RTRN-CD OF ZB000LK1 = ZEROES                              60330000
603400        CONTINUE                                                  60340000
603500     ELSE                                                         60350000
603600        MOVE LT-XIRZB000 TO MDLE-ID OF Z9000LK1                   60360000
603700        MOVE RTRN-CD OF ZB000LK1                                  60370000
603800          TO ERRR-CD OF E1000LK1                                  60380000
603900        MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-ERRR-USG-ID         60390000
604000        MOVE WS-USG-ID-ERRR                                       60400000
604100          TO ERRR-DISPL-FLDS(1)                                   60410000
604200        MOVE 'ERROR IN XIRZB000'                                  60420000
604300          TO ERRR-DISPL-FLDS(2)                                   60430000
604400        MOVE WS-CURR-SPLR                                         60440000
604500          TO SPLR-ID OF E1000LK1                                  60450000
604600        MOVE SPACES TO TRNSCTN-ID OF E1000LK1                     60460000
604700                       VW-NM      OF Z9000LK1                     60470000
604800        PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                60480000
604900     END-IF.                                                      60490000
605000                                                                  60500000
605100     MOVE PTN-ID OF ZB000LK1         TO WS-PTN-ID.                60510000
605200                                                                  60520000
605300 C500-EXIT.                                                       60530000
605400     EXIT.                                                        60540000
605500     EJECT                                                        60550000
605600**** TR# 138943   ALAN MASI  04/12/95                             60560000
605700*                                                                 60570000
605800* ADDED CODE TO CHECK THAT THE TOT-REV-AMT ON THE USA1 TABLE      60580000
605900* IS EQUAL TO THE SUM OF TOT-EXCL-TX-AMT, FED-TX-AMT,             60590000
606000* LOC-ST-TX-AMT, AND MSG-SURCHG-AMT OF SAME RECORD.               60600000
606100*                                                                 60610000
606200***************************************************************** 60620000
606300*                D100-COMPARE-USA1-TOTALS                       * 60630000
606400*                                                               * 60640000
606500*    THIS COMPARES USA1 TOTALS TO MAKE SURE THE TOT-REV-AMT IS  * 60650000
606600*    EQUAL TO THE SUM OF TOT-EXCL-TX-AMT, FED-TX-AMT, LOC-ST-   * 60660000
606700*    TX-AMT, AND MSG-SURCHG-AMT.  IF NOT, AN ERROR IS GENERATED * 60670000
606800*    BUT THE PROGRAM WONT ABEND UNTIL THE TRESHOLD HAS BEEN     * 60680000
606900*    REACHED.  A NEW UNITECH RULE HAS BEEN CREATED TO INFORM THE* 60690000
607000*    PROGRAMMER IN THE EVENT ANY OF THESE ERRORS ARE FOUND.     * 60700000
607100*                                                               * 60710000
607200***************************************************************** 60720000
607300 D100-COMPARE-USA1-TOTALS SECTION.                                60730000
607400     MOVE 'D100' TO PROG-PAR-NO                                   60740000
607500                                                                  60750000
607600     COMPUTE WS-TOTAL-REV = TOT-EXCL-TX-AMT OF XIRI004Y +         60760000
607700                            FED-TX-AMT      OF XIRI004Y +         60770000
607800                            LOC-ST-TX-AMT   OF XIRI004Y +         60780000
607900                            MSG-SURCHG-AMT  OF XIRI004Y           60790000
608000     END-COMPUTE.                                                 60800000
608100                                                                  60810000
608200*** TR# 159808  02/13/96  ALAN MASI  R960314                      60820000
608300*                                                                 60830000
608400* CHANGED TO USE WS-USA1-TOT-REV INSTEAD OF TOT-REV-AMT OF        60840000
608500* XIRI004Y BECAUSE SOMETIMES UPON A RESTART XIRI004Y IS NOT       60850000
608600* RESTORED BUT WS-USA1-TOT-REV IS.                                60860000
608700*                                                                 60870000
608800     IF WS-TOTAL-REV = WS-USA1-TOT-REV                            60880000
608900        CONTINUE                                                  60890000
609000     ELSE                                                         60900000
609100        DISPLAY WS-OUTABAL-MSG-1                                  60910000
609200        DISPLAY WS-OUTABAL-MSG-2                                  60920000
609300        DISPLAY WS-OUTABAL-MSG-3                                  60930000
609400        MOVE USG-ID OF XIRI004Y     TO WS-OUTABAL-USG-ID          60940000
609500        MOVE USG-SEQ-NO OF XIRI004Y TO WS-OUTABAL-USG-SEQ-NO      60950000
609600        DISPLAY WS-OUTABAL-MSG-4                                  60960000
609700        MOVE WS-USA1-TOT-REV             TO WS-DISPLAY-BILL-AMT   60970000
609800        DISPLAY '    WS-USA1-TOT-REV = ' WS-DISPLAY-BILL-AMT      60980000
609900        MOVE TOT-REV-AMT OF XIRI004Y     TO WS-DISPLAY-BILL-AMT   60990000
610000        DISPLAY '    TOT-REV-AMT     = ' WS-DISPLAY-BILL-AMT      61000000
610100        MOVE TOT-EXCL-TX-AMT OF XIRI004Y TO WS-DISPLAY-BILL-AMT   61010000
610200        DISPLAY '    TOT-EXCL-TX-AMT = ' WS-DISPLAY-BILL-AMT      61020000
610300        MOVE FED-TX-AMT      OF XIRI004Y TO WS-DISPLAY-BILL-AMT   61030000
610400        DISPLAY '    FED-TAX-AMT     = ' WS-DISPLAY-BILL-AMT      61040000
610500        MOVE LOC-ST-TX-AMT   OF XIRI004Y TO WS-DISPLAY-BILL-AMT   61050000
610600        DISPLAY '    LOC-ST-TX-AMT   = ' WS-DISPLAY-BILL-AMT      61060000
610700        MOVE MSG-SURCHG-AMT  OF XIRI004Y TO WS-DISPLAY-BILL-AMT   61070000
610800        DISPLAY '    MSG-SURCHG-AMT  = ' WS-DISPLAY-BILL-AMT      61080000
610900        ADD +1 TO WS-OUTABAL-CNT                                  61090000
611000        IF WS-OUTABAL-CNT = WS-TH-ERRR-NO                         61100000
611100           MOVE ERR-3974 TO ERRR-CD OF E1000LK1                   61110000
611200           MOVE SPACES  TO ERRR-DA OF E1000LK1                    61120000
611300           MOVE WS-OUTABAL-MSG-1                                  61130000
611400             TO ERRR-DISPL-FLDS OF Z9000LK1(1)                    61140000
611500           MOVE WS-OUTABAL-MSG-2                                  61150000
611600             TO ERRR-DISPL-FLDS OF Z9000LK1(2)                    61160000
611700           MOVE WS-OUTABAL-MSG-3                                  61170000
611800             TO ERRR-DISPL-FLDS OF Z9000LK1(3)                    61180000
611900        ELSE                                                      61190000
612000           MOVE ERR-3975 TO ERRR-CD OF E1000LK1                   61200000
612100           MOVE USG-ID OF XIRI004Y TO TRNSCTN-ID OF E1000LK1      61210000
612200           MOVE USG-SEQ-NO OF XIRI004Y                            61220000
612300             TO TRNSCTN-SEQ-NO OF E1000LK1                        61230000
612400           MOVE SPACES TO ERRR-DA OF E1000LK1                     61240000
612500        END-IF                                                    61250000
612600        IF ERRR-CD OF E1000LK1 = ERR-3975                         61260000
612700           PERFORM E200-CHECK-FOR-DUPL-ERRR THRU E200-EXIT        61270000
612800        ELSE                                                      61280000
612900           PERFORM E100-PROCESS-ERRORS THRU E100-EXIT             61290000
613000        END-IF                                                    61300000
613100        MOVE SPACES TO TRNSCTN-ID     OF E1000LK1                 61310000
613200        MOVE ZEROES TO TRNSCTN-SEQ-NO OF E1000LK1                 61320000
613300     END-IF.                                                      61330000
613400                                                                  61340000
613500 D100-EXIT.                                                       61350000
613600     EXIT.                                                        61360000
613700     EJECT                                                        61370000
613800***************************************************************** 61380000
613900*                E100-PROCESS-ERRORS                            * 61390000
614000*                                                               * 61400000
614100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 61410000
614200*       1. CALL ERROR ROUTINE AND IF IT DOESN'T RUN PROPERLY    * 61420000
614300*          PUT IT'S SQL AREA IN THE ABEND LINKAGE.              * 61430000
614400*       2. CALL ABEND ROUTINE IF THE ERROR IS SEVERE.           * 61440000
614500*                                                               * 61450000
614600***************************************************************** 61460000
614700 E100-PROCESS-ERRORS SECTION.                                     61470000
614800     PERFORM E110-CALL-ERRORS THRU E110-EXIT                      61480000
614900     MOVE RTRN-CD OF E1000LK1 TO LT-ALPHA-RETURN-CODES.           61490000
615000     EVALUATE LT-ALPHA-RETURN-CODES                               61500000
615100        WHEN LT-SUCCESSFUL                                        61510000
615200           MOVE SPACES TO ERRR-SQLCA OF Z9000LK1                  61520000
615300        WHEN OTHER                                                61530000
615400           MOVE ERRR-SQLCA OF E1000LK1                            61540000
615500             TO ERRR-SQLCA OF Z9000LK1                            61550000
615600     END-EVALUATE                                                 61560000
615700     IF FATAL                                                     61570000
615800        PERFORM Z000-MODULE-ABEND THRU Z000-EXIT                  61580000
615900     END-IF                                                       61590000
616000     .                                                            61600000
616100 E100-EXIT.                                                       61610000
616200     EXIT.                                                        61620000
616300                                                                  61630000
616400     EJECT                                                        61640000
616500***************************************************************** 61650000
616600*                E110-CALL-ERRORS                               * 61660000
616700*                                                               * 61670000
616800*    THIS PARAGRAPH CALLS THE ERROR TRACKER MODULE.             * 61680000
616900*                                                               * 61690000
617000***************************************************************** 61700000
617100 E110-CALL-ERRORS SECTION.                                        61710000
617200     MOVE WS-CURR-PRCSS-CY-DAT TO CURR-PRCSS-CY-DAT OF E1000LK1   61720000
617300     MOVE WS-CURR-SPLR         TO SPLR-ID           OF E1000LK1   61730000
617400     MOVE LT-XIRI1000          TO PROG-ID           OF E1000LK1   61740000
617500     MOVE LT-REGENTRY          TO FUNC-ID           OF E1000LK1   61750000
617600     CALL LT-XIRE1000 USING E1000LK1                              61760000
617700     .                                                            61770000
617800 E110-EXIT.                                                       61780000
617900     EXIT.                                                        61790000
618000                                                                  61800000
618100     EJECT                                                        61810000
618200***************************************************************** 61820000
618300*                E200-CHECK-FOR-DUPL-ERRR                       * 61830000
618400*                                                               * 61840000
618500*    THIS PARAGRAPH PERFORMS A SELECT ON THE ERROR REPOSITORY   * 61850000
618600*    TO CHECK IF THIS ERROR HAS ALREADY BEEN POSTED (RESTART    * 61860000
618700*    SITUATION).  IF IT HAS NOT THEN THE ERRORS ROUTINE IS      * 61870000
618800*    CALLED.                                                    * 61880000
618900*                                                               * 61890000
619000***************************************************************** 61900000
619100 E200-CHECK-FOR-DUPL-ERRR SECTION.                                61910000
619200     MOVE ZEROES                 TO WS-DUPL-ERRR-COUNT            61920000
619300     MOVE TRNSCTN-ID OF E1000LK1 TO TRNSCTN-ID OF XIRI033Y        61930000
619400     MOVE ERRR-CD    OF E1000LK1 TO ERRR-CD    OF XIRI033Y        61940000
619500     PERFORM E210-SEARCH-ERRR THRU E210-EXIT                      61950000
619600     INITIALIZE WS-RETRY-CNT                                      61960000
619700     SET LOCKED-OUT  TO TRUE                                      61970000
619800     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           61980000
619900          OR NOT LOCKED                                           61990000
620000        EXEC SQL                                                  62000000
620100            INCLUDE XIRI33S1                                      62010000
620200        END-EXEC                                                  62020000
620300        ADD +1       TO WS-RETRY-CNT                              62030000
620400        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         62040000
620500     END-PERFORM                                                  62050000
620600     EVALUATE SQLCODE                                             62060000
620700        WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES              62070000
620800           IF WS-DUPL-ERRR-COUNT = ZERO                           62080000
620900              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          62090000
621000           END-IF                                                 62100000
621100           MOVE SPACES TO TRNSCTN-ID     OF E1000LK1              62110000
621200           MOVE ZEROES TO TRNSCTN-SEQ-NO OF E1000LK1              62120000
621300        WHEN OTHER                                                62130000
621400           MOVE ERR-3999    TO ERRR-CD   OF E1000LK1              62140000
621500           MOVE LT-XIRI033Y TO VW-NM     OF Z9000LK1              62150000
621600           MOVE SQLCA       TO SQLCA-AR  OF Z9000LK1              62160000
621700           PERFORM E100-PROCESS-ERRORS THRU E100-EXIT             62170000
621800     END-EVALUATE                                                 62180000
621900     .                                                            62190000
622000 E200-EXIT.                                                       62200000
622100     EXIT.                                                        62210000
622200                                                                  62220000
622300     EJECT                                                        62230000
622400***************************************************************** 62240000
622500*                E210-SEARCH-ERRR                               * 62250000
622600*                                                               * 62260000
622700*    THIS PARAGRAPH SEARCHES THE INTERNAL/EXTERNAL ERROR TABLE  * 62270000
622800*    FOR A MATCH ON THE ERROR THAT IS BEING CHECKED FOR ON DSA2.* 62280000
622900*    IF A MATCH IS FOUND IT MUST BE CONVERTED TO THE EXTERNAL   * 62290000
623000*    ERROR CODE IN ORDER FOR THE PREVIOUS ROUTINE TO FIND IT ON * 62300000
623100*    DSA2T.                                                     * 62310000
623200*                                                               * 62320000
623300***************************************************************** 62330000
623400 E210-SEARCH-ERRR SECTION.                                        62340000
623500     PERFORM                                                      62350000
623600       VARYING WS-ERRR-IDX FROM 1 BY 1                            62360000
623700       UNTIL                                                      62370000
623800          ERRR-CD OF XIRI033Y = WS-INTRNL-ERRR-CD(WS-ERRR-IDX) OR 62380000
623900          WS-INTRNL-ERRR-CD(WS-ERRR-IDX) = SPACES              OR 62390000
624000          WS-ERRR-IDX > LT-50-NUM                                 62400000
624100     END-PERFORM                                                  62410000
624200     IF WS-INTRNL-ERRR-CD(WS-ERRR-IDX) = SPACES OR                62420000
624300        WS-ERRR-IDX > LT-50-NUM                                   62430000
624400         CONTINUE                                                 62440000
624500     ELSE                                                         62450000
624600         MOVE WS-ERRR-CD (WS-ERRR-IDX) TO ERRR-CD OF XIRI033Y     62460000
624700     END-IF                                                       62470000
624800     .                                                            62480000
624900 E210-EXIT.                                                       62490000
625000     EXIT.                                                        62500000
625100                                                                  62510000
625200     EJECT                                                        62520000
625300***************************************************************** 62530000
625400*                I100-INSERT-XZ8USA1T                           * 62540000
625500*                                                               * 62550000
625600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 62560000
625700*      1. FORMAT THE XZ8USA1T LAYOUT WITH VALUES FROM THE SUM21 * 62570000
625800*         RECORD.                                               * 62580000
625900*      2. INSERT XZ8USA1T RECORD.                               * 62590000
626000*                                                               * 62600000
626100***************************************************************** 62610000
626200 I100-INSERT-XZ8USA1T SECTION.                                    62620000
626300     MOVE 'I100' TO PROG-PAR-NO                                   62630000
626400     MOVE SPACES TO WS-SPLR-INTRNL-ACC-NO-VAL                     62640000
626500     MOVE TB-SPLR TO WS-SPLR-ID                                   62650000
626600     EVALUATE TRUE                                                62660000
626700         WHEN SUBSCR-PRFX-AND-ACCT-NO                             62670000
626800              STRING SUBSCRBR-NO-PREFIX DELIMITED BY SIZE         62680000
626900                     SUM21-ACCT-NO      DELIMITED BY SIZE         62690000
627000              INTO WS-SPLR-INTRNL-ACC-NO-VAL                      62700000
627100              MOVE WS-SPLR-INTRNL-ACC-NO-VAL TO                   62710000
627200                      SPLR-INTRNL-ACC-NO OF XIRI004Y              62720000
627300         WHEN ACCT-NO-AND-DIV-ID                                  62730000
627400              STRING SUM21-ACCT-NO DELIMITED BY SIZE              62740000
627500                     SUM21-DIV-ID  DELIMITED BY SIZE              62750000
627600              INTO WS-SPLR-INTRNL-ACC-NO-VAL                      62760000
627700              MOVE WS-SPLR-INTRNL-ACC-NO-VAL TO                   62770000
627800                      SPLR-INTRNL-ACC-NO OF XIRI004Y              62780000
627900         WHEN ACCT-NO-AND-VZW-9-15                                62790000
628000              STRING SUM21-ACCT-NO DELIMITED BY SIZE              62800000
628100                   SUM21-VZW-ACCT-NO-9-15 DELIMITED BY SIZE       62810000
628200              INTO WS-SPLR-INTRNL-ACC-NO-VAL                      62820000
628300              MOVE WS-SPLR-INTRNL-ACC-NO-VAL TO                   62830000
628400                      SPLR-INTRNL-ACC-NO OF XIRI004Y              62840000
628500                                                                  62850000
628600              MOVE SUM21-OBLIG-ID      TO WS-SUM21-OBLIG-ID       62860000
628700              MOVE SUM21-MAJOR-MRKT    TO WS-SUM21-MAJOR-MRKT     62870000
628800              MOVE WS-SUM21-OB-ID2     TO WS-MAJOR-MRKT-OBID2     62880000
628900              MOVE WS-SUM21-MAJOR-MRKT TO WS-MAJOR-MRKT-OBID3     62890000
629000              MOVE WS-SUM21-OB-ID4     TO WS-MAJOR-MRKT-OBID4     62900000
629100              MOVE WS-MAJOR-MRKT-OBID-NO                          62910000
629200                                       TO MAJOR-MRKT-OBID-NO      62920000
629300                                       OF XIRI004Y                62930000
629400                                                                  62940000
629500         WHEN ONLY-ACCT-NO                                        62950000
629600              MOVE SUM21-ACCT-NO TO                               62960000
629700                      SPLR-INTRNL-ACC-NO OF XIRI004Y              62970000
629800         WHEN OTHER                                               62980000
629900              MOVE SUM21-ACCT-NO TO                               62990000
630000                      SPLR-INTRNL-ACC-NO OF XIRI004Y              63000000
630100     END-EVALUATE.                                                63010000
630200     MOVE ZEROES TO WS-COUNT-XIRI005V.                            63020000
630300*                                                                 63030000
630400* R090416 CODE CHANGES                                            63040000
630500*                                                                 63050000
630600     IF INS-VZW-FST-TM-INV                                        63060000
630700       MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)              63070000
630800         TO EXCH-MSG-INTFC-DA OF XIRI003Y                         63080000
630900       MOVE SUM21-VZW-FST-TM-INV                                  63090000
631000         TO FST-TM-INV-INDR OF XIRI004Y                           63100000
631100*                                                                 63110000
631200     ELSE                                                         63120000
631300       IF INS-FST-TM-INV-INDR                                     63130000
631400         MOVE FST-TM-INV                                          63140000
631500           TO FST-TM-INV-INDR OF XIRI004Y                         63150000
631600        ELSE                                                      63160000
631700           MOVE SPACE                                             63170000
631800             TO FST-TM-INV-INDR OF XIRI004Y                       63180000
631900        END-IF                                                    63190000
632000     END-IF                                                       63200000
632100*                                                                 63210000
632200     EVALUATE TRUE                                                63220000
632300         WHEN TB-SORT-INPUT                                       63230000
632400              MOVE USG-ID OF SORT-REC-TABLE (SORT-REC-IDX)        63240000
632500                TO USG-ID OF XIRI004Y                             63250000
632600                   WS-CURR-USG-ID                                 63260000
632700              MOVE USG-SEQ-NO OF SORT-REC-TABLE (SORT-REC-IDX)    63270000
632800                TO USG-SEQ-NO OF XIRI004Y                         63280000
632900         WHEN OTHER                                               63290000
633000              MOVE USG-ID OF TRMSN-ACPTNC-RCD                     63300000
633100                TO USG-ID OF XIRI004Y                             63310000
633200                   WS-CURR-USG-ID                                 63320000
633300              MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD                 63330000
633400                TO USG-SEQ-NO OF XIRI004Y                         63340000
633500     END-EVALUATE                                                 63350000
633600     PERFORM C500-CALL-XIRZB000                                   63360000
633700        THRU C500-EXIT.                                           63370000
633800     MOVE WS-CURR-SPLR TO SPLR-ID OF XIRI004Y                     63380000
633900     MOVE SUM21-DIV-ID TO EXCH-MSG-DIV-ID OF XIRI004Y             63390000
634000     MOVE WS-PTN-ID    TO PTN-ID OF XIRI004Y                      63400000
634100***  EMER   ALAN MASI   03/18/96                                  63410000
634200*                                                                 63420000
634300* MOVE CONVERTED SUM21-MA-BLG-NO TO USA1                          63430000
634400*                                                                 63440000
634500     MOVE HLD-CNVTD-MA-BLG-NO TO EXCH-MSG-BLG-NO OF XIRI004Y      63450000
634600                                 WS-EXCH-MSG-BLG                  63460000
634700     MOVE SUM21-CUST-CD TO EXCH-MSG-CUST-CD OF XIRI004Y           63470000
634800     MOVE WS-SPLR-AREA TO SPLR-INTRNL-SER-ID OF XIRI004Y          63480000
634900     MOVE SUM21-BLG-RAO TO BILL-ACCTG-OFC-CD OF XIRI004Y          63490000
635000     MOVE SUM21-SENT-TO-RAO TO SND-ACCTG-OFC-CD OF XIRI004Y       63500000
635100                                                                  63510000
635200     IF YES-WIRELESS-STATION                                      63520000
635300         MOVE WRLSS-TOT-NO-STATIONS                               63530000
635400          TO  EXCH-WRLSS-TOT-STA OF XIRI004Y                      63540000
635500     END-IF                                                       63550000
635600                                                                  63560000
635700                                                                  63570000
635800     EVALUATE TRUE                                                63580000
635900         WHEN PRTNR-CUST-TYP                                      63590000
636000              MOVE BLG-PRTNR-CUST-TYP                             63600000
636100               TO BLG-PRTNR-ACCT-TYP OF XIRI004Y                  63610000
636200         WHEN PRTNR-SBSCRBR-CON                                   63620000
636300              MOVE SBSCRBR-CON                                    63630000
636400               TO BLG-PRTNR-ACCT-TYP OF XIRI004Y                  63640000
636500         WHEN OTHER                                               63650000
636600              MOVE SPACES                                         63660000
636700               TO BLG-PRTNR-ACCT-TYP OF XIRI004Y                  63670000
636800     END-EVALUATE                                                 63680000
636900                                                                  63690000
637000                                                                  63700000
637100     IF AFLT-TRNSCTN-IND-YES                                      63710000
637200         IF AFLT-TRNSCTN-IND OF E015121  = LT-1                   63720000
637300            MOVE LT-Y TO AFLT-TRNSCTN-IND OF XIRI004Y             63730000
637400         ELSE                                                     63740000
637500            MOVE SPACE TO AFLT-TRNSCTN-IND OF XIRI004Y            63750000
637600         END-IF                                                   63760000
637700     ELSE                                                         63770000
637800         MOVE SPACE TO AFLT-TRNSCTN-IND OF XIRI004Y               63780000
637900     END-IF.                                                      63790000
638000                                                                  63800000
638100     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT                    63810000
638200     SET UPPER-CASE     OF DTFMT TO TRUE                          63820000
638300     SET USER-SPECIFIED OF DTFMT TO TRUE                          63830000
638400     MOVE SUM21-ERLST-MSG-DAT TO DF-YYMMDD OF DTFMT               63840000
638500     CALL DATETIME USING DTFMT                                    63850000
638600     IF FB-ERROR OF DTFMT                                         63860000
638700       MOVE DATETIME-ERR        TO ERRR-CD OF E1000LK1            63870000
638800       MOVE 'DATETIME ERR '     TO WS-ERRR-LTRL                   63880000
638900       MOVE SUM21-ERLST-MSG-DAT TO WS-ERRR-VAL                    63890000
639000       MOVE WS-ERRR-DISPL       TO                                63900000
639100                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  63910000
639200       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 63920000
639300     END-IF                                                       63930000
639400     MOVE DF-YYYY-MM-DD OF DTFMT                                  63940000
639500                     TO EXCH-MSG-ERLY-DAT OF XIRI004Y             63950000
639600     MOVE SUM21-OBLIG-ID TO EXCH-MSG-OBLGTN-ID OF XIRI004Y        63960000
639700     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT                    63970000
639800     SET UPPER-CASE     OF DTFMT TO TRUE                          63980000
639900     SET USER-SPECIFIED OF DTFMT TO TRUE                          63990000
640000     MOVE SUM21-EXTC-DAT TO DF-YYMMDD OF DTFMT                    64000000
640100     CALL DATETIME USING DTFMT                                    64010000
640200     IF FB-ERROR OF DTFMT                                         64020000
640300       MOVE DATETIME-ERR       TO ERRR-CD OF E1000LK1             64030000
640400       MOVE 'DATETIME ERR '    TO WS-ERRR-LTRL                    64040000
640500       MOVE SUM21-EXTC-DAT     TO WS-ERRR-VAL                     64050000
640600       MOVE WS-ERRR-DISPL TO                                      64060000
640700                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  64070000
640800       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 64080000
640900     END-IF                                                       64090000
641000     MOVE DF-YYYY-MM-DD OF DTFMT                                  64100000
641100                        TO EXCH-MSG-CRTE-DAT OF XIRI004Y          64110000
641200     MOVE SUM21-TOT-MSG TO TOT-MSG-NO OF XIRI004Y                 64120000
641300                                                                  64130000
641400*BGN MCR970317-70A                                                64140000
641500     IF DONT-POP-TAX-USG-ID                                       64150000
641600       MOVE SUM21-TOT-DMSTC-REV TO TOT-DMSTC-RVN OF XIRI004Y      64160000
641700       MOVE SUM21-TOT-DMSTC-CRD-REV TO                            64170000
641800            TOT-DMSTC-CLG-CRD OF XIRI004Y                         64180000
641900       MOVE LT-DFLT-TMSTMP TO TAX-USG-ID OF XIRI004Y              64190000
642000     ELSE                                                         64200000
642100* USA5 USG-ID NEEDS TO BE POPULATED FOR VZW AND ICE ENF INVOICES  64210000
642200* FOR THE TAX-USG-ID. THE ENA INVOICE TAX USG-ID WILL HAVE        64220000
642300* DEFAULT TIMESTAMP.                                              64230000
642400       IF SEL-USA5-TAX-USG-ID                                     64240000
642500         IF WS-PACK-TYPE = '3' AND NO-VZW-INVOICE                 64250000
642600           MOVE LT-DFLT-TMSTMP TO TAX-USG-ID OF XIRI004Y          64260000
642700         ELSE                                                     64270000
642800           PERFORM I102-SEL-USA5-TAX-USG-ID                       64280000
642900           MOVE USG-ID-USA5 TO TAX-USG-ID OF XIRI004Y             64290000
643000       ELSE                                                       64300000
643100         MOVE TAX-USG-ID OF SUM21-TAX-TOT-RED-AR TO               64310000
643200              TAX-USG-ID OF XIRI004Y                              64320000
643300       END-IF                                                     64330000
643400       INITIALIZE TOT-DMSTC-RVN     OF XIRI004Y                   64340000
643500       INITIALIZE TOT-DMSTC-CLG-CRD OF XIRI004Y                   64350000
643600     END-IF                                                       64360000
643700*END MCR970317-70A                                                64370000
643800                                                                  64380000
643900*** TR#159808  02/13/96  ALAN MASI  R960314                       64390000
644000*                                                                 64400000
644100* MOVE SUM21-TOT-REV TO WS-USA1-TOT-REV WHICH IS SAVED TO         64410000
644200* THE RESTART FILE.  THEN THIS FIELD CAN BE USED TO DETERMINE     64420000
644300* IF THE USA1 TABLE IS IN BALANCE.                                64430000
644400*                                                                 64440000
644500     MOVE SUM21-TOT-REV TO TOT-REV-AMT OF XIRI004Y                64450000
644600                           WS-USA1-TOT-REV                        64460000
644700                                                                  64470000
644800     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT                    64480000
644900     SET UPPER-CASE     OF DTFMT TO TRUE                          64490000
645000     SET USER-SPECIFIED OF DTFMT TO TRUE                          64500000
645100     MOVE SUM21-BLG-DAT TO DF-YYMMDD OF DTFMT                     64510000
645200     CALL DATETIME USING DTFMT                                    64520000
645300     IF FB-ERROR OF DTFMT                                         64530000
645400       MOVE DATETIME-ERR       TO ERRR-CD OF E1000LK1             64540000
645500       MOVE 'DATETIME ERR '    TO WS-ERRR-LTRL                    64550000
645600       MOVE SUM21-BLG-DAT      TO WS-ERRR-VAL                     64560000
645700       MOVE WS-ERRR-DISPL TO                                      64570000
645800                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  64580000
645900       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 64590000
646000     END-IF                                                       64600000
646100     MOVE DF-YYYY-MM-DD OF DTFMT                                  64610000
646200                        TO EXCH-MSG-BLLD-DAT OF XIRI004Y          64620000
646300     MOVE SUM21-ACCT-NO TO EXCH-MSG-ACCT-NO OF XIRI004Y           64630000
646400     IF CUST-INQ-NUM-YES                                          64640000
646500         MOVE SUM21-IX-CUST-INQ-NO TO SPLR-INQ-NO OF XIRI004Y     64650000
646600     ELSE                                                         64660000
646700         MOVE ALL ZEROS  TO SPLR-INQ-NO OF XIRI004Y               64670000
646800     END-IF                                                       64680000
646900     MOVE WS-TRMSN-ID     TO TRMSN-TMSTMP OF XIRI004Y             64690000
647000     MOVE WS-TRMSN-SEQ-NO TO TRMSN-SEQ-NO OF XIRI004Y             64700000
647100***** R110915                                                     64710000
647200     MOVE WS-APPLCN-BLG-GR-ID TO APPLCN-BLG-GR-ID OF XIRI004Y     64720000
647300     MOVE SUM21-MLTPL-SUM-INDR TO MKT-SUM-SEQ-NO OF XIRI004Y      64730000
647400     MOVE SUM21-INV-NO TO EXCH-MSG-INV-NO OF XIRI004Y             64740000
647500     MOVE NO-OF-SUM-RCDS-WITHIN-INV TO TOT-SUM-RCD-NO OF XIRI004Y 64750000
647600     MOVE WS-SPLR-AREA TO MSG-GID-AUTO-NO-ID OF XIRI004Y          64760000
647700     MOVE INV-BLG-TYP OF E015121 TO INV-BLG-TYP-CD OF XIRI004Y    64770000
647800     MOVE WS-CURR-PRCSS-CY-DAT TO CURR-PRCSS-CY-DAT OF XIRI004Y   64780000
647900                                                                  64790000
648000     MOVE WS-TOT-WRELS-MSG-AMT TO TOT-WRELS-MSG-AMT OF XIRI004Y   64800000
648100                                                                  64810000
648200     IF SUM21-TOT-MSG IS EQUAL TO ZEROES                          64820000
648300         MOVE LT-F TO RVN-SCE-TYP-CD OF XIRI004Y                  64830000
648400     ELSE                                                         64840000
648500         IF TB-SORT-INPUT AND WS-SRT-RVN-SCE-TYP-CD = LT-C        64850000
648600             MOVE LT-C TO RVN-SCE-TYP-CD OF XIRI004Y              64860000
648700         ELSE                                                     64870000
648800             MOVE LT-N TO RVN-SCE-TYP-CD OF XIRI004Y              64880000
648900         END-IF                                                   64890000
649000     END-IF                                                       64900000
649100                                                                  64910000
649200     IF USED-BILL-SUPPRESS                                        64920000
649300         MOVE SUM21-BILL-LINES-SUPPRESS OF E015121                64930000
649400          TO  WS-PRINT-LINE                                       64940000
649500         IF YES-PRINT-LINE-SUP                                    64950000
649600            MOVE LT-Y TO  BILL-LNS-SUPP-INDR OF XIRI004Y          64960000
649700         ELSE                                                     64970000
649800            MOVE LT-N TO  BILL-LNS-SUPP-INDR OF XIRI004Y          64980000
649900         END-IF                                                   64990000
650000     ELSE                                                         65000000
650100         MOVE LT-N TO  BILL-LNS-SUPP-INDR OF XIRI004Y             65010000
650200     END-IF                                                       65020000
650300                                                                  65030000
650400*** TR#179839   ALAN MASI   10/16/96                              65040000
650500*                                                                 65050000
650600* ADDED CODE TO SET RVN-SCE-TYP-CD TO 'N' NORMAL INVOICE          65060000
650700* IF TRAIT SCETYPCD IS SET TO 'Y' (SET TO NORMAL INVOICE)         65070000
650800*                                                                 65080000
650900     IF SET-RVN-SCE-TYP-CD-TO-N                                   65090000
651000        MOVE LT-N TO RVN-SCE-TYP-CD OF XIRI004Y                   65100000
651100     END-IF                                                       65110000
651200     MOVE WS-SPLR-UNIQ-INV-DA  TO SPLR-UNIQ-INV-DA   OF XIRI004Y  65120000
651300                                                                  65130000
651400     MOVE LT-BILLSIMP-TRAIT   TO TRAIT-ID OF Z7000LK1             65140000
651500     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    65150000
651600     MOVE TRAIT-ACTN-VAL TO WS-BILL-SIMP-FORMAT                   65160000
651700                            WS-SIMP-TRAIT-ACTN                    65170000
651800     IF BILL-SIMP-FORMAT-NO                                       65180000
651900        MOVE WS-SIMP-TRAIT-ACT2 OF WS-SIMP-TRAIT-ACTN             65190000
652000                                TO QLFD-INVOICE-IND   OF XIRI004Y 65200000
652100     ELSE                                                         65210000
652200        MOVE BILL-SIMP-FORMAT    OF E015121                       65220000
652300                                 TO QLFD-INVOICE-IND   OF XIRI004Y65230000
652400     END-IF                                                       65240000
652500                                                                  65250000
652600     MOVE LT-DFLT-TMSTMP       TO LAST-ASGND-BTN-DAT OF XIRI004Y  65260000
652700                                                                  65270000
652800**R080221 CHNAGES**                                               65280000
652900*                                                                 65290000
653000* MOVE BILL-RQST-TYP TO XZ8USA1T TABLE                            65300000
653100*                                                                 65310000
653200     MOVE LT-BILL-RQST-TYP    TO TRAIT-ID OF Z7000LK1             65320000
653300     PERFORM Z700-CALL-XIRZ7000 THRU Z700-EXIT                    65330000
653400     MOVE TRAIT-ACTN-VAL TO WS-BILL-RQST-TYP                      65340000
653500                                                                  65350000
653600     IF BILL-RQST-TYP-YES                                         65360000
653700       MOVE BILL-RQST-TYP OF E015121                              65370000
653800         TO BLG-PRTNR-RQST-TYP OF XIRI004Y                        65380000
653900     ELSE                                                         65390000
654000       MOVE LT-0 TO BLG-PRTNR-RQST-TYP OF XIRI004Y                65400000
654100     END-IF                                                       65410000
654200*                                                                 65420000
654300     IF SUM21-VZW-MIXED-BILL-INDR = LT-1 AND                      65430000
654400        VZW-INVOICE                                               65440000
654500       MOVE LT-MX TO BLG-PRTNR-RQST-TYP OF XIRI004Y (1:2)         65450000
654600     END-IF                                                       65460000
654700                                                                  65470000
654800     IF SUM21-MIXED-BILL-INDR = LT-1 AND                          65480000
654900        APPLCN-BLG-GR-ID OF SPLR-INFO-AR = LT-MIXED               65490000
655000       MOVE LT-MX TO BLG-PRTNR-RQST-TYP OF XIRI004Y (2:2)         65500000
655100     END-IF                                                       65510000
655200                                                                  65520000
655300     INITIALIZE WS-RETRY-CNT                                      65530000
655400     SET LOCKED-OUT TO TRUE                                       65540000
655500     MOVE SPACES TO WS-DUPLICATE-USG-ID                           65550000
655600                                                                  65560000
655700     MOVE RVN-SCE-TYP-CD OF XIRI004Y                              65570000
655800       TO WS-XIRI004Y-RVN-SCE-TYP-CD                              65580000
655900                                                                  65590000
656000*** TR2173375   LAW         10/16/98                              65600000
656100*                                                                 65610000
656200* CHANGED PERFORM STATEMENT TO INCLUDE THE EVALUATE               65620000
656300*                                                                 65630000
656400                                                                  65640000
656500     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           65650000
656600          OR NOT LOCKED                                           65660000
656700        EXEC SQL                                                  65670000
656800            INCLUDE XIRI04I1                                      65680000
656900        END-EXEC                                                  65690000
657000        ADD +1 TO WS-RETRY-CNT                                    65700000
657100        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         65710000
657200                                                                  65720000
657300*       IF SPLR-INTRNL-SER-ID OF XIRI004Y = '3032020290'          65730000
657400*          MOVE -811 TO SQLCODE                                   65740000
657500*       END-IF                                                    65750000
657600                                                                  65760000
657700        EVALUATE SQLCODE                                          65770000
657800            WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES          65780000
657900                ADD +1 TO WS-XIRI004Y-RCD-INS                     65790000
658000                SET NO-DUPL TO TRUE                               65800000
658100            WHEN LT-DUPL-INSERT OF LT-DB2-RETURN-CODES            65810000
658200                MOVE USG-ID OF XIRI004Y                           65820000
658300                  TO WS-DUPLICATE-USG-ID                          65830000
658400                MOVE WS-RETRY-CNT TO WS-DUPLICATE-CNT             65840000
658500                MOVE WS-DUPLICATE-CNT TO                          65850000
658600                   WS-DUPLICATE-USG-ID(21:6)                      65860000
658700                MOVE WS-DUPLICATE-USG-ID                          65870000
658800                  TO USG-ID OF XIRI004Y                           65880000
658900                SET LOCKED-OUT TO TRUE                            65890000
659000                SET DUPL TO TRUE                                  65900000
659100                SET NO-INSERT-USA7 TO TRUE                        65910000
659200            WHEN OTHER                                            65920000
659300                MOVE ERR-3999 TO ERRR-CD OF E1000LK1              65930000
659400                MOVE LT-XIRI004Y TO VW-NM OF Z9000LK1             65940000
659500                MOVE SQLCA TO SQLCA-AR OF Z9000LK1                65950000
659600                MOVE WS-USA1T-ERRR-MSG TO                         65960000
659700                    ERRR-DISPL-FLDS OF Z9000LK1 (1)               65970000
659800                PERFORM E100-PROCESS-ERRORS THRU E100-EXIT        65980000
659900        END-EVALUATE                                              65990000
660000     END-PERFORM                                                  66000000
660100                                                                  66010000
660200     IF POP-XZ8USA7T-TABLE-YES                                    66020000
660300        IF INV-BLG-TYP OF E015121 = LT-1 AND NO-DUPL              66030000
660400           AND INSERT-USA7                                        66040000
660500           PERFORM I300-INSERT-XZ8USA7T THRU I300-EXIT            66050000
660600        END-IF                                                    66060000
660700     END-IF                                                       66070000
660800                                                                  66080000
660900     IF DUPL                                                      66090000
661000        PERFORM A900-DUPL-PROCESS THRU A900-EXIT                  66100000
661100     END-IF                                                       66110000
661200     .                                                            66120000
661300 I100-EXIT.                                                       66130000
661400     EXIT.                                                        66140000
661500                                                                  66150000
661600     EJECT                                                        66160000
661700***************************************************************** 66170000
661800*                I101-SELECT-XZ8USA1T                           * 66180000
661900*                                                               * 66190000
662000*    CHECK FOR INVOICES ON USA1 USING SPLR-ID AND               * 66200000
662100*    SPLR_INTRNL_ACC_NO                                         * 66210000
662200*    THE INFO FROM HERE WILL BE USED TO SET FST-TM-INV-INDR     * 66220000
662300***************************************************************** 66230000
662400 I101-SELECT-XZ8USA1T SECTION.                                    66240000
662500      EXEC SQL                                                    66250000
662600      INCLUDE XIRI05S2                                            66260000
662700      END-EXEC.                                                   66270000
662800 I101-EXIT.                                                       66280000
662900     EXIT.                                                        66290000
663000                                                                  66300000
663100     EJECT                                                        66310000
663200***************************************************************** 66320000
663300*                I102-SEL-USA5-TAX-USG-ID                       * 66330000
663400*                                                               * 66340000
663500*    SELECT THE ASSOCIATED USG-ID ON XZ8USA5T FOR THE ACCOUNT   * 66350000
663600*    BEING PROCESSED.                                           * 66360000
663700*    THE INFO FROM HERE WILL BE USED TO SET FST-TM-INV-INDR     * 66370000
663800***************************************************************** 66380000
663900 I102-SEL-USA5-TAX-USG-ID SECTION.                                66390000
664000     INITIALIZE DAI10LK1                                          66400000
664100                                                                  66410000
664200     MOVE WS-SPLR-ID TO DAI10-SPLR-ID                             66420000
664300     MOVE SUM21-OBLIG-ID TO DAI10-EXCH-MSG-OBLGTN-ID              66430000
664400     MOVE WS-SPLR-INTRNL-ACC-NO-VAL TO DAI10-ACCT-ID              66440000
664500     INITIALIZE WS-ASGND-BTN-CUST-CD                              66450000
664600     MOVE HLD-CNVTD-MA-BLG-NO TO WS-ASGND-BTN-NO                  66460000
664700     MOVE SUM21-CUST-CD TO WS-ASGND-CUST-CD                       66470000
664800     MOVE WS-ASGND-BTN-CUST-CD TO DAI10-ASGND-BTN-NO              66480000
664900     MOVE SUM21-BLG-RAO TO DAI10-ASGND-RAO-CD                     66490000
665000     MOVE SUM21-TOT-REV TO DAI10-TOT-REV-AMT                      66500000
665100                                                                  66510000
665200     MOVE SPACES TO INPUT-OUTPUT-AREA OF DTFMT                    66520000
665300     SET UPPER-CASE     OF DTFMT TO TRUE                          66530000
665400     SET USER-SPECIFIED OF DTFMT TO TRUE                          66540000
665500     MOVE SUM21-BLG-DAT TO DF-YYMMDD OF DTFMT                     66550000
665600     CALL DATETIME USING DTFMT                                    66560000
665700                                                                  66570000
665800     IF FB-ERROR OF DTFMT                                         66580000
665900       MOVE LT-I102 TO PROG-PAR-NO OF Z9000LK1                    66590000
666000       MOVE DATETIME-ERR TO ERRR-CD OF E1000LK1                   66600000
666100       MOVE 'DATETIME ERR ' TO WS-ERRR-LTRL                       66610000
666200       MOVE SUM21-BLG-DAT TO WS-ERRR-VAL                          66620000
666300       MOVE WS-ERRR-DISPL                                         66630000
666400         TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                       66640000
666500       PERFORM E100-PROCESS-ERRORS THRU E100-EXIT                 66650000
666600     END-IF                                                       66660000
666700     MOVE DF-YYYY-MM-DD OF DTFMT                                  66670000
666800       TO DAI10-EXCH-MSG-BLLD-DAT                                 66680000
666900     MOVE PROG-RETRY-NO OF SPLR-INFO-AR                           66690000
667000       TO DAI10-PROG-RETRY-NO                                     66700000
667100                                                                  66710000
667200****REMOTE CONNECT                                                66720000
667300     MOVE SPACES TO Z7200LK1                                      66730000
667400     SET FUNC-CONNECT OF Z7200LK1 TO TRUE                         66740000
667500     PERFORM I103-CALL-XIRZ7200 THRU I103-EXIT                    66750000
667600****                                                              66760000
667700     CALL LT-XIRDAI10 USING DAI10LK1                              66770000
667800                                                                  66780000
667900****RESET                                                         66790000
668000     SET FUNC-RESET OF Z7200LK1 TO TRUE                           66800000
668100     PERFORM I103-CALL-XIRZ7200 THRU I103-EXIT                    66810000
668200*********                                                         66820000
668300                                                                  66830000
668400     EVALUATE RTRN-CD OF DAI10LK1                                 66840000
668500         WHEN ZEROS                                               66850000
668600              CONTINUE                                            66860000
668700         WHEN OTHER                                               66870000
668800              PERFORM I104-EVALUATE-DAI10-SQL-CD THRU I104-EXIT   66880000
668900     END-EVALUATE                                                 66890000
669000                                                                  66900000
669100     .                                                            66910000
669200 I102-EXIT.                                                       66920000
669300     EXIT.                                                        66930000
669400                                                                  66940000
669500     EJECT                                                        66950000
669600***************************************************************** 66960000
669700*                I103-CALL-XIRZ7200                             * 66970000
669800*                                                               * 66980000
669900*    XIRZ7200 IS USED TO MAKE A REMOTE CONNECTION TO ACCESS     * 66990000
670000*    THE XZ8USA5T TABLE.                                        * 67000000
670100***************************************************************** 67010000
670200 I103-CALL-XIRZ7200 SECTION.                                      67020000
670300     MOVE WS-PROGRAM-NAME-LIT TO PROG-ID OF Z7200LK1              67030000
670400     MOVE LT-XIRI090Y TO VW-NM OF Z7200LK1                        67040000
670500                                                                  67050000
670600     CALL LT-XIRZ7200 USING Z7200LK1                              67060000
670700                                                                  67070000
670800     EVALUATE RTRN-CD OF Z7200LK1                                 67080000
670900         WHEN ZEROS                                               67090000
671000              CONTINUE                                            67100000
671100         WHEN OTHER                                               67110000
671200              DISPLAY 'BAD REMOTE CONNECTION - XIRI1000'          67120000
671300              DISPLAY 'RETURN CODE FROM XIRZ7200 :'               67130000
671400                       RTRN-CD OF Z7200LK1                        67140000
671500              MOVE LT-I103 TO PROG-PAR-NO OF Z9000LK1             67150000
671600              MOVE RTRN-CD OF Z7200LK1                            67160000
671700                TO ERRR-CD OF E1000LK1                            67170000
671800              SET ERRR-IDX TO 1                                   67180000
671900              MOVE WS-ERROR-CALL-XIRZ7200                         67190000
672000                TO ERRR-DISPL-FLDS(ERRR-IDX)                      67200000
672100              MOVE SQLCA-AR OF Z7200LK1                           67210000
672200                TO SQLCA-AR OF Z9000LK1                           67220000
672300              PERFORM E100-PROCESS-ERRORS                         67230000
672400     END-EVALUATE                                                 67240000
672500                                                                  67250000
672600     .                                                            67260000
672700 I103-EXIT.                                                       67270000
672800     EXIT.                                                        67280000
672900                                                                  67290000
673000***************************************************************** 67300000
673100*                I104-EVALUATE-DAI10-SQL-CD                     * 67310000
673200*                                                               * 67320000
673300*    CHECK THE VALUE OF THE SQL-CD FIELD RETURNED FROM XIRDAI10 * 67330000
673400***************************************************************** 67340000
673500 I104-EVALUATE-DAI10-SQL-CD SECTION.                              67350000
673600     EVALUATE SQL-CD OF DAI10LK1                                  67360000
673700         WHEN SQL-CALL-SUCCESSFUL                                 67370000
673800              CONTINUE                                            67380000
673900         WHEN SQL-ROW-NOT-FOUND                                   67390000
674000              MOVE RTRN-CD OF DAI10LK1 TO ERRR-CD OF E1000LK1     67400000
674100              MOVE LT-I104 TO PROG-PAR-NO OF Z9000LK1             67410000
674200              MOVE VIEW-NM OF DAI10LK1 TO VW-NM OF Z9000LK1       67420000
674300              MOVE SQLCA-AR OF DAI10LK1 TO SQLCA-AR OF Z9000LK1   67430000
674400              SET DAI10-ERRR-IDX TO 1                             67440000
674500              PERFORM VARYING ERRR-IDX FROM +1 BY +1              67450000
674600                UNTIL ERRR-IDX > +10                              67460000
674700                   OR DAI10-ERRR-DISPL-FLDS(DAI10-ERRR-IDX)       67470000
674800                      = SPACES                                    67480000
674900                SET DAI10-ERRR-IDX TO ERRR-IDX                    67490000
675000                MOVE DAI10-ERRR-DISPL-FLDS(DAI10-ERRR-IDX)        67500000
675100                  TO ERRR-DISPL-FLDS(ERRR-IDX)                    67510000
675200              END-PERFORM                                         67520000
675300              PERFORM E100-PROCESS-ERRORS                         67530000
675400         WHEN OTHER                                               67540000
675500              MOVE SQL-CD OF DAI10LK1 TO DSPLSQL                  67550000
675600              DISPLAY 'SQLCODE :' DSPLSQL                         67560000
675700              MOVE RTRN-CD OF DAI10LK1                            67570000
675800                TO ERRR-CD OF E1000LK1                            67580000
675900              MOVE LT-I104 TO PROG-PAR-NO OF Z9000LK1             67590000
676000              MOVE VIEW-NM OF DAI10LK1 TO VW-NM OF Z9000LK1       67600000
676100              MOVE SQLCA-AR OF DAI10LK1                           67610000
676200                TO SQLCA-AR OF Z9000LK1                           67620000
676300              SET DAI10-ERRR-IDX TO 1                             67630000
676400              PERFORM VARYING ERRR-IDX FROM +1 BY +1              67640000
676500                UNTIL ERRR-IDX > +10                              67650000
676600                   OR DAI10-ERRR-DISPL-FLDS(DAI10-ERRR-IDX)       67660000
676700                      = SPACES                                    67670000
676800                SET DAI10-ERRR-IDX TO ERRR-IDX                    67680000
676900                MOVE DAI10-ERRR-DISPL-FLDS(DAI10-ERRR-IDX)        67690000
677000                  TO ERRR-DISPL-FLDS(ERRR-IDX)                    67700000
677100              END-PERFORM                                         67710000
677200              PERFORM E100-PROCESS-ERRORS                         67720000
677300     END-EVALUATE                                                 67730000
677400                                                                  67740000
677500     .                                                            67750000
677600 I104-EXIT.                                                       67760000
677700     EXIT.                                                        67770000
677800                                                                  67780000
677900     EJECT                                                        67790000
678000***************************************************************** 67800000
678100*                I200-INSERT-XZ8USA2T                           * 67810000
678200*                                                               * 67820000
678300*    THIS PARAGRAPH INSERTS THE DETAIL RECORDS ON XZ8USA2T      * 67830000
678400*                                                               * 67840000
678500***************************************************************** 67850000
678600 I200-INSERT-XZ8USA2T SECTION.                                    67860000
678700     INITIALIZE CALC-TOT-MNS OF XIRI003Y                          67870000
678800                                                                  67880000
678900     MOVE 'I200' TO PROG-PAR-NO.                                  67890000
679000     ADD +1              TO WS-BILL-SEQ-NO.                       67900000
679100     PERFORM C500-CALL-XIRZB000                                   67910000
679200        THRU C500-EXIT.                                           67920000
679300     MOVE WS-PTN-ID    TO PTN-ID OF XIRI003Y.                     67930000
679400     MOVE WS-BILL-SEQ-NO TO BILL-ORD-SEQ-NO OF XIRI003Y.          67940000
679500*                                                                 67950000
679600* R080925 - VERIZON SBANERJ                                       67960000
679700* ADD LOGIC TO ADD SUM21-VZW-FST-TM-INV  TO  EXCH-MSG-INTFC-DA    67970000
679800* FOR VERIZON                                                     67980000
679900*                                                                 67990000
680000     MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                68000000
680100       TO EXCH-MSG-INTFC-DA OF XIRI003Y                           68010000
680200                                                                  68020000
680300     MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                68030000
680400       TO EMI-RECORD OF ZC000LK1.                                 68040000
680500                                                                  68050000
680600     CALL LT-XIRZC000 USING ZC000LK1,                             68060000
680700                            Z9000LK1.                             68070000
680800                                                                  68080000
680900     IF ERRR-CD OF Z9000LK1 = ZEROES                              68090000
681000        CONTINUE                                                  68100000
681100     ELSE                                                         68110000
681200        MOVE ERRR-CD OF Z9000LK1                                  68120000
681300          TO ERRR-CD OF E1000LK1                                  68130000
681400        MOVE 'ERROR IN XIRZC000'                                  68140000
681500          TO ERRR-DISPL-FLDS(2)                                   68150000
681600        MOVE WS-CURR-SPLR                                         68160000
681700          TO SPLR-ID OF E1000LK1                                  68170000
681800        MOVE SPACES TO TRNSCTN-ID OF E1000LK1                     68180000
681900                       VW-NM      OF Z9000LK1                     68190000
682000        PERFORM E100-PROCESS-ERRORS                               68200000
682100           THRU E100-EXIT                                         68210000
682200     END-IF.                                                      68220000
682300                                                                  68230000
682400     MOVE EX-EMI-RECORD                                           68240000
682500       TO EXPD-EXCH-MSG-DA OF XIRI003Y.                           68250000
682600     MOVE EMI-RCD-ID  OF I1005LK3 (SORT-REC-IDX)                  68260000
682700       TO EXCH-MSG-RCD-ID OF XIRI003Y.                            68270000
682800     IF USG-SEQ-NO OF I1005LK3 (SORT-REC-IDX) = ZEROES            68280000
682900         ADD +1 TO WS-LAST-USG-SEQ-NO                             68290000
683000         MOVE WS-LAST-USG-SEQ-NO                                  68300000
683100           TO USG-SEQ-NO OF I1005LK3 (SORT-REC-IDX)               68310000
683200     END-IF.                                                      68320000
683300                                                                  68330000
683400* TR XXXXXX BXGOMEZ DUPLICATE INVOICES PROBLEM                    68340000
683500                                                                  68350000
683600     IF WS-DUPLICATE-USG-ID = SPACES                              68360000
683700         MOVE USG-ID OF I1005LK3 (SORT-REC-IDX)                   68370000
683800           TO USG-ID OF XIRI003Y                                  68380000
683900     ELSE                                                         68390000
684000         MOVE WS-DUPLICATE-USG-ID                                 68400000
684100           TO USG-ID OF XIRI003Y                                  68410000
684200     END-IF.                                                      68420000
684300                                                                  68430000
684400     MOVE USG-SEQ-NO OF I1005LK3 (SORT-REC-IDX)                   68440000
684500       TO USG-SEQ-NO OF XIRI003Y.                                 68450000
684600     MOVE WS-CURR-SPLR TO SPLR-ID OF XIRI003Y                     68460000
684700     MOVE WS-EXCH-MSG-BLG                                         68470000
684800       TO EXCH-MSG-BLG-NO OF XIRI003Y.                            68480000
684900     MOVE WS-SPLR-AREA                                            68490000
685000       TO SPLR-INTRNL-SER-ID OF XIRI003Y.                         68500000
685100     MOVE SA-BILL-SECT-1 OF I1005LK3 (SORT-REC-IDX)               68510000
685200       TO BILL-SECT1-CD OF XIRI003Y.                              68520000
685300     MOVE SA-BILL-SECT-2 OF I1005LK3 (SORT-REC-IDX)               68530000
685400       TO BILL-SECT2-CD OF XIRI003Y.                              68540000
685500     MOVE SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)               68550000
685600       TO BILL-SECT3-CD OF XIRI003Y.                              68560000
685700     MOVE SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)               68570000
685800       TO BILL-SECT4-CD OF XIRI003Y.                              68580000
685900     MOVE SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)               68590000
686000       TO BILL-SECT5-CD OF XIRI003Y.                              68600000
686100     MOVE SA-BILL-SECT-6 OF I1005LK3 (SORT-REC-IDX)               68610000
686200       TO BILL-SECT6-CD OF XIRI003Y.                              68620000
686300     MOVE SA-BILL-SECT-7 OF I1005LK3 (SORT-REC-IDX)               68630000
686400       TO BILL-SECT7-CD OF XIRI003Y.                              68640000
686500     MOVE SA-BILL-SECT-8 OF I1005LK3 (SORT-REC-IDX)               68650000
686600       TO BILL-SECT8-CD OF XIRI003Y.                              68660000
686700     MOVE SA-BILL-SECT-9 OF I1005LK3 (SORT-REC-IDX)               68670000
686800       TO BILL-SECT9-CD OF XIRI003Y.                              68680000
686900     MOVE SA-BILL-SECT-10 OF I1005LK3 (SORT-REC-IDX)              68690000
687000       TO BILL-SECT10-CD OF XIRI003Y.                             68700000
687100     MOVE TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)        68710000
687200       TO PHRS-TYP-TRNSLN-CD OF XIRI003Y.                         68720000
687300     MOVE WS-APPLCN-BLG-GR-ID TO APPLCN-BLG-GR-ID OF XIRI003Y.    68730000
687400                                                                  68740000
687500                                                                  68750000
687600*** 950203-70  ALAN MASI                                          68760000
687700*                                                                 68770000
687800* MOVE BLBL-MNS TO USA2                                           68780000
687900* 015127 RECORDS DO NOT HAVE MINUTES                              68790000
688000*                                                                 68800000
688100     IF EXCH-MSG-RCD-ID OF XIRI003Y = LT-015127                   68810000
688200         MOVE ZEROS TO BLBL-MNS OF XIRI003Y                       68820000
688300     ELSE                                                         68830000
688400         MOVE SA-BLBL-MNS OF I1005LK3 (SORT-REC-IDX)              68840000
688500           TO BLBL-MNS OF XIRI003Y                                68850000
688600     END-IF.                                                      68860000
688700*    DISPLAY '1ST BLBL-MNS = ' BLBL-MNS OF XIRI003Y               68870000
688800*** TR#165474   ALAN MASI   04/23/96                              68880000
688900*                                                                 68890000
689000*                                                                 68900000
689100*    R961114 - SJW REMOVE SUPPLIER HARDCODING AND USED            68910000
689200*                  TRAIT BLBL-MNS-TRAIT                           68920000
689300*                                                                 68930000
689400                                                                  68940000
689500     MOVE EXCH-MSG-INTFC-DA OF XIRI003Y TO E81XXXX                68950000
689600                                           E82XXXX                68960000
689700                                           WS-015127-TEMP         68970000
689800                                                                  68980000
689900     IF NON-SORTED-10TH OR NON-SORTED-10TH-MST                    68990000
690000        IF BMD81-REC-ID-CTGRY = 81                                69000000
690100        OR BMD81-REC-ID-CTGRY = 82                                69010000
690200           IF BMD81-INDR-6 = LT-3                                 69020000
690300              MOVE BMD81-BLBL-TM TO HLD-BLBL-TM                   69030000
690400              IF NON-SORTED-10TH-MST  AND                         69040000
690500                 HLD-BLBL-TNTH-SECS > ZERO                        69050000
690600                 IF HLD-BLBL-SECS > 58                            69060000
690700                    MOVE 0 TO HLD-BLBL-SECS                       69070000
690800                    ADD  1 TO HLD-BLBL-MNS                        69080000
690900                 ELSE                                             69090000
691000                    ADD 1 TO HLD-BLBL-SECS                        69100000
691100                 END-IF                                           69110000
691200              END-IF                                              69120000
691300              PERFORM Z100-PRCSS-TNTH-MIN THRU Z100-EXIT          69130000
691400              MOVE CONVERT-MNS TO BLBL-MNS OF XIRI003Y            69140000
691500           ELSE                                                   69150000
691600              MOVE BMD81-BLBL-MNS TO BLBL-MNS OF XIRI003Y         69160000
691700              MOVE BMD81-FMC-IND  TO WS-FMC-IND-VALUE             69170000
691800              IF WIFI-MNS-YES                                     69180000
691900                 IF FMC-IND-YES                                   69190000
692000                   MOVE BMD81-WIFI-MINS TO WIFI-MNS OF XIRI003Y   69200000
692100                 ELSE                                             69210000
692200                   MOVE ZERO TO WIFI-MNS     OF XIRI003Y          69220000
692300                 END-IF                                           69230000
692400                 COMPUTE CALC-TOT-MNS OF XIRI003Y =               69240000
692500                         BLBL-MNS OF XIRI003Y +                   69250000
692600                         WIFI-MNS OF XIRI003Y                     69260000
692700              ELSE                                                69270000
692800                 MOVE ZERO TO WIFI-MNS     OF XIRI003Y            69280000
692900                 MOVE ZERO TO CALC-TOT-MNS OF XIRI003Y            69290000
693000              END-IF                                              69300000
693100           END-IF                                                 69310000
693200        END-IF                                                    69320000
693300     END-IF.                                                      69330000
693400                                                                  69340000
693500     IF SORTED-MINUTES-ONLY                                       69350000
693600        IF BMD81-REC-ID-CTGRY = 81                                69360000
693700        OR BMD81-REC-ID-CTGRY = 82                                69370000
693800           MOVE BMD81-BLBL-MNS TO BLBL-MNS OF XIRI003Y            69380000
693900           MOVE BMD81-FMC-IND  TO WS-FMC-IND-VALUE                69390000
694000           IF WIFI-MNS-YES                                        69400000
694100              IF FMC-IND-YES                                      69410000
694200                MOVE BMD81-WIFI-MINS TO WIFI-MNS OF XIRI003Y      69420000
694300              ELSE                                                69430000
694400                MOVE ZERO TO WIFI-MNS     OF XIRI003Y             69440000
694500              END-IF                                              69450000
694600              COMPUTE CALC-TOT-MNS OF XIRI003Y =                  69460000
694700                      BLBL-MNS OF XIRI003Y +                      69470000
694800                      WIFI-MNS OF XIRI003Y                        69480000
694900           ELSE                                                   69490000
695000              MOVE ZERO TO WIFI-MNS     OF XIRI003Y               69500000
695100              MOVE ZERO TO CALC-TOT-MNS OF XIRI003Y               69510000
695200           END-IF                                                 69520000
695300        END-IF                                                    69530000
695400     END-IF                                                       69540000
695500                                                                  69550000
695600     IF NON-SORTED-MIN-SEC                                        69560000
695700        IF BMD81-REC-ID-CTGRY = 81                                69570000
695800        OR BMD81-REC-ID-CTGRY = 82                                69580000
695900           MOVE BMD81-BLBL-MNS TO BLBL-MNS OF XIRI003Y            69590000
696000           COMPUTE BLBL-MNS OF XIRI003Y =                         69600000
696100                   BLBL-MNS OF XIRI003Y + (BMD81-BLBL-SECS * .01) 69610000
696200           MOVE BMD81-FMC-IND  TO WS-FMC-IND-VALUE                69620000
696300           IF WIFI-MNS-YES                                        69630000
696400              IF FMC-IND-YES                                      69640000
696500                MOVE BMD81-WIFI-MINS TO WIFI-MNS OF XIRI003Y      69650000
696600              ELSE                                                69660000
696700                MOVE ZERO TO WIFI-MNS     OF XIRI003Y             69670000
696800              END-IF                                              69680000
696900              COMPUTE CALC-TOT-MNS OF XIRI003Y =                  69690000
697000                      BLBL-MNS OF XIRI003Y +                      69700000
697100                      WIFI-MNS OF XIRI003Y                        69710000
697200           ELSE                                                   69720000
697300              MOVE ZERO TO WIFI-MNS     OF XIRI003Y               69730000
697400              MOVE ZERO TO CALC-TOT-MNS OF XIRI003Y               69740000
697500           END-IF                                                 69750000
697600        END-IF                                                    69760000
697700     END-IF.                                                      69770000
697800                                                                  69780000
697900     SET NO-PRINT-LINE-SUP TO TRUE.                               69790000
698000     IF USED-BILL-SUPPRESS                                        69800000
698100       IF RCD-ID OF WS-015127-TEMP = LT-015127                    69810000
698200         MOVE 27-SUPPRESS-BILL-DISPLAY OF WS-015127-TEMP          69820000
698300          TO  WS-PRINT-LINE                                       69830000
698400       END-IF                                                     69840000
698500       IF BMD81-REC-ID-CTGRY = 81                                 69850000
698600         MOVE BMD81-SUPPRESS-BILL-DISPLAY OF E81XXXX              69860000
698700          TO  WS-PRINT-LINE                                       69870000
698800       END-IF                                                     69880000
698900       IF BMD82-REC-ID-CTGRY = 82                                 69890000
699000         MOVE BMD82-SUPPRESS-BILL-DISPLAY OF E82XXXX              69900000
699100          TO  WS-PRINT-LINE                                       69910000
699200       END-IF                                                     69920000
699300     END-IF.                                                      69930000
699400                                                                  69940000
699500* THE FOLLOWING IS FOR VERIZON ONLY                               69950000
699600     IF BILL-SIMP-SUPPRESS                    AND                 69960000
699700        RCD-ID OF WS-015127-TEMP = LT-015127  AND                 69970000
699800        PHRS-MSG-CD OF WS-015127-TEMP = LT-QBS77                  69980000
699900         MOVE +3 TO PRNTBL-LN-CD OF XIRI003Y                      69990000
700000         MOVE LT-N TO                                             70000000
700100         USE-RECORD-INDR  OF I1005LK3 (SORT-REC-IDX)              70010000
700200* THE FOLLOWING IS FOR VERIZON ONLY                               70020000
700300     ELSE                                                         70030000
700400        IF USE-RECORD-INDR  OF I1005LK3 (SORT-REC-IDX) = LT-Y     70040000
700500             IF YES-PRINT-LINE-SUP                                70050000
700600                MOVE +2 TO PRNTBL-LN-CD OF XIRI003Y               70060000
700700             ELSE                                                 70070000
700800                MOVE +1 TO PRNTBL-LN-CD OF XIRI003Y               70080000
700900             END-IF                                               70090000
701000             IF TB-NOT-SORT-INPUT                                 70100000
701100                ADD +1 TO WS-USA2-PRNTBLE-RECS                    70110000
701200             END-IF                                               70120000
701300        ELSE                                                      70130000
701400           IF REC-DETAILS-IND  OF E015127  = LT-Y                 70140000
701500              MOVE +3 TO PRNTBL-LN-CD OF XIRI003Y                 70150000
701600           ELSE                                                   70160000
701700              MOVE ZEROES TO PRNTBL-LN-CD OF XIRI003Y             70170000
701800           END-IF                                                 70180000
701900        END-IF                                                    70190000
702000     END-IF.                                                      70200000
702100                                                                  70210000
702200* FOR ICE ONLY                                                    70220000
702300     IF WS-CURR-SPLR = LT-ICE                                     70230000
702400       IF RCD-ID OF WS-015127-TEMP = LT-015127                    70240000
702500         IF PHRS-MSG-CD OF WS-015127-TEMP = LT-PYDTL              70250000
702600           MOVE PHRS-VAR-DATA OF WS-015127-TEMP(1:15)             70260000
702700             TO PAYMENT-REF-ID OF XIRI003Y                        70270000
702800         ELSE                                                     70280000
702900           MOVE WS-DFLT-PAYMENT-REF-ID                            70290000
703000             TO PAYMENT-REF-ID OF XIRI003Y                        70300000
703100         END-IF                                                   70310000
703200         MOVE ICE-SUB-ENTITY-CD OF WS-015127-TEMP                 70320000
703300           TO PROD-ENTY-CD OF XIRI003Y                            70330000
703400       ELSE                                                       70340000
703500         MOVE WS-DFLT-PAYMENT-REF-ID                              70350000
703600           TO PAYMENT-REF-ID OF XIRI003Y                          70360000
703700       END-IF                                                     70370000
703800     END-IF                                                       70380000
703900                                                                  70390000
704000     MOVE SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)              70400000
704100       TO SPLR-PROV-DA-INDR OF XIRI003Y.                          70410000
704200     MOVE SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)         70420000
704300       TO SPLR-TEXT-INDR OF XIRI003Y.                             70430000
704400     INITIALIZE WS-RETRY-CNT.                                     70440000
704500     SET LOCKED-OUT TO TRUE                                       70450000
704600     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           70460000
704700          OR NOT LOCKED                                           70470000
704800        EXEC SQL                                                  70480000
704900            INCLUDE XIRI03I1                                      70490000
705000        END-EXEC                                                  70500000
705100        ADD +1 TO WS-RETRY-CNT                                    70510000
705200        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         70520000
705300                        WS-DISPLAY-SQLCODE                        70530000
705400     END-PERFORM.                                                 70540000
705500                                                                  70550000
705600     EVALUATE SQLCODE                                             70560000
705700         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             70570000
705800             ADD +1 TO WS-XIRI003Y-RCD-INS                        70580000
705900         WHEN OTHER                                               70590000
706000             MOVE ERR-3999 TO ERRR-CD OF E1000LK1                 70600000
706100             MOVE LT-XIRI003Y TO VW-NM OF Z9000LK1                70610000
706200             MOVE SQLCA TO SQLCA-AR OF Z9000LK1                   70620000
706300             MOVE WS-USA2T-ERRR-MSG                               70630000
706400               TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                 70640000
706500             DISPLAY WS-USA2T-ERRR-MSG                            70650000
706600             DISPLAY 'USG-ID          = '  USG-ID OF XIRI003Y     70660000
706700             DISPLAY 'BILL-ORD-SEQ-NO = '                         70670000
706800                      BILL-ORD-SEQ-NO OF XIRI003Y                 70680000
706900             DISPLAY 'SECTION CODES   = '                         70690000
707000                      BILL-SECT1-CD OF XIRI003Y                   70700000
707100                      BILL-SECT2-CD OF XIRI003Y                   70710000
707200                      BILL-SECT3-CD OF XIRI003Y                   70720000
707300                      BILL-SECT4-CD OF XIRI003Y                   70730000
707400                      BILL-SECT5-CD OF XIRI003Y                   70740000
707500                      BILL-SECT6-CD OF XIRI003Y                   70750000
707600             DISPLAY 'SQLCODE         = ' WS-DISPLAY-SQLCODE      70760000
707700             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           70770000
707800     END-EVALUATE                                                 70780000
707900                                                                  70790000
708000     IF PRCSS-ICE-ENA                                             70800000
708100       IF WS-PACK-TYPE = '3'                                      70810000
708200         INITIALIZE XIRI1090-PASS-AR                              70820000
708300         MOVE RESTART-PROG-RETRY-NO TO RETRY-NO OF I1090LK1       70830000
708400         MOVE SPLR-ID OF XIRI003Y TO SPLR-ID OF I1090LK1          70840000
708500         MOVE USG-ID OF XIRI003Y TO ENA-USG-ID OF I1090LK1        70850000
708600         MOVE APPLCN-BLG-GR-ID OF XIRI003Y                        70860000
708700           TO APPLCN-BLG-GR-ID OF I1090LK1                        70870000
708800         MOVE CURR-PRCSS-CY-DAT OF SPLR-INFO-AR                   70880000
708900           TO PRCSS-CY-DAT OF I1090LK1                            70890000
709000         MOVE WS-SPLR-INTRNL-ACC-NO-VAL                           70900000
709100           TO SPLR-INTRNL-ACC-NO OF I1090LK1                      70910000
709200         MOVE BILL-SECT2-CD OF XIRI003Y                           70920000
709300           TO BILL-SECT2-CD OF I1090LK1                           70930000
709400         MOVE PROD-ENTY-CD OF XIRI003Y                            70940000
709500           TO PROD-ENTY-CD OF I1090LK1                            70950000
709600         MOVE PAYMENT-REF-ID OF XIRI003Y                          70960000
709700           TO PAYMENT-REF-ID OF I1090LK1                          70970000
709800         MOVE TOT-EXCL-TX-AMT OF XIRI004Y                         70980000
709900           TO TOT-EXCL-TX-AMT OF I1090LK1                         70990000
710000         MOVE FED-TX-AMT OF XIRI004Y                              71000000
710100           TO FED-TX-AMT OF I1090LK1                              71010000
710200         MOVE LOC-ST-TX-AMT OF XIRI004Y                           71020000
710300           TO LOC-ST-TX-AMT OF I1090LK1                           71030000
710400         MOVE MSG-SURCHG-AMT OF XIRI004Y                          71040000
710500           TO MSG-SURCHG-AMT OF I1090LK1                          71050000
710600         MOVE EXCH-MSG-INTFC-DA OF XIRI003Y                       71060000
710700           TO ENA-DATA OF I1090LK1                                71070000
710800         MOVE EXPD-EXCH-MSG-DA OF XIRI003Y                        71080000
710900           TO EXPND-ENA-DATA OF I1090LK1                          71090000
711000         CALL 'XIRI1090' USING I1090LK1                           71100000
711100                                                                  71110000
711200         EVALUATE RTRN-CD OF I1090LK1                             71120000
711300             WHEN ZEROS                                           71130000
711400               MOVE LK-XIRI040Y-RCD-SEL                           71140000
711500                 TO WS-XIRI040Y-RCD-SEL                           71150000
711600               MOVE LK-XIRI041Y-RCD-SEL                           71160000
711700                 TO WS-XIRI041Y-RCD-SEL                           71170000
711800               MOVE LK-XIRI041Y-RCD-INS                           71180000
711900                 TO WS-XIRI041Y-RCD-INS                           71190000
712000               MOVE LK-XIRI041Y-RCD-UPD                           71200000
712100                 TO WS-XIRI041Y-RCD-UPD                           71210000
712200               MOVE LK-XIRI042Y-RCD-SEL                           71220000
712300                 TO WS-XIRI042Y-RCD-SEL                           71230000
712400               MOVE LK-XIRI042Y-RCD-UPD                           71240000
712500                 TO WS-XIRI042Y-RCD-UPD                           71250000
712600               MOVE LK-XIRI043Y-RCD-UPD                           71260000
712700                 TO WS-XIRI043Y-RCD-UPD                           71270000
712800             WHEN OTHER                                           71280000
712900               DISPLAY 'PROG-PARA-NO OF I1090LK1 :'               71290000
713000                        PROG-PARA-NO OF I1090LK1                  71300000
713100               PERFORM I201-EVALUATE-I1090-SQL-CD                 71310000
713200                  THRU I201-EXIT                                  71320000
713300         END-EVALUATE                                             71330000
713400                                                                  71340000
713500       END-IF                                                     71350000
713600     END-IF                                                       71360000
713700                                                                  71370000
713800     .                                                            71380000
713900 I200-EXIT.                                                       71390000
714000     EXIT.                                                        71400000
714100                                                                  71410000
714200     EJECT                                                        71420000
714300***************************************************************** 71430000
714400*                I201-EVALUATE-I1090-SQL-CD                     * 71440000
714500*                                                               * 71450000
714600*    CHECK THE VALUE OF THE SQL-CD FIELD RETURNED FROM XIRI1090 * 71460000
714700***************************************************************** 71470000
714800 I201-EVALUATE-I1090-SQL-CD SECTION.                              71480000
714900     EVALUATE SQL-CD OF I1090LK1                                  71490000
715000         WHEN SQL-CALL-SUCCESSFUL                                 71500000
715100              CONTINUE                                            71510000
715200         WHEN SQL-ROW-NOT-FOUND                                   71520000
715300              MOVE RTRN-CD OF I1090LK1 TO ERRR-CD OF E1000LK1     71530000
715400              MOVE LT-I201 TO PROG-PAR-NO OF Z9000LK1             71540000
715500              MOVE VIEW-NM OF I1090LK1 TO VW-NM OF Z9000LK1       71550000
715600              MOVE SQLCA-AR OF I1090LK1 TO SQLCA-AR OF Z9000LK1   71560000
715700              SET I1090-ERRR-IDX TO 1                             71570000
715800              PERFORM VARYING ERRR-IDX FROM +1 BY +1              71580000
715900                UNTIL ERRR-IDX > +10                              71590000
716000                   OR I1090-ERRR-DISPL-FLDS(I1090-ERRR-IDX)       71600000
716100                      = SPACES                                    71610000
716200                SET I1090-ERRR-IDX TO ERRR-IDX                    71620000
716300                MOVE I1090-ERRR-DISPL-FLDS(I1090-ERRR-IDX)        71630000
716400                  TO ERRR-DISPL-FLDS(ERRR-IDX)                    71640000
716500              END-PERFORM                                         71650000
716600              PERFORM E100-PROCESS-ERRORS                         71660000
716700         WHEN OTHER                                               71670000
716800              MOVE SQL-CD OF I1090LK1 TO DSPLSQL                  71680000
716900              DISPLAY 'SQLCODE :' DSPLSQL                         71690000
717000              MOVE RTRN-CD OF I1090LK1                            71700000
717100                TO ERRR-CD OF E1000LK1                            71710000
717200              MOVE LT-I104 TO PROG-PAR-NO OF Z9000LK1             71720000
717300              MOVE VIEW-NM OF I1090LK1 TO VW-NM OF Z9000LK1       71730000
717400              MOVE SQLCA-AR OF I1090LK1                           71740000
717500                TO SQLCA-AR OF Z9000LK1                           71750000
717600              SET I1090-ERRR-IDX TO 1                             71760000
717700              PERFORM VARYING ERRR-IDX FROM +1 BY +1              71770000
717800                UNTIL ERRR-IDX > +10                              71780000
717900                   OR I1090-ERRR-DISPL-FLDS(I1090-ERRR-IDX)       71790000
718000                      = SPACES                                    71800000
718100                SET I1090-ERRR-IDX TO ERRR-IDX                    71810000
718200                MOVE I1090-ERRR-DISPL-FLDS(I1090-ERRR-IDX)        71820000
718300                  TO ERRR-DISPL-FLDS(ERRR-IDX)                    71830000
718400              END-PERFORM                                         71840000
718500              PERFORM E100-PROCESS-ERRORS                         71850000
718600     END-EVALUATE                                                 71860000
718700                                                                  71870000
718800     .                                                            71880000
718900 I201-EXIT.                                                       71890000
719000     EXIT.                                                        71900000
719100                                                                  71910000
719200     EJECT                                                        71920000
719300***************************************************************** 71930000
719400*                I20A-CREATE-HEADING                            * 71940000
719500*                                                               * 71950000
719600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 71960000
719700*       1. CREATE HEADING DATA TO INSERT TO XZ8USA2T            * 71970000
719800*                                                               * 71980000
719900***************************************************************** 71990000
720000 I20A-CREATE-HEADING SECTION.                                     72000000
720100     MOVE 'I20A' TO PROG-PAR-NO                                   72010000
720200     INITIALIZE I1060LK2                                          72020000
720300     MOVE WS-APPLCN-RGN-ID TO APPLCN-RGN-ID OF I1060LK1           72030000
720400     MOVE RESTART-PROG-RETRY-NO TO RETRY-NO OF I1060LK1           72040000
720500     CALL 'XIRI1060' USING I1060LK1,                              72050000
720600                           I1060LK2,                              72060000
720700                           I1005LK2,                              72070000
720800                           I1005LK3,                              72080000
720900                           I1000IND,                              72090000
721000                           Z9000LK1                               72100000
721100                                                                  72110000
721200     EVALUATE ERRR-CD OF Z9000LK1                                 72120000
721300         WHEN LT-SUCCESSFUL                                       72130000
721400           SET ADD-HEADING TO TRUE                                72140000
721500           MOVE SA-BILL-SECT-1-10 OF I1005LK3 (SORT-REC-IDX)      72150000
721600             TO  WS-HD-BILL-SECT-1-10                             72160000
721700         WHEN OTHER                                               72170000
721800             SET DO-NOT-DISPLAY-STD-MSGS TO TRUE                  72180000
721900             MOVE ERRR-CD OF Z9000LK1 TO ERRR-CD OF E1000LK1      72190000
722000             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           72200000
722100     END-EVALUATE                                                 72210000
722200      .                                                           72220000
722300                                                                  72230000
722400 I20A-EXIT.                                                       72240000
722500     EXIT.                                                        72250000
722600                                                                  72260000
722700     EJECT                                                        72270000
722800***************************************************************** 72280000
722900*                I20B-ADD-HEADING                               * 72290000
723000*                                                               * 72300000
723100*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 72310000
723200*       1. CREATE HEADING DATA TO INSERT TO XZ8USA2T            * 72320000
723300*                                                               * 72330000
723400***************************************************************** 72340000
723500 I20B-ADD-HEADING SECTION.                                        72350000
723600                                                                  72360000
723700     MOVE RCD-015127 OF I1060LK2 (SAV-015127-IDX) TO              72370000
723800       EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                   72380000
723900     MOVE PHRS-TYP-IND OF RCD-015127 OF I1060LK2 (SAV-015127-IDX) 72390000
724000       TO TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)        72400000
724100     MOVE 'N' TO SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       72410000
724200     IF UPDATE-HEADING                                            72420000
724300     MOVE 'Y' TO SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)  72430000
724400     ELSE                                                         72440000
724500     MOVE 'N' TO SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)  72450000
724600     END-IF                                                       72460000
724700                                                                  72470000
724800     PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT                  72480000
724900* R071108 FIR BALANCING                                           72490000
725000     IF USE-RECORD-INDR  OF I1005LK3(SORT-REC-IDX) = LT-N         72500000
725100         ADD +1 TO WS-RCD-NOT-PRTD-NO                             72510000
725200     END-IF                                                       72520000
725300     IF NO-UPDATE-HEADING                                         72530000
725400         ADD +1 TO WS-SUM-RCD-CRTE-NO                             72540000
725500     END-IF.                                                      72550000
725600                                                                  72560000
725700 I20B-EXIT.                                                       72570000
725800     EXIT.                                                        72580000
725900                                                                  72590000
726000     EJECT                                                        72600000
726100***************************************************************** 72610000
726200*                I20C-ADD-BLANK-HEADING                         * 72620000
726300*                                                               * 72630000
726400*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 72640000
726500*       1. CREATE BLANK HEADING DATA TO INSERT TO USA2          * 72650000
726600*                                                               * 72660000
726700***************************************************************** 72670000
726800 I20C-ADD-BLANK-HEADING SECTION.                                  72680000
726900                                                                  72690000
727000     MOVE EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                72700000
727100      TO  WS-015127-BLANK                                         72710000
727200                                                                  72720000
727300     MOVE 7 TO MLTPL-VAR-CNTR OF WS-015127-BLANK                  72730000
727400     MOVE SPACES TO PHRS-VAR-DATA OF WS-015127-BLANK              72740000
727500     MOVE 'TOTBL' TO PHRS-MSG-CD OF WS-015127-BLANK               72750000
727600     MOVE SA-BILL-SECT-1-10 OF I1005LK3 (SORT-REC-IDX)            72760000
727700       TO WS-HD-BILL-SECT-1-10                                    72770000
727800                                                                  72780000
727900     MOVE SPACES TO SA-BILL-SECT-3 OF I1005LK3 (SORT-REC-IDX)     72790000
728000     MOVE SPACES TO SA-BILL-SECT-4 OF I1005LK3 (SORT-REC-IDX)     72800000
728100     MOVE SPACES TO SA-BILL-SECT-5 OF I1005LK3 (SORT-REC-IDX)     72810000
728200                                                                  72820000
728300     MOVE WS-015127-BLANK TO                                      72830000
728400       EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                   72840000
728500                                                                  72850000
728600*    MOVE RCD-015127 OF I1060LK2 (SAV-015127-IDX)                 72860000
728700*      TO EMI-RECORD-AR OF I1005LK3 (SORT-REC-IDX)                72870000
728800*                                                                 72880000
728900*    MOVE PHRS-TYP-IND OF RCD-015127 OF I1060LK2 (SAV-015127-IDX) 72890000
729000*      TO TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)        72900000
729100*                                                                 72910000
729200     MOVE 'N'                                                     72920000
729300       TO TRANSLATED-PHRASE-TYP OF I1005LK3 (SORT-REC-IDX)        72930000
729400                                                                  72940000
729500     MOVE 'N' TO SPLR-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)       72950000
729600     MOVE 'N' TO SPLR-TEXT-PROV-INDR  OF I1005LK3 (SORT-REC-IDX)  72960000
729700                                                                  72970000
729800     PERFORM I200-INSERT-XZ8USA2T THRU I200-EXIT                  72980000
729900                                                                  72990000
730000     MOVE WS-HD-BILL-SECT-1-10                                    73000000
730100       TO SA-BILL-SECT-1-10 OF I1005LK3 (SORT-REC-IDX)            73010000
730200                                                                  73020000
730300     IF USE-RECORD-INDR  OF I1005LK3(SORT-REC-IDX) = LT-N         73030000
730400         ADD +1 TO WS-RCD-NOT-PRTD-NO                             73040000
730500     END-IF                                                       73050000
730600     ADD +1 TO WS-SUM-RCD-CRTE-NO.                                73060000
730700                                                                  73070000
730800 I20C-EXIT.                                                       73080000
730900     EXIT.                                                        73090000
731000                                                                  73100000
731100     EJECT                                                        73110000
731200***************************************************************** 73120000
731300*                I300-INSERT-XZ8USA7T                           * 73130000
731400*                                                               * 73140000
731500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 73150000
731600*      1. INSERT XZ8USA7T RECORD.                               * 73160000
731700*                                                               * 73170000
731800***************************************************************** 73180000
731900 I300-INSERT-XZ8USA7T SECTION.                                    73190000
732000     MOVE 'I300' TO PROG-PAR-NO                                   73200000
732100     MOVE SPACES TO WS-SPLR-INTRNL-ACC-NO-VAL                     73210000
732200                                                                  73220000
732300     MOVE SPLR-ID      OF XIRI004Y TO SPLR-ID    OF XIRI044Y      73230000
732400     MOVE PTN-ID       OF XIRI004Y TO PTN-ID     OF XIRI044Y      73240000
732500     MOVE USG-ID       OF XIRI004Y TO USG-ID     OF XIRI044Y      73250000
732600     MOVE USG-SEQ-NO   OF XIRI004Y TO USG-SEQ-NO OF XIRI044Y      73260000
732700     MOVE TRMSN-TMSTMP OF XIRI004Y TO TRMSN-TMSTMP OF XIRI044Y    73270000
732800     MOVE EXCH-MSG-OBLGTN-ID  OF XIRI004Y                         73280000
732900       TO EXCH-MSG-OBLGTN-ID  OF XIRI044Y                         73290000
733000     MOVE TOT-REV-AMT         OF XIRI004Y                         73300000
733100       TO TOT-REV-AMT         OF XIRI044Y                         73310000
733200     MOVE TOT-MSG-NO          OF XIRI004Y                         73320000
733300       TO TOT-MSG-NO          OF XIRI044Y                         73330000
733400     MOVE TOT-SUM-RCD-NO      OF XIRI004Y                         73340000
733500       TO TOT-SUM-RCD-NO      OF XIRI044Y                         73350000
733600     MOVE RCD-ID              OF TRMSN-ACPTNC-RCD                 73360000
733700       TO EXCH-MSG-RCD-ID     OF XIRI044Y                         73370000
733800     MOVE EXCH-MSG-BLG-NO     OF XIRI004Y                         73380000
733900       TO EXCH-MSG-BLG-NO     OF XIRI044Y                         73390000
734000     MOVE EXCH-MSG-CUST-CD    OF XIRI004Y                         73400000
734100       TO EXCH-MSG-CUST-CD    OF XIRI044Y                         73410000
734200     MOVE SPLR-INTRNL-SER-ID  OF XIRI004Y                         73420000
734300       TO SPLR-INTRNL-SER-ID  OF XIRI044Y                         73430000
734400     MOVE SPLR-INTRNL-ACC-NO  OF XIRI004Y                         73440000
734500       TO SPLR-INTRNL-ACC-NO  OF XIRI044Y                         73450000
734600     MOVE EMI-RCD             OF TRMSN-ACPTNC-RCD                 73460000
734700       TO EXCH-MSG-INTFC-DA   OF XIRI044Y                         73470000
734800     MOVE APPLCN-BLG-GR-ID    OF XIRI004Y                         73480000
734900       TO APPLCN-BLG-GR-ID    OF XIRI044Y                         73490000
735000                                                                  73500000
735100                                                                  73510000
735200     INITIALIZE WS-RETRY-CNT                                      73520000
735300     SET LOCKED-OUT            TO TRUE                            73530000
735400     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           73540000
735500          OR NOT LOCKED                                           73550000
735600        EXEC SQL                                                  73560000
735700            INCLUDE XIRI44I1                                      73570000
735800        END-EXEC                                                  73580000
735900        ADD +1                 TO WS-RETRY-CNT                    73590000
736000        MOVE SQLCODE           TO WS-LOCKOUT-VALUES               73600000
736100     END-PERFORM                                                  73610000
736200                                                                  73620000
736300        EVALUATE SQLCODE                                          73630000
736400            WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES          73640000
736500                ADD +1 TO WS-XIRI044Y-RCD-INS                     73650000
736600            WHEN OTHER                                            73660000
736700                MOVE ERR-3999 TO ERRR-CD OF E1000LK1              73670000
736800                MOVE LT-XIRI044Y TO VW-NM OF Z9000LK1             73680000
736900                MOVE SQLCA TO SQLCA-AR OF Z9000LK1                73690000
737000                MOVE WS-USA7T-ERRR-MSG TO                         73700000
737100                    ERRR-DISPL-FLDS OF Z9000LK1 (1)               73710000
737200                PERFORM E100-PROCESS-ERRORS THRU E100-EXIT        73720000
737300        END-EVALUATE                                              73730000
737400     .                                                            73740000
737500 I300-EXIT.                                                       73750000
737600     EXIT.                                                        73760000
737700                                                                  73770000
737800     EJECT                                                        73780000
737900***************************************************************** 73790000
738000*                I400-INSERT-XZ4AUA4T                           * 73800000
738100*                                                               * 73810000
738200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 73820000
738300*       1. INSERTS THE DATETIME STAMP WHEN THE FILE COMPLETED   * 73830000
738400*          ASSOCIATION ON THE TRANSMISSION INITIAL ASSOCIATION  * 73840000
738500*          STATUS TABLE.                                        * 73850000
738600*                                                               * 73860000
738700***************************************************************** 73870000
738800 I400-INSERT-XZ4AUA4T SECTION.                                    73880000
738900     MOVE 'I400' TO PROG-PAR-NO                                   73890000
739000     MOVE TB-SPLR              TO SPLR-ID      OF XIRI013Y        73900000
739100     MOVE WS-TRMSN-ID          TO TRMSN-TMSTMP OF XIRI013Y        73910000
739200     MOVE WS-TRMSN-SEQ-NO      TO TRMSN-SEQ-NO OF XIRI013Y        73920000
739300     IF TB-XIRI004Y-RCD-INS EQUAL ZEROS                           73930000
739400         MOVE 7777777777777 TO RIM-COMPLN-NO      OF XIRI013Y     73940000
739500     ELSE                                                         73950000
739600         MOVE ZEROES      TO RIM-COMPLN-NO      OF XIRI013Y       73960000
739700     END-IF                                                       73970000
739800*** TR# 137942   ALAN MASI   03/30/95                             73980000
739900*                                                                 73990000
740000* ADDED CODE TO INITIALIZE NEW FIELD ADDED TO AUA4 TABLE          74000000
740100*                                                                 74010000
740200     IF PRCSS-ICE-ENA                                             74020000
740300       IF WS-PACK-TYPE = '3'                                      74030000
740400         MOVE WS-TIMESTAMP TO ASSN-COMPLN-TMSTMP OF XIRI013Y      74040000
740500         MOVE 7777777777777 TO RIM-COMPLN-NO OF XIRI013Y          74050000
740600         PERFORM C100-CALL-XIRZ1000 THRU C100-EXIT                74060000
740700         MOVE DB2-FMAT-DAT-TMSTMP                                 74070000
740800           TO INV-COMPLN-TMSTMP OF XIRI013Y                       74080000
740900       ELSE                                                       74090000
741000         MOVE LT-DFLT-TMSTMP TO INV-COMPLN-TMSTMP OF XIRI013Y,    74100000
741100                               ASSN-COMPLN-TMSTMP OF XIRI013Y     74110000
741200       END-IF                                                     74120000
741300     ELSE                                                         74130000
741400       MOVE LT-DFLT-TMSTMP TO INV-COMPLN-TMSTMP OF XIRI013Y,      74140000
741500                             ASSN-COMPLN-TMSTMP OF XIRI013Y       74150000
741600     END-IF                                                       74160000
741700                                                                  74170000
741800     INITIALIZE WS-RETRY-CNT                                      74180000
741900     SET LOCKED-OUT            TO TRUE                            74190000
742000     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           74200000
742100          OR NOT LOCKED                                           74210000
742200        EXEC SQL                                                  74220000
742300            INCLUDE XIRI13I1                                      74230000
742400        END-EXEC                                                  74240000
742500        ADD +1                 TO WS-RETRY-CNT                    74250000
742600        MOVE SQLCODE           TO WS-LOCKOUT-VALUES               74260000
742700     END-PERFORM                                                  74270000
742800     EVALUATE SQLCODE                                             74280000
742900         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             74290000
743000             ADD +1            TO WS-XIRI013Y-RCD-INS             74300000
743100         WHEN OTHER                                               74310000
743200             MOVE ERR-3999     TO ERRR-CD OF E1000LK1             74320000
743300             MOVE LT-XIRI013Y  TO VW-NM OF Z9000LK1               74330000
743400             MOVE SQLCA        TO SQLCA-AR OF Z9000LK1            74340000
743500             MOVE WS-AUA4T-ERRR-MSG                               74350000
743600               TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                 74360000
743700             MOVE TRMSN-TMSTMP OF XIRI013Y                        74370000
743800               TO WS-ERRR-VAL                                     74380000
743900             MOVE 'TRMSN-TMSTMP' TO WS-ERRR-LTRL                  74390000
744000             MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1(2) 74400000
744100             MOVE TRMSN-SEQ-NO OF XIRI013Y                        74410000
744200               TO WS-ERRR-VAL                                     74420000
744300             MOVE 'TRMSN-SEQ-NO' TO WS-ERRR-LTRL                  74430000
744400             MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1(3) 74440000
744500             MOVE ASSN-COMPLN-TMSTMP OF XIRI013Y                  74450000
744600               TO WS-ERRR-VAL                                     74460000
744700             MOVE 'ASSN-COMPLN-TMSTMP' TO WS-ERRR-LTRL            74470000
744800             MOVE WS-ERRR-DISPL TO ERRR-DISPL-FLDS OF Z9000LK1(4) 74480000
744900             MOVE SPACES TO MDLE-ID OF Z9000LK1                   74490000
745000             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           74500000
745100     END-EVALUATE                                                 74510000
745200     .                                                            74520000
745300 I400-EXIT.                                                       74530000
745400     EXIT.                                                        74540000
745500                                                                  74550000
745600     EJECT                                                        74560000
745700***************************************************************** 74570000
745800*                K000-COMMIT                                    * 74580000
745900*                                                               * 74590000
746000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 74600000
746100*       1. CHANGE FIRST TIME FLAG                               * 74610000
746200*       2. EXECUTE A COMMIT TO FREE RUN CONTROL TABLE.          * 74620000
746300*                                                               * 74630000
746400***************************************************************** 74640000
746500 K000-COMMIT SECTION.                                             74650000
746600     MOVE 'K000' TO PROG-PAR-NO                                   74660000
746700     SET NOT-FIRST-TIME-IN-K000 TO TRUE                           74670000
746800     EXEC SQL                                                     74680000
746900        COMMIT                                                    74690000
747000     END-EXEC                                                     74700000
747100     .                                                            74710000
747200 K000-EXIT.                                                       74720000
747300     EXIT.                                                        74730000
747400                                                                  74740000
747500     EJECT                                                        74750000
747600***************************************************************** 74760000
747700*                R100 RLSE RECORD                               * 74770000
747800*                                                               * 74780000
747900*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 74790000
748000*       1. WRITE SORT KEY TO TESTING FILE.                      * 74800000
748100*       2. RELEASE THE SORT RECORD.                             * 74810000
748200*                                                               * 74820000
748300***************************************************************** 74830000
748400 R100-RLSE-RECORD SECTION.                                        74840000
748500     MOVE 'R100' TO PROG-PAR-NO                                   74850000
748600                                                                  74860000
748700**** TR# 139012   ALAN MASI   04/20/95                            74870000
748800*                                                                 74880000
748900* ADDED CODE TO ALLOW USG-ID'S TO SORT IN CORRECT ORDER WITH      74890000
749000* NEW USG-ID'S BEING CREATED BY S1000.  THE FIRST TWO DIGITS OF   74900000
749100* THE USG-ID IS NOW GOING TO ROTATE BETWEEN THE VALID VALUES      74910000
749200* ASSIGNED TO A SUPPLIER. THE FIRST TWO DIGITS WILL BE MOVED      74920000
749300* TO THE END OF THE USG-ID GOING INTO THE SORT AND BACK TO THE    74930000
749400* FRONT RETURNING FROM THE SORT.                                  74940000
749500*                                                                 74950000
749600     MOVE SORT-RECORD(1:26) TO WS-CONVERT-USG-ID                  74960000
749700     MOVE WS-CONV-1 TO WS-CNVTD-4                                 74970000
749800     MOVE WS-CONV-2 TO WS-CNVTD-3                                 74980000
749900     MOVE WS-CONVRTD-USG-ID TO SORT-RECORD(1:26)                  74990000
750000                                                                  75000000
750100     MOVE SORT-RECORD TO I100004O                                 75010000
750200     WRITE I100004O                                               75020000
750300                                                                  75030000
750400     RELEASE SORT-RECORD                                          75040000
750500     .                                                            75050000
750600 R100-EXIT.                                                       75060000
750700     EXIT.                                                        75070000
750800                                                                  75080000
750900     EJECT                                                        75090000
751000***************************************************************** 75100000
751100*                R200 READ I100001I                             * 75110000
751200*                                                               * 75120000
751300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 75130000
751400*       1. READS A RECORD FROM THE INPUT I100001I FILE.         * 75140000
751500*                                                               * 75150000
751600***************************************************************** 75160000
751700 R200-READ-I100001I SECTION.                                      75170000
751800     MOVE 'R200' TO PROG-PAR-NO                                   75180000
751900     MOVE USG-ID OF TRMSN-ACPTNC-RCD TO WS-PREV-USG-ID            75190000
752000     MOVE USG-SEQ-NO OF TRMSN-ACPTNC-RCD TO WS-PREV-USG-SEQ-NO    75200000
752100     READ FD-I100001I                                             75210000
752200         AT END SET FILE-I100001I-EOF TO TRUE                     75220000
752300     END-READ                                                     75230000
752400     MOVE INV-IN-1I TO TRMSN-ACPTNC-RCD                           75240000
752500     IF HOLD-RCPT-DAT = SPACES                                    75250000
752600         MOVE RCPT-DAT OF TRMSN-ACPTNC-RCD TO HOLD-RCPT-DAT       75260000
752700     END-IF                                                       75270000
752800     ADD +1 TO WS-INV-IN-RCD-CNT                                  75280000
752900     ADD +1 TO WS-INV-IN-SPLR-CNT                                 75290000
753000     ADD +1 TO WS-TOT-IN-FILE-CNT                                 75300000
753100     IF TB-NOT-SORT-INPUT                                         75310000
753200         PERFORM A300-DETERMINE-IF-CHK-PNT THRU A300-EXIT         75320000
753300     END-IF                                                       75330000
753400     .                                                            75340000
753500 R200-EXIT.                                                       75350000
753600     EXIT.                                                        75360000
753700                                                                  75370000
753800     EJECT                                                        75380000
753900***************************************************************** 75390000
754000*                S400-LOAD-RAO-TBL                              * 75400000
754100*                                                               * 75410000
754200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 75420000
754300*       1. OPEN RAO CURSOR                                      * 75430000
754400*       2. FETCH AND STORE IN W.S. EACH RAO/NPA UNTIL EOF.      * 75440000
754500*       3. CLOSE RAO CURSOR                                     * 75450000
754600*                                                               * 75460000
754700***************************************************************** 75470000
754800 S400-LOAD-RAO-TBL SECTION.                                       75480000
754900     MOVE 'S400' TO PROG-PAR-NO                                   75490000
755000     MOVE WS-APPLCN-LOCN-ID      TO APPLCN-LOCN-ID OF XIRI001Y    75500000
755100                                                                  75510000
755200     PERFORM S410-OPEN-RAO-CURSOR THRU S410-EXIT                  75520000
755300                                                                  75530000
755400     PERFORM S420-FETCH-RAO-CURSOR THRU S420-EXIT                 75540000
755500                                                                  75550000
755600     PERFORM                                                      75560000
755700       VARYING WS-RAO-IDX FROM 1 BY 1                             75570000
755800       UNTIL SQLCODE = LT-REC-NOT-FOUND                           75580000
755900          OR WS-RAO-IDX > LT-RAO-TABLE-LENGTH                     75590000
756000             MOVE NO-PL-AR-ID OF XIRI001Y                         75600000
756100               TO WS-NO-PL-AR-ID (WS-RAO-IDX)                     75610000
756200             MOVE RVN-ACCTG-OFC-CD OF XIRI001Y                    75620000
756300               TO WS-RVN-ACCTG-OFC-CD (WS-RAO-IDX)                75630000
756400             PERFORM S420-FETCH-RAO-CURSOR THRU S420-EXIT         75640000
756500     END-PERFORM                                                  75650000
756600                                                                  75660000
756700     PERFORM S430-CLOSE-RAO-CURSOR THRU S430-EXIT                 75670000
756800     .                                                            75680000
756900 S400-EXIT.                                                       75690000
757000     EXIT.                                                        75700000
757100                                                                  75710000
757200     EJECT                                                        75720000
757300***************************************************************** 75730000
757400*                S410-OPEN-RAO-CURSOR                           * 75740000
757500*                                                               * 75750000
757600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 75760000
757700*       1. THE CURSOR FOR THE RAO TABLE IS OPENED.              * 75770000
757800*                                                               * 75780000
757900***************************************************************** 75790000
758000 S410-OPEN-RAO-CURSOR SECTION.                                    75800000
758100     MOVE 'S410' TO PROG-PAR-NO                                   75810000
758200     EXEC SQL                                                     75820000
758300       INCLUDE XIRI01C1                                           75830000
758400     END-EXEC.                                                    75840000
758500     INITIALIZE WS-RETRY-CNT                                      75850000
758600     SET LOCKED-OUT TO TRUE                                       75860000
758700     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           75870000
758800             OR NOT LOCKED                                        75880000
758900         EXEC SQL                                                 75890000
759000             INCLUDE XIRI01O1                                     75900000
759100         END-EXEC                                                 75910000
759200         ADD +1       TO WS-RETRY-CNT                             75920000
759300         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        75930000
759400     END-PERFORM                                                  75940000
759500     EVALUATE SQLCODE                                             75950000
759600         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             75960000
759700              CONTINUE                                            75970000
759800         WHEN OTHER                                               75980000
759900              MOVE ERR-3999             TO ERRR-CD OF E1000LK1    75990000
760000              MOVE LT-XIRI001Y          TO VW-NM OF Z9000LK1      76000000
760100              MOVE SQLCA                TO SQLCA-AR OF Z9000LK1   76010000
760200              MOVE WS-DSB2T-ERRR-MSG    TO                        76020000
760300                  ERRR-DISPL-FLDS OF Z9000LK1 (1)                 76030000
760400              MOVE WS-APPLCN-LOC-LTRL   TO WS-ERRR-LTRL           76040000
760500              MOVE WS-APPLCN-LOCN-ID    TO WS-ERRR-VAL            76050000
760600              MOVE WS-ERRR-DISPL        TO                        76060000
760700                  ERRR-DISPL-FLDS OF Z9000LK1 (2)                 76070000
760800              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          76080000
760900     END-EVALUATE                                                 76090000
761000     .                                                            76100000
761100 S410-EXIT.                                                       76110000
761200     EXIT.                                                        76120000
761300                                                                  76130000
761400     EJECT                                                        76140000
761500***************************************************************** 76150000
761600*                S420-FETCH-RAO-CURSOR                          * 76160000
761700*                                                               * 76170000
761800*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 76180000
761900*       1. THE NEXT ROW IS PULLED FROM THE CURSOR.              * 76190000
762000*                                                               * 76200000
762100***************************************************************** 76210000
762200 S420-FETCH-RAO-CURSOR SECTION.                                   76220000
762300     MOVE 'S420' TO PROG-PAR-NO                                   76230000
762400     INITIALIZE WS-RETRY-CNT                                      76240000
762500     SET LOCKED-OUT TO TRUE                                       76250000
762600     PERFORM                                                      76260000
762700        UNTIL RESTART-PROG-RETRY-NO IS EQUAL TO  WS-RETRY-CNT     76270000
762800           OR NOT LOCKED                                          76280000
762900         EXEC SQL                                                 76290000
763000             INCLUDE XIRI01F1                                     76300000
763100         END-EXEC                                                 76310000
763200         ADD +1       TO WS-RETRY-CNT                             76320000
763300         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        76330000
763400     END-PERFORM                                                  76340000
763500     EVALUATE SQLCODE                                             76350000
763600         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             76360000
763700              ADD +1                  TO WS-XIRI001Y-RCD-FET      76370000
763800         WHEN LT-REC-NOT-FOUND OF LT-DB2-RETURN-CODES             76380000
763900              CONTINUE                                            76390000
764000         WHEN OTHER                                               76400000
764100              MOVE ERR-3999           TO ERRR-CD OF E1000LK1      76410000
764200              MOVE LT-XIRI001Y        TO VW-NM OF Z9000LK1        76420000
764300              MOVE SQLCA              TO SQLCA-AR OF Z9000LK1     76430000
764400              MOVE WS-DSB2T-ERRR-MSG  TO                          76440000
764500                  ERRR-DISPL-FLDS OF Z9000LK1 (1)                 76450000
764600              MOVE WS-APPLCN-LOC-LTRL TO WS-ERRR-LTRL             76460000
764700              MOVE WS-APPLCN-LOCN-ID  TO WS-ERRR-VAL              76470000
764800              MOVE WS-ERRR-DISPL      TO                          76480000
764900                   ERRR-DISPL-FLDS OF Z9000LK1 (2)                76490000
765000              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          76500000
765100     END-EVALUATE                                                 76510000
765200     .                                                            76520000
765300 S420-EXIT.                                                       76530000
765400     EXIT.                                                        76540000
765500                                                                  76550000
765600     EJECT                                                        76560000
765700***************************************************************** 76570000
765800*                S430-CLOSE-RAO-CURSOR                          * 76580000
765900*                                                               * 76590000
766000*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 76600000
766100*       1. THE CURSOR FOR THE RAO TABLE IS CLOSED.              * 76610000
766200*                                                               * 76620000
766300***************************************************************** 76630000
766400 S430-CLOSE-RAO-CURSOR SECTION.                                   76640000
766500     MOVE 'S430' TO PROG-PAR-NO                                   76650000
766600     INITIALIZE WS-RETRY-CNT                                      76660000
766700     SET LOCKED-OUT   TO TRUE                                     76670000
766800     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           76680000
766900             OR NOT LOCKED                                        76690000
767000         EXEC SQL                                                 76700000
767100             INCLUDE XIRI01K1                                     76710000
767200         END-EXEC                                                 76720000
767300         ADD +1       TO WS-RETRY-CNT                             76730000
767400         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        76740000
767500     END-PERFORM                                                  76750000
767600     EVALUATE SQLCODE                                             76760000
767700         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             76770000
767800              CONTINUE                                            76780000
767900         WHEN OTHER                                               76790000
768000              MOVE ERR-3999          TO ERRR-CD OF E1000LK1       76800000
768100              MOVE LT-XIRI001Y       TO VW-NM OF Z9000LK1         76810000
768200              MOVE SQLCA             TO SQLCA-AR OF Z9000LK1      76820000
768300              MOVE WS-DSB2T-ERRR-MSG TO                           76830000
768400                  ERRR-DISPL-FLDS OF Z9000LK1 (1)                 76840000
768500              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          76850000
768600     END-EVALUATE                                                 76860000
768700     .                                                            76870000
768800 S430-EXIT.                                                       76880000
768900     EXIT.                                                        76890000
769000                                                                  76900000
769100     EJECT                                                        76910000
769200***************************************************************** 76920000
769300*                S500-GET-RAO-IND                               * 76930000
769400*                                                               * 76940000
769500*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 76950000
769600*       1. SELECT THE RAO INDICATOR BY REGION.  THE RAO         * 76960000
769700*          INDICATOR IS A FLAG INDICATING WHETHER OR NOT TO     * 76970000
769800*          PROCESS CROSS BORDER POINTS.                         * 76980000
769900*                                                               * 76990000
770000***************************************************************** 77000000
770100 S500-GET-RAO-IND SECTION.                                        77010000
770200     MOVE 'S500' TO PROG-PAR-NO                                   77020000
770300     MOVE WS-APPLCN-RGN-ID TO APPLCN-RGN-ID OF XIRI002Y           77030000
770400     INITIALIZE WS-RETRY-CNT                                      77040000
770500     SET LOCKED-OUT    TO TRUE                                    77050000
770600     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           77060000
770700             OR NOT LOCKED                                        77070000
770800         EXEC SQL                                                 77080000
770900             INCLUDE XIRI02S1                                     77090000
771000         END-EXEC                                                 77100000
771100         ADD +1        TO WS-RETRY-CNT                            77110000
771200         MOVE SQLCODE  TO WS-LOCKOUT-VALUES                       77120000
771300     END-PERFORM                                                  77130000
771400     EVALUATE SQLCODE                                             77140000
771500         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             77150000
771600              ADD +1 TO WS-XIRI002Y-RCD-SEL                       77160000
771700         WHEN OTHER                                               77170000
771800              MOVE ERR-3999           TO ERRR-CD OF E1000LK1      77180000
771900              MOVE LT-XIRI002Y        TO VW-NM OF Z9000LK1        77190000
772000              MOVE SQLCA              TO SQLCA-AR OF Z9000LK1     77200000
772100              MOVE WS-DSB4T-ERRR-MSG  TO                          77210000
772200                  ERRR-DISPL-FLDS OF  Z9000LK1 (1)                77220000
772300              MOVE WS-APPLCN-RGN-LTRL TO WS-ERRR-LTRL             77230000
772400              MOVE WS-APPLCN-RGN-ID   TO WS-ERRR-VAL              77240000
772500              MOVE WS-ERRR-DISPL      TO                          77250000
772600                  ERRR-DISPL-FLDS OF Z9000LK1 (2)                 77260000
772700              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          77270000
772800     END-EVALUATE                                                 77280000
772900     .                                                            77290000
773000 S500-EXIT.                                                       77300000
773100     EXIT.                                                        77310000
773200                                                                  77320000
773300     EJECT                                                        77330000
773400***************************************************************** 77340000
773500*                S600-GET-ERRR-THRSHLD-NO                       * 77350000
773600*                                                               * 77360000
773700*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 77370000
773800*       1. GET THE DUPLICATE THRESHOLD NUMBER WHICH IS THE      * 77380000
773900*          MAXIMUM NUMBER OF ERRORS THAT CAN OCCUR FOR THE      * 77390000
774000*          FOLLOWING TYPES BEFORE A SEVERE ERROR IS ISSUED:     * 77400000
774100*          A) DUPLICATE INVOICES                                * 77410000
774200*          B) FI CNTLS OUT OF BALANCE                           * 77420000
774300*          C) NOPR ERRORS                                       * 77430000
774400*          D) OUT OF BALANCE ERRORS                             * 77440000
774500*                                                               * 77450000
774600***************************************************************** 77460000
774700 S600-GET-ERRR-THRSHLD-NO SECTION.                                77470000
774800     MOVE 'S600' TO PROG-PAR-NO                                   77480000
774900     MOVE LT-XIRI1000  TO PROG-ID OF XIRI006Y                     77490000
775000     MOVE LT-REGENTRY  TO FUNC-ID OF XIRI006Y                     77500000
775100     MOVE WS-CURR-SPLR TO SPLR-ID OF XIRI006Y                     77510000
775200     INITIALIZE WS-RETRY-CNT                                      77520000
775300     SET LOCKED-OUT    TO TRUE                                    77530000
775400     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           77540000
775500             OR NOT LOCKED                                        77550000
775600         EXEC SQL                                                 77560000
775700             INCLUDE XIRI06S1                                     77570000
775800         END-EXEC                                                 77580000
775900         ADD +1        TO WS-RETRY-CNT                            77590000
776000         MOVE SQLCODE  TO WS-LOCKOUT-VALUES                       77600000
776100     END-PERFORM                                                  77610000
776200     EVALUATE SQLCODE                                             77620000
776300         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             77630000
776400              ADD +1 TO WS-XIRI006Y-RCD-SEL                       77640000
776500              MOVE TH-ERRR-NO OF XIRI006Y TO WS-TH-ERRR-NO        77650000
776600         WHEN OTHER                                               77660000
776700              MOVE ERR-3999          TO ERRR-CD  OF E1000LK1      77670000
776800              MOVE LT-XIRI006Y       TO VW-NM    OF Z9000LK1      77680000
776900              MOVE SQLCA             TO SQLCA-AR OF Z9000LK1      77690000
777000              MOVE WS-DSC7T-ERRR-MSG                              77700000
777100                TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                77710000
777200              MOVE WS-INVD-SPLR-LTRL TO WS-ERRR-LTRL              77720000
777300              MOVE WS-CURR-SPLR      TO WS-ERRR-VAL               77730000
777400              MOVE WS-ERRR-DISPL                                  77740000
777500                TO ERRR-DISPL-FLDS OF  Z9000LK1 (2)               77750000
777600              MOVE SPACES            TO WS-ERRR-LTRL              77760000
777700                                        WS-ERRR-VAL               77770000
777800              MOVE WS-INVD-FUNC-ID   TO WS-ERRR-LTRL              77780000
777900              MOVE LT-REGENTRY       TO WS-ERRR-VAL               77790000
778000              MOVE WS-ERRR-DISPL                                  77800000
778100                TO ERRR-DISPL-FLDS OF  Z9000LK1 (3)               77810000
778200              MOVE SPACES            TO WS-ERRR-LTRL              77820000
778300                                        WS-ERRR-VAL               77830000
778400              MOVE WS-INVD-MODULE    TO WS-ERRR-LTRL              77840000
778500              MOVE LT-XIRI1000       TO WS-ERRR-VAL               77850000
778600              MOVE WS-ERRR-DISPL                                  77860000
778700                TO ERRR-DISPL-FLDS OF  Z9000LK1 (4)               77870000
778800              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          77880000
778900     END-EVALUATE                                                 77890000
779000     .                                                            77900000
779100 S600-EXIT.                                                       77910000
779200     EXIT.                                                        77920000
779300                                                                  77930000
779400     EJECT                                                        77940000
779500***************************************************************** 77950000
779600*                S700-LOAD-INTRNL-ERRR-TBL                      * 77960000
779700*                                                               * 77970000
779800*    THIS PARAGRAPH LOADS THE INTERNAL/EXTERNAL ERROR TABLE.    * 77980000
779900*                                                               * 77990000
780000***************************************************************** 78000000
780100 S700-LOAD-INTRNL-ERRR-TBL SECTION.                               78010000
780200     MOVE 'S700' TO PROG-PAR-NO                                   78020000
780300     MOVE WS-CURR-SPLR  TO SPLR-ID OF XIRI034Y                    78030000
780400     MOVE LT-XIRI1000   TO PROG-ID OF XIRI034Y                    78040000
780500     PERFORM S710-OPEN-ERRR-CSR THRU S710-EXIT                    78050000
780600     PERFORM S720-FETCH-ERRR-CSR THRU S720-EXIT                   78060000
780700     PERFORM                                                      78070000
780800       VARYING WS-ERRR-IDX FROM 1 BY 1                            78080000
780900       UNTIL SQLCODE = LT-REC-NOT-FOUND                           78090000
781000          OR WS-ERRR-IDX > LT-ERRR-TBL-LENGTH                     78100000
781100             MOVE ERRR-CD OF XIRI034Y                             78110000
781200               TO WS-ERRR-CD (WS-ERRR-IDX)                        78120000
781300             MOVE INTRNL-ERRR-CD OF XIRI034Y                      78130000
781400               TO WS-INTRNL-ERRR-CD (WS-ERRR-IDX)                 78140000
781500             PERFORM S720-FETCH-ERRR-CSR THRU S720-EXIT           78150000
781600     END-PERFORM                                                  78160000
781700     PERFORM S730-CLOSE-ERRR-CSR THRU S730-EXIT                   78170000
781800     .                                                            78180000
781900 S700-EXIT.                                                       78190000
782000     EXIT.                                                        78200000
782100                                                                  78210000
782200     EJECT                                                        78220000
782300***************************************************************** 78230000
782400*                S710-OPEN-ERRR-CSR                             * 78240000
782500*                                                               * 78250000
782600*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 78260000
782700*       1. THE CURSOR FOR THE INTERNAL/EXTERNAL ERROR TABLE.    * 78270000
782800*                                                               * 78280000
782900***************************************************************** 78290000
783000 S710-OPEN-ERRR-CSR SECTION.                                      78300000
783100     MOVE 'S710' TO PROG-PAR-NO                                   78310000
783200     EXEC SQL                                                     78320000
783300       INCLUDE XIRI34C1                                           78330000
783400     END-EXEC                                                     78340000
783500     INITIALIZE WS-RETRY-CNT                                      78350000
783600     SET LOCKED-OUT TO TRUE                                       78360000
783700     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           78370000
783800             OR NOT LOCKED                                        78380000
783900         EXEC SQL                                                 78390000
784000             INCLUDE XIRI34O1                                     78400000
784100         END-EXEC                                                 78410000
784200         ADD +1       TO WS-RETRY-CNT                             78420000
784300         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        78430000
784400     END-PERFORM                                                  78440000
784500     EVALUATE SQLCODE                                             78450000
784600         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             78460000
784700              CONTINUE                                            78470000
784800         WHEN OTHER                                               78480000
784900              MOVE ERR-3999             TO ERRR-CD OF E1000LK1    78490000
785000              MOVE LT-XIRI034Y          TO VW-NM OF Z9000LK1      78500000
785100              MOVE SQLCA                TO SQLCA-AR OF Z9000LK1   78510000
785200              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          78520000
785300     END-EVALUATE                                                 78530000
785400     .                                                            78540000
785500 S710-EXIT.                                                       78550000
785600     EXIT.                                                        78560000
785700                                                                  78570000
785800     EJECT                                                        78580000
785900***************************************************************** 78590000
786000*                S720-FETCH-ERRR-CSR                            * 78600000
786100*                                                               * 78610000
786200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 78620000
786300*       1. THE NEXT ROW IS PULLED FROM THE CURSOR.              * 78630000
786400*                                                               * 78640000
786500***************************************************************** 78650000
786600 S720-FETCH-ERRR-CSR SECTION.                                     78660000
786700     MOVE 'S720' TO PROG-PAR-NO                                   78670000
786800     INITIALIZE WS-RETRY-CNT                                      78680000
786900     SET LOCKED-OUT TO TRUE                                       78690000
787000     PERFORM                                                      78700000
787100        UNTIL RESTART-PROG-RETRY-NO IS EQUAL TO  WS-RETRY-CNT     78710000
787200           OR NOT LOCKED                                          78720000
787300         EXEC SQL                                                 78730000
787400             INCLUDE XIRI34F1                                     78740000
787500         END-EXEC                                                 78750000
787600         ADD +1       TO WS-RETRY-CNT                             78760000
787700         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        78770000
787800     END-PERFORM                                                  78780000
787900     EVALUATE SQLCODE                                             78790000
788000         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             78800000
788100              CONTINUE                                            78810000
788200         WHEN LT-REC-NOT-FOUND OF LT-DB2-RETURN-CODES             78820000
788300              CONTINUE                                            78830000
788400         WHEN OTHER                                               78840000
788500              MOVE ERR-3999           TO ERRR-CD OF E1000LK1      78850000
788600              MOVE LT-XIRI034Y        TO VW-NM OF Z9000LK1        78860000
788700              MOVE SQLCA              TO SQLCA-AR OF Z9000LK1     78870000
788800              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          78880000
788900     END-EVALUATE                                                 78890000
789000     .                                                            78900000
789100 S720-EXIT.                                                       78910000
789200     EXIT.                                                        78920000
789300                                                                  78930000
789400     EJECT                                                        78940000
789500***************************************************************** 78950000
789600*                S730-CLOSE-ERRR-CSR                            * 78960000
789700*                                                               * 78970000
789800*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 78980000
789900*       1. THE CURSOR FOR THE INTERNAL/EXTERNAL ERROR TABLE IS  * 78990000
790000*          CLOSED.                                              * 79000000
790100***************************************************************** 79010000
790200 S730-CLOSE-ERRR-CSR SECTION.                                     79020000
790300     MOVE 'S730' TO PROG-PAR-NO                                   79030000
790400     INITIALIZE WS-RETRY-CNT                                      79040000
790500     SET LOCKED-OUT   TO TRUE                                     79050000
790600     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           79060000
790700             OR NOT LOCKED                                        79070000
790800         EXEC SQL                                                 79080000
790900             INCLUDE XIRI34K1                                     79090000
791000         END-EXEC                                                 79100000
791100         ADD +1       TO WS-RETRY-CNT                             79110000
791200         MOVE SQLCODE TO WS-LOCKOUT-VALUES                        79120000
791300     END-PERFORM                                                  79130000
791400     EVALUATE SQLCODE                                             79140000
791500         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             79150000
791600              CONTINUE                                            79160000
791700         WHEN OTHER                                               79170000
791800              MOVE ERR-3999          TO ERRR-CD OF E1000LK1       79180000
791900              MOVE LT-XIRI034Y       TO VW-NM OF Z9000LK1         79190000
792000              MOVE SQLCA             TO SQLCA-AR OF Z9000LK1      79200000
792100              MOVE WS-DSB2T-ERRR-MSG                              79210000
792200                TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                79220000
792300              PERFORM E100-PROCESS-ERRORS THRU E100-EXIT          79230000
792400     END-EVALUATE                                                 79240000
792500     .                                                            79250000
792600 S730-EXIT.                                                       79260000
792700     EXIT.                                                        79270000
792800                                                                  79280000
792900     EJECT                                                        79290000
793000***************************************************************** 79300000
793100*                S800-LOAD-DATA-DICT-TBL                        * 79310000
793200*                                                               * 79320000
793300*    THIS PARAGRAPH LOADS THE DATA DICTIONARY TABLE FROM THE    * 79330000
793400*    XIRI031Y VIEW.                                             * 79340000
793500*                                                               * 79350000
793600***************************************************************** 79360000
793700 S800-LOAD-DATA-DICT-TBL SECTION.                                 79370000
793800     MOVE 'S800' TO PROG-PAR-NO                                   79380000
793900     PERFORM                                                      79390000
794000       VARYING WS-DD-IDX FROM 1 BY 1                              79400000
794100       UNTIL WS-DD-IDX = LT-DATA-DICT-TBL-SZ                      79410000
794200         MOVE SPACES TO WS-REF-ELEM-NM (WS-DD-IDX)                79420000
794300         MOVE ZEROES TO WS-LNGTH-NO    (WS-DD-IDX)                79430000
794400         MOVE ZEROES TO WS-POS-NO      (WS-DD-IDX)                79440000
794500     END-PERFORM                                                  79450000
794600     SET NOT-EOF-DATA-DICT-CSR TO TRUE                            79460000
794700     MOVE WS-CURR-SPLR         TO SPLR-ID OF XIRI031Y             79470000
794800     MOVE WS-SAVE-FIL-TYP-INDR TO FIL-TYP OF XIRI031Y             79480000
794900     MOVE LT-DUPCHK            TO RCD-ID  OF XIRI031Y             79490000
795000     PERFORM S810-OPEN-DATA-DICT-CSR THRU S810-EXIT               79500000
795100     PERFORM S820-FETCH-DATA-DICT-CSR THRU S820-EXIT              79510000
795200     PERFORM                                                      79520000
795300       VARYING WS-DD-IDX FROM 1 BY 1                              79530000
795400       UNTIL EOF-DATA-DICT-CSR                                    79540000
795500          OR WS-DD-IDX = LT-DATA-DICT-TBL-SZ                      79550000
795600               MOVE REF-ELEM-NM OF XIRI031Y                       79560000
795700                 TO WS-REF-ELEM-NM (WS-DD-IDX)                    79570000
795800               MOVE LNGTH-NO    OF XIRI031Y                       79580000
795900                 TO WS-LNGTH-NO    (WS-DD-IDX)                    79590000
796000               MOVE POS-NO      OF XIRI031Y                       79600000
796100                 TO WS-POS-NO      (WS-DD-IDX)                    79610000
796200               PERFORM S820-FETCH-DATA-DICT-CSR THRU S820-EXIT    79620000
796300     END-PERFORM                                                  79630000
796400     PERFORM S830-CLOSE-DATA-DICT-CSR THRU S830-EXIT              79640000
796500     .                                                            79650000
796600 S800-EXIT.                                                       79660000
796700     EXIT.                                                        79670000
796800                                                                  79680000
796900     EJECT                                                        79690000
797000***************************************************************** 79700000
797100*                S810-OPEN-DATA-DICT-CSR                        * 79710000
797200*                                                               * 79720000
797300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 79730000
797400*    1. OPEN A CURSOR ON A JOIN OF DSE8 AND DSE3                * 79740000
797500*                                                               * 79750000
797600***************************************************************** 79760000
797700 S810-OPEN-DATA-DICT-CSR SECTION.                                 79770000
797800     MOVE 'S810' TO PROG-PAR-NO                                   79780000
797900     INITIALIZE WS-RETRY-CNT                                      79790000
798000     SET LOCKED-OUT TO TRUE                                       79800000
798100     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           79810000
798200          OR NOT LOCKED                                           79820000
798300        EXEC SQL                                                  79830000
798400            INCLUDE XIRI31C0                                      79840000
798500        END-EXEC                                                  79850000
798600        EXEC SQL                                                  79860000
798700            INCLUDE XIRI31O0                                      79870000
798800        END-EXEC                                                  79880000
798900        ADD +1 TO WS-RETRY-CNT                                    79890000
799000        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         79900000
799100     END-PERFORM                                                  79910000
799200     EVALUATE SQLCODE                                             79920000
799300         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             79930000
799400             CONTINUE                                             79940000
799500         WHEN OTHER                                               79950000
799600             DISPLAY 'ERROR IN PARA S810-'                        79960000
799700             DISPLAY ' SQLCODE = ', SQLCODE                       79970000
799800             MOVE ERR-3999    TO ERRR-CD OF E1000LK1              79980000
799900             MOVE LT-XIRI031Y TO VW-NM OF Z9000LK1                79990000
800000             MOVE SQLCA       TO SQLCA-AR OF Z9000LK1             80000000
800100             MOVE WS-DSE8T-ERRR-MSG TO                            80010000
800200                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  80020000
800300             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           80030000
800400     END-EVALUATE                                                 80040000
800500     .                                                            80050000
800600 S810-EXIT.                                                       80060000
800700     EXIT.                                                        80070000
800800                                                                  80080000
800900     EJECT                                                        80090000
801000***************************************************************** 80100000
801100*                S820-FETCH-DATA-DICT-CSR                       * 80110000
801200*                                                               * 80120000
801300*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 80130000
801400*    1. FETCH A ROW FROM THE CURSOR                             * 80140000
801500*                                                               * 80150000
801600***************************************************************** 80160000
801700 S820-FETCH-DATA-DICT-CSR SECTION.                                80170000
801800     MOVE 'S820' TO PROG-PAR-NO                                   80180000
801900     INITIALIZE WS-RETRY-CNT                                      80190000
802000     SET LOCKED-OUT TO TRUE                                       80200000
802100     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           80210000
802200          OR NOT LOCKED                                           80220000
802300        EXEC SQL                                                  80230000
802400            INCLUDE XIRI31F0                                      80240000
802500        END-EXEC                                                  80250000
802600        ADD +1 TO WS-RETRY-CNT                                    80260000
802700        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         80270000
802800     END-PERFORM                                                  80280000
802900     EVALUATE SQLCODE                                             80290000
803000         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             80300000
803100             ADD +1           TO WS-XIRI031Y-RCD-FET              80310000
803200         WHEN LT-REC-NOT-FOUND OF LT-DB2-RETURN-CODES             80320000
803300             SET EOF-DATA-DICT-CSR TO TRUE                        80330000
803400         WHEN OTHER                                               80340000
803500             DISPLAY 'ERROR IN PARA S820-'                        80350000
803600             DISPLAY ' SQLCODE = ', SQLCODE                       80360000
803700             MOVE ERR-3999    TO ERRR-CD OF E1000LK1              80370000
803800             MOVE LT-XIRI031Y TO VW-NM OF Z9000LK1                80380000
803900             MOVE SQLCA       TO SQLCA-AR OF Z9000LK1             80390000
804000             MOVE WS-DSE8T-ERRR-MSG TO                            80400000
804100                 ERRR-DISPL-FLDS OF Z9000LK1 (1)                  80410000
804200             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           80420000
804300     END-EVALUATE                                                 80430000
804400     .                                                            80440000
804500 S820-EXIT.                                                       80450000
804600     EXIT.                                                        80460000
804700                                                                  80470000
804800     EJECT                                                        80480000
804900***************************************************************** 80490000
805000*                S830-CLOSE-DATA-DICT-CSR                       * 80500000
805100*                                                               * 80510000
805200*    THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:           * 80520000
805300*    1. CLOSE THE CURSOR                                        * 80530000
805400*                                                               * 80540000
805500***************************************************************** 80550000
805600 S830-CLOSE-DATA-DICT-CSR SECTION.                                80560000
805700     MOVE 'S830' TO PROG-PAR-NO                                   80570000
805800     INITIALIZE WS-RETRY-CNT                                      80580000
805900     SET LOCKED-OUT TO TRUE                                       80590000
806000     PERFORM UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT           80600000
806100          OR NOT LOCKED                                           80610000
806200        EXEC SQL                                                  80620000
806300            INCLUDE XIRI31K0                                      80630000
806400        END-EXEC                                                  80640000
806500        ADD +1 TO WS-RETRY-CNT                                    80650000
806600        MOVE SQLCODE TO WS-LOCKOUT-VALUES                         80660000
806700     END-PERFORM                                                  80670000
806800     EVALUATE SQLCODE                                             80680000
806900         WHEN LT-NORMAL-RETURN OF LT-DB2-RETURN-CODES             80690000
807000             CONTINUE                                             80700000
807100         WHEN OTHER                                               80710000
807200             DISPLAY 'ERROR IN PARA S830-'                        80720000
807300             DISPLAY ' SQLCODE = ', SQLCODE                       80730000
807400             MOVE ERR-3999    TO ERRR-CD OF E1000LK1              80740000
807500             MOVE LT-XIRI031Y TO VW-NM OF Z9000LK1                80750000
807600             MOVE SQLCA       TO SQLCA-AR OF Z9000LK1             80760000
807700             MOVE WS-DSE8T-ERRR-MSG                               80770000
807800               TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                 80780000
807900             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           80790000
808000     END-EVALUATE                                                 80800000
808100     .                                                            80810000
808200 S830-EXIT.                                                       80820000
808300     EXIT.                                                        80830000
808400                                                                  80840000
808500     EJECT                                                        80850000
808600***************************************************************** 80860000
808700*                U100-UPDATE-XZ8USA1T                           * 80870000
808800*                                                               * 80880000
808900*    THIS PARAGRAPH CALLS THE ROUTINE WHICH UPDATES Z8USA1      * 80890000
809000*                                                               * 80900000
809100***************************************************************** 80910000
809200 U100-UPDATE-XZ8USA1T SECTION.                                    80920000
809300     MOVE 'U100' TO PROG-PAR-NO                                   80930000
809400     INITIALIZE WS-RETRY-CNT                                      80940000
809500     SET LOCKED-OUT TO TRUE                                       80950000
809600     PERFORM U110-UPDATE-TAXES THRU U110-EXIT                     80960000
809700       UNTIL RESTART-PROG-RETRY-NO = WS-RETRY-CNT                 80970000
809800          OR NOT LOCKED                                           80980000
809900                                                                  80990000
810000**** TR# 138943   ALAN MASI  04/12/95                             81000000
810100*                                                                 81010000
810200* ADDED CODE TO CHECK THAT THE TOT-REV-AMT ON THE USA1 TABLE      81020000
810300* IS EQUAL TO THE SUM OF TOT-EXCL-TX-AMT, FED-TX-AMT,             81030000
810400* LOC-ST-TX-AMT, AND MSG-SURCHG-AMT OF SAME RECORD.               81040000
810500*                                                                 81050000
810600     PERFORM D100-COMPARE-USA1-TOTALS THRU D100-EXIT.             81060000
810700                                                                  81070000
810800     EVALUATE SQLCODE                                             81080000
810900         WHEN LT-NORMAL-RETURN                                    81090000
811000             CONTINUE                                             81100000
811100         WHEN OTHER                                               81110000
811200             MOVE LT-XIRI004Y TO VW-NM OF Z9000LK1                81120000
811300             MOVE WS-USA1T-ERRR-MSG                               81130000
811400               TO ERRR-DISPL-FLDS OF Z9000LK1 (1)                 81140000
811500             MOVE USG-ID OF XIRI004Y TO WS-UPD-USG-ID             81150000
811600             MOVE WS-USG-ID-LTRL                                  81160000
811700               TO ERRR-DISPL-FLDS OF Z9000LK1 (2)                 81170000
811800             MOVE SQLCA TO SQLCA-AR OF Z9000LK1                   81180000
811900             MOVE ERR-3999 TO ERRR-CD OF E1000LK1                 81190000
812000             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           81200000
812100     END-EVALUATE                                                 81210000
812200     .                                                            81220000
812300 U100-EXIT.                                                       81230000
812400     EXIT.                                                        81240000
812500                                                                  81250000
812600     EJECT                                                        81260000
812700***************************************************************** 81270000
812800*                U110-UPDATE-TAXES                              * 81280000
812900*                                                               * 81290000
813000*    THIS PARAGRAPH UPDATES THE 015121 RECORD ON Z8USA1         * 81300000
813100*    WHEN ALL THE DETAIL RECORDS FOR THAT INVOICE HAVE BEEN     * 81310000
813200*    PROCESSED.                                                 * 81320000
813300*                                                               * 81330000
813400***************************************************************** 81340000
813500 U110-UPDATE-TAXES SECTION.                                       81350000
813600     MOVE 'U110' TO PROG-PAR-NO                                   81360000
813700     MOVE WS-SUM-RCD-CRTE-NO        TO SUM-RCD-CRTE-NO OF XIRI004Y81370000
813800     MOVE WS-RCD-NOT-PRTD-NO        TO RCD-NOT-PRTD-NO OF XIRI004Y81380000
813900                                                                  81390000
814000*** TR2173375  LAW   10/16/98                                     81400000
814100* ADDED DUPLICATE USG ID CODE                                     81410000
814200*                                                                 81420000
814300     IF WS-DUPLICATE-USG-ID = SPACES                              81430000
814400        MOVE WS-PRIOR-USG-ID        TO USG-ID OF XIRI004Y         81440000
814500     ELSE                                                         81450000
814600        MOVE WS-DUPLICATE-USG-ID    TO USG-ID OF XIRI004Y         81460000
814700     END-IF                                                       81470000
814800                                                                  81480000
814900     MOVE WS-PRIOR-USG-ID           TO USG-ID          OF XIRI004Y81490000
815000     MOVE WS-FED-TX-AMT             TO FED-TX-AMT      OF XIRI004Y81500000
815100     MOVE WS-LOC-ST-TX-AMT          TO LOC-ST-TX-AMT   OF XIRI004Y81510000
815200     MOVE WS-MSG-SURCHG-AMT         TO MSG-SURCHG-AMT  OF XIRI004Y81520000
815300                                                                  81530000
815400***  R961212 SJWETEK    09/17/96                                  81540000
815500*                                                                 81550000
815600*    MOVE SAVED INTER, INTRALTA FLDS TO USA1 TABLE                81560000
815700*    MOVE CODE FOR CARD-ONLY FROM U100- PARA                      81570000
815800*                                                                 81580000
815900     MOVE WS-INTERLTA-INV-INDR TO INTERLTA-INV-INDR OF XIRI004Y   81590000
816000     MOVE WS-INTRALTA-INV-INDR TO INTRALTA-INV-INDR OF XIRI004Y   81600000
816100                                                                  81610000
816200     MOVE WS-XIRI004Y-RVN-SCE-TYP-CD                              81620000
816300       TO RVN-SCE-TYP-CD OF XIRI004Y                              81630000
816400                                                                  81640000
816500*** TR#179839   ALAN MASI   10/16/96                              81650000
816600*                                                                 81660000
816700* ADDED CODE TO ONLY PERFORM U120- TO UPDATE RVN-SCE-TYP-CD       81670000
816800* ON USA1 FOR SPLR'S WITH TRAIT ALWAYS-NORMAL-INV = 'NO'.         81680000
816900* WHEN SET TO 'NO' THIS FIELD CAN BE SET TO CARD OR FEE.          81690000
817000*                                                                 81700000
817100     IF ALLOW-CARD-AND-FEES                                       81710000
817200        IF CARD-ONLY                                              81720000
817300           MOVE LT-C TO RVN-SCE-TYP-CD OF XIRI004Y                81730000
817400        END-IF                                                    81740000
817500     END-IF                                                       81750000
817600                                                                  81760000
817700     SUBTRACT WS-TOT-TX  FROM WS-TOT-REV                          81770000
817800       GIVING TOT-EXCL-TX-AMT OF XIRI004Y                         81780000
817900     EXEC SQL                                                     81790000
818000          INCLUDE XIRI04U1                                        81800000
818100     END-EXEC                                                     81810000
818200     ADD +1 TO WS-RETRY-CNT                                       81820000
818300     MOVE SQLCODE TO WS-LOCKOUT-VALUES                            81830000
818400     .                                                            81840000
818500 U110-EXIT.                                                       81850000
818600     EXIT.                                                        81860000
818700                                                                  81870000
818800     EJECT                                                        81880000
818900                                                                  81890000
819000***************************************************************** 81900000
819100*                Z000-MODULE-ABEND                              * 81910000
819200*                                                               * 81920000
819300*    THIS PARAGRAPH CALLS THE ABEND MODULE.                     * 81930000
819400*                                                               * 81940000
819500***************************************************************** 81950000
819600 Z000-MODULE-ABEND SECTION.                                       81960000
819700     MOVE FUNC-ID OF E1000LK1 TO FUNC-ID OF Z9000LK1              81970000
819800     MOVE PROG-ID OF E1000LK1 TO PROG-ID OF Z9000LK1              81980000
819900     MOVE ERRR-CD OF E1000LK1 TO ERRR-CD OF Z9000LK1              81990000
820000     MOVE ERRR-DA OF E1000LK1 TO ERRR-DA OF Z9000LK1              82000000
820100     MOVE SPLR-ID OF E1000LK1 TO SPLR-ID OF Z9000LK1              82010000
820200     MOVE ERRR-MSG-TEXT OF E1000LK1                               82020000
820300       TO ERRR-MSG-TEXT OF Z9000LK1                               82030000
820400     MOVE TRNSCTN-ID OF E1000LK1 TO TRNSCTN-ID OF Z9000LK1        82040000
820500     MOVE TRNSCTN-SEQ-NO OF E1000LK1                              82050000
820600       TO TRNSCTN-SEQ-NO OF Z9000LK1                              82060000
820700     MOVE WS-TIMESTAMP TO PROG-STRT-TMSTMP OF Z9000LK1            82070000
820800     IF DISPLAY-STD-MSGS                                          82080000
820900         PERFORM Z010-DISP-STD-MSGS THRU Z010-EXIT                82090000
821000     END-IF                                                       82100000
821100     CALL LT-XIRZ9000 USING Z9000LK1                              82110000
821200     .                                                            82120000
821300 Z000-EXIT.                                                       82130000
821400     EXIT.                                                        82140000
821500                                                                  82150000
821600     EJECT                                                        82160000
821700***************************************************************** 82170000
821800*                Z010-DISP-STD-MSGS                             * 82180000
821900*                                                               * 82190000
822000*    THIS PARAGRAPH FORMATS THE EXTRA DISPLAY FIELDS FOR THE    * 82200000
822100*    SYSOUT.                                                    * 82210000
822200*                                                               * 82220000
822300***************************************************************** 82230000
822400 Z010-DISP-STD-MSGS SECTION.                                      82240000
822500**                                                                82250000
822600*** FIND THE NEXT AVAILABLE ERROR LINE TO BE USED.                82260000
822700**                                                                82270000
822800     PERFORM                                                      82280000
822900       VARYING ERRR-IDX FROM 1 BY 1                               82290000
823000       UNTIL ERRR-DISPL-FLDS (ERRR-IDX) IS EQUAL TO SPACES        82300000
823100     END-PERFORM                                                  82310000
823200                                                                  82320000
823300     MOVE WS-INV-IN-RCD-CNT TO WS-INV-RCD-NO                      82330000
823400     MOVE WS-INV-RCD-NO-LTRL                                      82340000
823500       TO ERRR-DISPL-FLDS OF Z9000LK1 (ERRR-IDX)                  82350000
823600     SET  ERRR-IDX  UP BY  +1                                     82360000
823700     MOVE WS-FIRST-50-BYTES TO ERRR-DISPL-FLDS (ERRR-IDX)         82370000
823800     SET  ERRR-IDX  UP BY  +1                                     82380000
823900     MOVE TRMSN-ACPTNC-RCD TO ERRR-DISPL-FLDS (ERRR-IDX)          82390000
824000     .                                                            82400000
824100 Z010-EXIT.                                                       82410000
824200     EXIT.                                                        82420000
824300                                                                  82430000
824400     EJECT                                                        82440000
824500***************************************************************** 82450000
824600*                Z100-PRCSS-TNTH-MIN                            * 82460000
824700*                                                               * 82470000
824800*   THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:            * 82480000
824900*      1. CONVERTS BILLABLE MINUTES TO TENTHS OF MINUTES        * 82490000
825000*                                                               * 82500000
825100*                                                               * 82510000
825200*    CALLED FROM:                                               * 82520000
825300*    PARAGRAPHS CALLED:       NONE                              * 82530000
825400*                                                               * 82540000
825500***************************************************************** 82550000
825600 Z100-PRCSS-TNTH-MIN.                                             82560000
825700     COPY CNVTTIME.                                               82570000
825800     .                                                            82580000
825900 Z100-EXIT.                                                       82590000
826000     EXIT.                                                        82600000
826100                                                                  82610000
826200     EJECT                                                        82620000
826300***************************************************************** 82630000
826400*     Z700 CALL XIRZ7000 - COMMON TRAIT MODULE                  * 82640000
826500*                                                               * 82650000
826600*  THIS PARAGRAPH PERFORMS THE FOLLOWING FUNCTIONS:             * 82660000
826700*                                                               * 82670000
826800*  1.  CALL XIRZ7000 WITH THE CURRENT KEYS TO                   * 82680000
826900*      RETRIEVE THE CORRECT TRAIT-ID VALUE.                     * 82690000
827000*                                                               * 82700000
827100*    PARAGRAPHS CALLED: NONE.                                   * 82710000
827200*                                                               * 82720000
827300***************************************************************** 82730000
827400 Z700-CALL-XIRZ7000.                                              82740000
827500                                                                  82750000
827600     CALL LT-XIRZ7000 USING Z7000LK1.                             82760000
827700                                                                  82770000
827800     EVALUATE RTRN-CD OF Z7000LK1                                 82780000
827900         WHEN ZEROS                                               82790000
828000             CONTINUE                                             82800000
828100         WHEN OTHER                                               82810000
828200             MOVE RTRN-CD  OF Z7000LK1 TO ERRR-CD OF E1000LK1     82820000
828300             MOVE SQLCA-AR OF Z7000LK1 TO CMMN-SQLCA OF Z9000LK1  82830000
828400             MOVE VW-NM    OF Z7000LK1 TO VW-NM OF Z9000LK1       82840000
828500             MOVE SPLR-ID  OF Z7000LK1 TO WS-CURR-SPLR            82850000
828600             MOVE SPACES               TO TRNSCTN-ID OF E1000LK1  82860000
828700             MOVE ZEROES             TO TRNSCTN-SEQ-NO OF E1000LK182870000
828800             MOVE TRAIT-ID OF Z7000LK1  TO WS-TRAIT-CD-VAL        82880000
828900             MOVE WS-TRAIT-CD-MSG       TO ERRR-DISPL-FLDS (6)    82890000
829000             PERFORM E100-PROCESS-ERRORS THRU E100-EXIT           82900000
829100     END-EVALUATE                                                 82910000
829200     .                                                            82920000
829300 Z700-EXIT.                                                       82930000
829400     EXIT.                                                        82940000
829500     EJECT.                                                       82950000
